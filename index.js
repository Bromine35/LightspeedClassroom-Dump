!function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){return o(t[a][1][e]||e)}),l,l.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=e("debug")("ls-classroom:commands"),s=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.locked=!1,this.lockedUntil=new Date,this.lastMessage="Locked",this.activePolicy=null,this.unlockWatcherInt=setInterval((function(){var e=new Date;t.locked&&e-t.lockedUntil>0&&(chrome.tabs.query({},(function(e){e.forEach((function(e){chrome.tabs.sendMessage(e.id,{action:"unlock"},(function(){}))}))})),t.locked=!1,t.lastMessage="Locked")}),15e3),"undefined"!=typeof chrome&&void 0!==chrome.extension&&chrome.extension.onRequest.addListener((function(e,r,n){r.id===chrome.runtime.id&&"?"===e.locked&&n({state:t.locked,message:t.lastMessage})}))}var t,r,i;return t=e,(r=[{key:"applyBindings",value:function(e){if("object"!==n(e))throw new Error("channel required");void 0!==e.subscribe&&(e.subscribe("tm",this.teacherMessage.bind(this)),e.subscribe("url",this.openTab.bind(this)),e.subscribe("lock",this.lock.bind(this)),e.subscribe("unlock",this.unlock.bind(this)),e.subscribe("policyUpdate",this.policyUpdate.bind(this)),e.subscribe("setState",this.setState.bind(this)),e.subscribe("startRecording",this.startRecording.bind(this)),e.subscribe("updateExtension",this.updateExtension.bind(this)))}},{key:"teacherMessage",value:function(e){if("object"!==n(e))throw new Error("message object required");if((!this.activePolicy||this.activePolicy.isClassroomActive())&&void 0!==chrome.notifications){var t={type:chrome.notifications.TemplateType.BASIC,iconUrl:chrome.extension.getURL("assets/icon48.png"),title:"Classroom",message:e.data.m,priority:2,requireInteraction:!0,buttons:[{title:"Yes"},{title:"No"}]},r=e.data.mId||1,o="mtype-"+r;[2,3].includes(r)||(o=null,t.buttons=null,t.requireInteraction=!1),chrome.notifications.create(o,t)}}},{key:"openTab",value:function(e){if(a("[openTab] ->",e),"object"!==n(e))throw new Error("message object required");if((!this.activePolicy||this.activePolicy.isClassroomActive())&&void 0!==chrome.tabs)try{chrome.tabs.create({url:e.data})}catch(e){a("[openTab] ->",e)}}},{key:"lock",value:function(e){if("object"!==n(e))throw new Error("message object required");if((!this.activePolicy||this.activePolicy.isClassroomActive())&&void 0!==chrome.tabs){var t,r="Locked";if("object"===n(e.data)&&e.data.lockMessage&&(r=e.data.lockMessage),this.locked=!0,this.lastMessage=r,this.activePolicy&&this.activePolicy.lockExpiration&&this.activePolicy.lockExpiration>-1){var o=new Date(0);o.setUTCSeconds(this.activePolicy.lockExpiration),t=o}t&&t>new Date?this.lockedUntil=t:this.lockedUntil=new Date((new Date).getTime()+3e5);try{chrome.windows.getCurrent((function(e){"fullscreen"===e.state&&chrome.windows.update(e.id,{state:"normal"})}))}catch(e){console.error("[lock] tab getCurrent error ->",e)}try{chrome.tabs.query({},(function(e){e.forEach((function(e){chrome.tabs.sendMessage(e.id,{action:"lock",message:r},(function(){}))}))}))}catch(e){console.error("[lock] tab sendMessage error ->",e)}}}},{key:"unlock",value:function(e){if("object"!==n(e))throw new Error("message object required");if(void 0!==chrome.tabs){this.locked=!1;try{chrome.tabs.query({},(function(e){e.forEach((function(e){chrome.tabs.sendMessage(e.id,{action:"unlock"},(function(){}))}))}))}catch(e){console.error("[unlock] tab sendMessage error ->",e)}}}},{key:"policyUpdate",value:function(e){if("object"!==n(e))throw new Error("message object required");if("undefined"!=typeof Event){var t=new Event("policyUpdate");t.triggeredAt=e.data.at,document.dispatchEvent(t)}}},{key:"setState",value:function(e){if("object"!==n(e))throw new Error("message object required");if(!this.activePolicy||this.activePolicy.isClassroomActive()){var t=new Event("setState");t.newState=e.data,document.dispatchEvent(t)}}},{key:"startRecording",value:function(e){if("object"!==n(e))throw new Error("message object required");if(!this.activePolicy||this.activePolicy.isClassroomActive()){if("object"!==n(e.data))throw new Error("message must have a data object");if("number"!=typeof e.data.duration)throw new Error("message requires a duration");var t=new Event("startRecording");t.duration=1e3*e.data.duration,document.dispatchEvent(t)}}},{key:"updateExtension",value:function(e){if("object"!==n(e))throw new Error("message object required");chrome.runtime.requestUpdateCheck((function(){}))}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=s},{debug:76}],2:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&i.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=h(e[o],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}var s,c,u=e("debug");function l(e){return new Promise((function(t){chrome.storage.local.get([e],(function(r){r&&t(r[e])}))}))}function f(e){return d.apply(this,arguments)}function d(){return(d=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,chrome.storage.local.set(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=a(o().mark((function e(){var t,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("debug");case 2:return"string"==typeof(t=e.sent)&&""!==t&&(u.enable(t),console.log("[Setup] debug enabled ->",t)),e.next=6,l("bitrate");case 6:return"number"==typeof(r=e.sent)&&r>0&&(s=r,console.log("[Setup] bitrate ->",s)),e.next=10,l("jpegQuality");case 10:"number"==typeof(n=e.sent)&&n>0&&n<=100&&(c=n,console.log("[Setup] jpegQuality ->",c));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=a(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("identInt");case 2:if(!("number"==typeof(t=e.sent)&&t>=6e4&&t<=648e5)){e.next=5;break}return e.abrupt("return",t);case 5:return e.abrupt("return",648e5);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.exports.ClearStorage=function(e){chrome.storage.local.remove(e)},t.exports.Debug=function(e){e&&"string"==typeof e?(f({debug:e}),chrome.runtime.reload()):u.disable()},t.exports.GetBitrate=function(){return s||6e3},t.exports.GetIdentInt=function(){return p.apply(this,arguments)},t.exports.GetJpegQuality=function(){return c},t.exports.GetStorage=l,t.exports.SetBitrate=function(e){"number"==typeof e&&e>0&&(s=e,console.log("[SetBitrate] ->",s),f({bitrate:s}))},t.exports.SetIdentInt=function(e){f({identInt:e})},t.exports.SetJpegQuality=function(e){"number"==typeof e&&e>0&&e<=100&&(c=e,console.log("[SetJpegQuality] ->",c),f({jpegQuality:c}))},t.exports.SetStorage=f,t.exports.Setup=function(){return h.apply(this,arguments)}},{debug:76}],3:[function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:String(t)}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=e("debug")("ls-classroom:group"),u=e("./insights"),l=["currentHost","favico","state","visits","top","topTime","visitMap","insightHost","selectedQuickPollOption"],f={currentHost:"",favico:"",state:"working",visits:0,top:"",topTime:0,visitMap:{}},d=function e(t){var r={};return t&&"object"===s(t)&&Object.keys(t).forEach((function(n){"object"===s(t[n])?r[n]=e(t[n]):r[n]=t[n]})),r},h=function(){function e(t,r,n){var o=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"!==s(t))throw new Error("group attributes required");if(void 0===t.id)throw new Error("group id required");if("object"!==s(r))throw new Error("ably object required");if("string"!=typeof n)throw new Error("customerId required");this.id=t.id,this.ably=r,this.reconfigure(t),this.customerId=n,this.attributes=d(f),this.resume(),this.isActive()&&this.sendUpdate(),this.checkStateInt=setInterval((function(){var e=new Date;o.isActive()||void 0!==o.attributes.lastModified&&e-o.attributes.lastModified>9e5&&(o.attributes=d(f),"undefined"!=typeof localStorage&&delete localStorage["group:".concat(o.id,":checkpoint")])}),3e5),this.insights=new u,this.insights.addListener((function(e){c("[insight] triggered ->",e),o.updateInsight(e)}))}var t,r,o;return t=e,(r=[{key:"setAttrs",value:function(e){var t=this;if("object"!==s(e))throw new Error("new attributes required");var r=Object.keys(e);0!==r.length&&(r.forEach((function(e){if(-1===l.indexOf(e))throw new Error("".concat(e," is not a valid attribute"))})),void 0!==e.state&&(this.attributes.state=e.state,this.attributes.lastModified=new Date),this.isActive()&&(r.forEach((function(r){t.attributes[r]=e[r]})),this.attributes.lastModified=new Date))}},{key:"isActive",value:function(){return document.IsGroupActive(this.id)}},{key:"setTop",value:function(){var e=this,t=!1;Object.keys(this.attributes.visitMap).forEach((function(r){e.attributes.top!==r&&e.attributes.topTime<e.attributes.visitMap[r].timeSec?(e.setAttrs({topTime:e.attributes.visitMap[r].timeSec,top:r}),t=!0):e.attributes.top===r&&e.setAttrs({topTime:e.attributes.visitMap[r].timeSec})})),t&&(this.setCheckpoint(),this.sendUpdate())}},{key:"sendUpdate",value:function(){var e=this;this.sendUpdateTO||this.policy&&!this.policy.isClassroomActive()||this.isActive()&&(this.sendUpdateTO=setTimeout((function(){if(clearTimeout(e.sendUpdateTO),delete e.sendUpdateTO,"undefined"!=typeof document&&"function"==typeof document.dispatchEvent){var t=new Event("GroupUpdate");t.groupId=e.id,t.attributes=e.attributes,document.dispatchEvent(t)}}),1e3))}},{key:"initializeHost",value:function(e){if("string"!=typeof e)throw new Error("host required");void 0===this.attributes.visitMap[e]&&(this.attributes.visitMap[e]={cnt:0,timeSec:0})}},{key:"incrementVisits",value:function(e){if("string"!=typeof e)throw new Error("host required");this.isActive()&&(this.initializeHost(e),this.attributes.visitMap[e].cnt++,this.setAttrs({visits:this.attributes.visits+1}),this.setCheckpoint(),this.sendUpdate())}},{key:"incrementHostTime",value:function(e,t){if("string"!=typeof e)throw new Error("host required");if("number"!=typeof t)throw new Error("seconds must be a number");this.isActive()&&(this.initializeHost(e),this.attributes.visitMap[e].timeSec+=t,this.setCheckpoint(),this.setTop())}},{key:"setCurrent",value:function(e,t){if("string"!=typeof e)throw new Error("host required");if(this.isActive()){var r=!1,n={};this.attributes.currentHost!==e&&(n.currentHost=e,r=!0),this.attributes.favico!==t&&(n.favico=t,r=!0),r&&(this.setAttrs(n),this.setCheckpoint(),this.sendUpdate())}}},{key:"setState",value:function(e){if("string"!=typeof e)throw new Error("state required");c("[setState] update ->",e),this.attributes.state!==e&&(this.setAttrs({state:e}),c("[setState] attributes ->",this.attributes),this.setCheckpoint())}},{key:"setCheckpoint",value:function(){var e=d(this.attributes);e.createdAt=(new Date).toISOString(),"undefined"!=typeof localStorage&&localStorage.setItem("group:".concat(this.id,":checkpoint"),JSON.stringify(e))}},{key:"resume",value:function(){if("undefined"!=typeof localStorage){var e=localStorage.getItem("group:".concat(this.id,":checkpoint"));if(e){var t=new Date;(e=JSON.parse(e)).createdAt=new Date(e.createdAt),e.createdAt.getYear()===t.getYear()&&e.createdAt.getMonth()===t.getMonth()&&e.createdAt.getDay()===t.getDay()&&(delete e.createdAt,this.attributes=e)}}}},{key:"scoreUrl",value:function(e){var t=this;if(c("[scoreUrl]: group: ",this.id," url: ",e),"string"!=typeof e)throw new Error("url must be a string");var r={};return this.isActive()&&this.filterSites?(c("[scoreUrl] active and filtering sites\nAllow when done: ",this.allowWhenDone," state is: ",this.attributes.state),r.allowed=this.blockSites,this.allowWhenDone&&"done"===this.attributes.state?r.allowed=!0:this.sites.some((function(n){if(c("[scoreUrl.sites] check using filter ->",n),Array.isArray(n)){c("[scoreUrl.sites] check using hostname checking");var o=document.createElement("A");o.href=e;var i=o.hostname.split("."),a=n.length,s=i.length;if(a<=s){for(var u=0;u<a;u++)if(n[a-1-u]!==i[s-1-u])return!1;return r.allowed=!t.blockSites,!0}}else if(c("[scoreUrl.sites] check using regex"),e.match(n))return c("[scoreUrl.sites] check match using filter ->",n),r.allowed=!t.blockSites,!0}))):c("[scoreUrl] disabled, active: ",this.isActive()," filterSites: ",this.filterSites),c("[scoreUrl] returning ->",r),r}},{key:"addUrl",value:function(e){if("string"!=typeof e)throw new Error("url must be a string");this.filterSites=!0,e.match(/\//)?this.sites.push(new RegExp(e.replace(/[\]{}?^$().*\\+|[]/g,"\\$&").replace(/^[^:]+:/,"^[^:]+:")+".*","i")):this.sites.push(e.split("."))}},{key:"updateInsight",value:function(e){if("string"!=typeof e)throw new Error("hostname must be a string");this.isActive()&&(this.setAttrs({insightHost:e}),this.sendUpdate())}},{key:"reconfigure",value:function(e){var t=this;if("object"!==s(e))throw new Error("attributes required");if(this.id!==e.id)throw new Error("group ID mismatch");if(this.filterSites=!1,this.allowWhenDone=!1,this.blockSites=!1,this.encryptedUserEmail=void 0,delete this.quickPoll,this.sites=[],e.web_rules)for(var r=0,o=Object.entries(e.web_rules);r<o.length;r++){var i=n(o[r],2),a=i[0],c=i[1];switch(a){case"sites":this.filterSites=!0,Array.isArray(c)&&c.forEach((function(e){t.addUrl(e)}));break;case"allow_when_done":this.allowWhenDone=c;break;case"blocked":this.blockSites=c;break;case"encryptedUserEmail":this.encryptedUserEmail=c;break;case"encryptedCustomerId":this.encryptedCustomerId=c}}}},{key:"selectQuickPollOption",value:function(e){if(void 0===e)throw new Error("option required");if(void 0===this.quickPoll)throw new Error("no poll active");if(-1===this.quickPoll.options.indexOf(e))throw new Error("invalid quickPoll option");this.setAttrs({selectedQuickPollOption:e})}}])&&i(t.prototype,r),o&&i(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=h},{"./insights":6,debug:76}],4:[function(e,t,r){"use strict";function n(e){Object.keys(e).forEach((function(t){var r=e[t];"function"==typeof r&&Object.defineProperty(e,t,{value:r,writable:!1,configurable:!1})}))}window.LSClassroom=e("./config"),n(chrome.identity),n(window.LSClassroom),window.LSClassroom.Setup(),window.LSClassroomWASM=e("./wasm"),e("./telemetry"),e("./real_time")},{"./config":2,"./real_time":8,"./telemetry":16,"./wasm":18}],5:[function(e,t,r){"use strict";t.exports={threshold:5,sites:["abcmouse.com","abcnews.go.com","abcya.com","acceleratelearning.com","accounts.google.com","aceable.com","achieve3000.com","activeclassroom.com","activelylearn.com","actstudent.org","adobe.com","adobelogin.com","adrift.org.au","aeseducation.com","agilixbuzz.com","airast.org","aleks.com","allinlearning.com","amazonaws.com","amplify.com","analyze-ed.com","aohghmighlieiainnegkcijnfilokake","apexlearning.com","app.typingagent.com","appengine.google.com","apple.com","applytexas.org","arcbookshelf.com","arizona.edu","assessmenttechnology.com","ati-online.com","auth0.com","avantassessment.com","beinternetawesome.withgoogle.com","bibliocommons.com","biblionasium.com","bibme.org","bigideaslearning.magicsw.com","bigideasmath.com","bing.com","biography.com","bit.ly","blackboard.com","bls.gov","bookcreator.com","books.google.com","boomlearning.com","bpmcpldpdmajfigpchkicefoigmkfalc","brainly.com","brainpop.com","brightspace.com","britannica.com","burlesonisd.net","calendar.google.com","calorieking.com","cambridge.org","canva.com","canvaslms.com","careercruising.com","castlelearning.com","cdc.gov","charmsoffice.com","checkology.org","choosemyplate.gov","chrome.google.com","cia.gov","citationmachine.net","ck12.org","ckschools.org","classcraft.com","classflow.com","classkick.com","classlink.com","classroom.google.com","classzone.com","clever.com","cliffsnotes.com","code.org","codehs.com","collegefortn.org","colorado.edu","commonapp.org","commoncoresheets.com","commonlit.org","conjuguemos.com","connexus.com","coolmath-games.com","coolmath.com","coolmathgames.com","coursekit.google.com","cpm.org","craighighschool.org","creektube.net","cse.google.com","culturegrams.com","deck.toys","deltamath.com","desire2learn.com","desmos.com","dictionary.com","discoveryeducation.com","dochub.com","docs.google.com","doubleclick.net","drawn.digifi.ca","drcedirect.com","dreambox.com","drive.google.com","driversed.com","duckduckgo.com","ducksters.com","duolingo.com","eadms.com","earth.google.com","easybib.com","easycbm.com","eb.com","ecnphlgnajanjnkcmbpancdjoidceilk","ecollege.com","ed.gov","edgenuity.com","edmentum.com","edmodo.com","edpuzzle.com","edready.org","education.com","educationgalaxy.com","edugence.com","edulastic.com","edutyping.com","eia.gov","enotes.com","eventbrite.com","everfi.net","explorelearning.com","exploros.com","fanfox.net","fcboe.org","firstinmath.com","flipgrid.com","fliphtml5.com","flocabulary.com","follettdestiny.com","follettsoftware.com","freckle.com","freerice.com","frontrowed.com","g-wonlinetextbooks.com","gadoe.org","gafutures.org","gale.com","galegroup.com","gavirtualschool.org","gcaconnect.org","geniussis.com","getepic.com","getfueled.com","gimkit.com","gmc.mrooms3.net","goformative.com","goo.gl","goodreads.com","googletune.com","googleusercontent.com","grammarly.com","gstatic.com","hacksawengineering.com","hangouts.google.com","healthline.com","hillcollege.edu","history.google.com","hmhco.com","hoodamath.com","hrw.com","hudl.com","i-ready.com","icevonline.com","icivics.org","infinitecampus.com","inkling.com","inscloudgate.net","instructure.com","ipv4.google.com","istation.com","isteepdata.com","ivytech.edu","ixl.com","janesvilleparker.org","jlab.org","jostens.com","jstor.org","k12.al.us","k12.az.us","k12.ca.us","k12.co.us","k12.com","k12.de.us","k12.fl.us","k12.ga.us","k12.ia.us","k12.id.us","k12.il.us","k12.in.us","k12.ks.us","k12.ky.us","k12.la.us","k12.ma.us","k12.mi.us","k12.mn.us","k12.mo.us","k12.ms.us","k12.mt.us","k12.nc.us","k12.nh.us","k12.nj.us","k12.nm.us","k12.nv.us","k12.ny.us","k12.oh.us","k12.ok.us","k12.or.us","k12.pa.us","k12.ri.us","k12.sd.us","k12.tn.us","k12.tx.us","k12.va.us","k12.wi.us","k12.wv.us","k12.wy.us","kahoot.com","kahoot.it","kamihq.com","keep.google.com","khanacademy.org","kidsa-z.com","kidshealth.org","kidzsearch.com","knowledgematters.com","kwtears.com","learn4good.com","learningally.org","learnzillion.com","legendsoflearning.com","lexiacore5.com","lexiapowerup.com","libraryreserve.com","linustechtips.com","littlealchemy.com","live.com","livescience.com","livestrong.com","lpss.int","lpssonline.com","lsclassroom.com","lucidchart.com","lumoslearning.com","mail.google.com","maps.google.com","masteringchemistry.com","masteringphysics.com","mathgames.com","mathplayground.com","mathsisfun.com","mathxlforschool.com","mayoclinic.org","mcgraw-hill.com","membean.com","mentoringminds.com","merriam-webster.com","mheducation.com","microbit.org","microsoftonline.com","mindplayvirtualreadingcoach.com","minnstate.edu","missouriconnections.org","mit.edu","mobymax.com","mrdowling.com","multiplication.com","musiclab.chromeexperiments.com","myaccount.google.com","mycapstonelibrary.com","myhaikuclass.com","mylexia.com","myngconnect.com","myon.com","mypearson.com","mysteryscience.com","n2y.com","nasa.gov","nationalgeographic.com","naviance.com","nearpod.com","newsela.com","nhd.weebly.com","nightzookeeper.com","nih.gov","nitrotype.com","noodletools.com","noredink.com","nps.gov","nwtoolbox.org","oaksportal.org","olympic.org","onetonline.org","oregon.gov","oregonstudentaid.gov","oslis.org","overdrive.com","padlet.com","parentlink.net","pbisrewards.com","pbs.org","pbskids.org","pcc.edu","pcpartpicker.com","peardeck.com","pearson.com","pearsonapi.com","pearsoncmg.com","pearsoned.com","pearsonrealize.com","pearsonsuccessnet.com","pebblego.com","pegwriting.com","photos.google.com","physicsclassroom.com","piktochart.com","pixilart.com","pixton.com","planbook.com","play.google.com","playbuzz.com","plus.google.com","poets.org","powerschool.com","precisionexams.com","prepfactory.com","prezi.com","pridesurveys.com","primarygames.com","procon.org","prodigygame.com","productforums.google.com","proprofs.com","psychologytoday.com","purdue.edu","quavermusic.com","quia.com","quill.org","quizizz.com","quizlet.com","ratatype.com","raz-kids.com","rcsdk12.org","readingeggs.com","readingplus.com","readtheory.org","readworks.org","realtor.com","remind.com","renaissance-go.com","renaissance.com","renlearn.com","rezzly.com","roblox.com","rosettastone.com","rosettastoneclassroom.com","sb.school","scholar.google.com","scholastic.com","schoolmessenger.com","schoology.com","sciencebuddies.org","sciencing.com","scilearn.com","scootpad.com","search.yahoo.com","seesaw.me","senorwooly.com","sheppardsoftware.com","shmoop.com","sites.google.com","sketch.io","smartyants.com","smore.com","socratic.org","socrative.com","soraapp.com","soundcloud.com","sp2.org","space.com","spanishdict.com","sparknotes.com","spellingcity.com","sporcle.com","spotify.com","springboardonline.org","starfall.com","stemscopes.com","storybird.com","storylineonline.net","student.works.kutasoftware.com","studiesweekly.com","study.com","studyisland.com","studyladder.com","studystack.com","sumdog.com","support.google.com","surveymonkey.com","symbaloo.com","talentlms.com","teachbanzai.com","ted.com","tenmarks.com","thebalance.com","thecopia.com","thesaurus.com","thinkcentral.com","thinkcerca.com","thinkthroughmath.com","thoughtco.com","thrivistlms.com","time.com","timeanddate.com","tinkercad.com","tourbuilder.withgoogle.com","translate.google.com","traveloregon.com","tumblemobile.com","turnitin.com","tynker.com","typetastic.com","typing.com","typingclub.com","typingmaster.com","typingtest.com","ucertify.com","uoregon.edu","usatestprep.com","usg.edu","usgs.gov","ushmm.org","varsitylearning.com","vhlcentral.com","vitalsource.com","vjsjunior.com","vocabulary.com","voice.google.com","volstate.edu","vsco.co","watercalculator.org","waysidepublishing.com","wceruw.org","wcschools.com","weather.com","webassign.net","webmd.com","webreader.io","wevideo.com","whooosreading.org","wikihow.com","wikipedia.org","wileyplus.com","wordreference.com","world-geography-games.com","worldbookonline.com","wowzers.com","www.audiotool.com","www.bbc.co.uk","www.bbc.com","www.businessinsider.com","www.cnn.com","www.forbes.com","www.foxnews.com","www.google.com","www.googleadservices.com","www.history.com","www.independent.co.uk","www.kiddle.co","www.npr.org","www.nytimes.com","www.oregonlive.com","www.pandora.com","www.theatlantic.com","www.theguardian.com","www.usatoday.com","www.usnews.com","www.washingtonpost.com","xello.world","xtramath.org","yourchildlearns.com","youtu.be","youtube.com","zearn.org","zillow.com","zinclearninglabs.com","zoom.us"]}},{}],6:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=e("./insight_settings"),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.onInsight=[],this.Reset()}var t,r,n;return t=e,(r=[{key:"Observe",value:function(e){if("string"!=typeof e)throw new Error("hostname must be a string");a.sites.some((function(t){return e.endsWith(t)}))?""===this.offender&&(this.hits=0):(this.hits++,this.hits===a.threshold&&(this.offender=e,this.triggerCallbacks()))}},{key:"Reset",value:function(){this.hits=0,this.offender="",this.triggerCallbacks()}},{key:"addListener",value:function(e){if("function"!=typeof e)throw new Error("callback must be a function");this.onInsight.push(e)}},{key:"triggerCallbacks",value:function(){var e=this;this.onInsight.forEach((function(t){t(e.offender,e.hits)}))}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=s},{"./insight_settings":5}],7:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var c=e("debug")("ls-classroom:policy"),u=e("axios").default,l=e("./group"),f=e("./user"),d=new(e("./commands")),h=new(e("./scheduler"));function p(e){var t=e.split(".").map((function(e){return parseInt(e,10)}));return(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3]}function m(e){var t=~parseInt(0,10);return t<<=32-parseInt(e,10)}document.IsGroupActive=h.isGroupActive.bind(h);var y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d.activePolicy=this,this.groups={},this.campus_networks=[],this.onCampus=!0,this.onCampusOnly=!1,this.currentIP=void 0,this.chromebookOnly=!1,this.osPlatform="cros"}var t,r,i;return t=e,(r=[{key:"isClassroomActive",value:function(){return!(this.chromebookOnly&&this.osPlatform!==chrome.runtime.PlatformOs.CROS||!this.onCampus&&this.onCampusOnly)}},{key:"updateCampusNetworkState",value:function(){try{if(!this.currentIP||"127.0.0.1"===this.currentIP||!this.campus_networks||0===this.campus_networks.length)return void(this.onCampus=!0);if(-1!==this.campus_networks.indexOf(this.currentIP))return void(this.onCampus=!0);var e,t=p(this.currentIP),r=o(this.campus_networks);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(n.match("/")){var i=n.split("/"),a=p(i[0]),s=m(i[1]);if((a&s)==(t&s))return void(this.onCampus=!0)}}}catch(e){r.e(e)}finally{r.f()}this.onCampus=!1}finally{d.onCampus=this.onCampus}}},{key:"updateIP",value:function(e,t){(this.currentIP!==e||t)&&(this.currentIP=e,void 0!==this.user&&(this.user.currentIP=this.currentIP)),this.updateCampusNetworkState()}},{key:"Configure",value:function(e){if("object"!==n(e))throw new Error("settings required");if("string"!=typeof e.apiUri)throw new Error("settings.apiUri must be a string");if("string"!=typeof e.apiKey)throw new Error("settings.apiKey must be a string");if("string"!=typeof e.customerId)throw new Error("settings.customerId must be a string");if("object"!==n(e.ably))throw new Error("settings.ably must be provided");this.settings={ably:e.ably,apiKey:e.apiKey,apiUri:e.apiUri,customerId:e.customerId,osPlatform:e.osPlatform}}},{key:"SetCurrentUser",value:function(e){if("string"!=typeof e)throw new Error("username must be a string");this.currentUser=e}},{key:"convertDataVarNames",value:function(e){e.id=e.user_guid;for(var t=0;t<e.groups.length;++t){var r=e.groups[t].group_guid;e.groups[t].id=r}}},{key:"LoadPolicy",value:function(){var e=this;if(void 0===this.settings||"string"!=typeof this.settings.apiUri||"string"!=typeof this.settings.apiKey||"string"!=typeof this.settings.customerId||"object"!==n(this.settings.ably))throw new Error("please configure the API settings before calling LoadPolicy");if("string"!=typeof this.currentUser)throw new Error("please set the CurrentUser before calling LoadPolicy");return this.LoadPolicyInt&&(clearInterval(this.LoadPolicyInt),this.LoadPolicyInt=void 0),new Promise((function(t){var r=chrome.runtime.getManifest().version,n=function(){return u({method:"post",url:e.settings.apiUri+"/policy",headers:{"x-api-key":e.settings.apiKey,"Content-Type":"application/json",customerid:e.settings.customerId,version:"chrome-".concat(r)},data:{username:e.currentUser}}).then((function(r){var n=r.data;if(0===Object.keys(n).length){c("[LoadPolicy] no policy for ->",e.currentUser),e.LoadPolicyInt&&(clearInterval(e.LoadPolicyInt),e.LoadPolicyInt=void 0);var o={email:e.currentUser};return t(o),o}for(var i in c("[LoadPolicy] policy for ->",n.email),LSClassroomWASM.PolicyData(n.jwt,n.email,n.user_guid),e.convertDataVarNames(n),void 0===e.user?e.user=new f(n,e.settings.ably,e.settings.customerId,d):e.user.attributes=n,e.user.policy=e,e.campus_networks=n.district.campus_networks||[],e.onCampusOnly=Boolean(n.on_campus_only),e.chromebookOnly=n.district.chromebook_only,e.encryptedCustomerId=n.district.encrypted_customer_id,h.setGroups(n.groups),n.groups.forEach((function(t){void 0!==e.groups[t.id]?e.groups[t.id].reconfigure(t):e.groups[t.id]=new l(t,e.settings.ably,e.settings.customerId)})),e.groups)e.groups[i].policy=e;var a=n.groups.map((function(e){return parseInt(e.id,10)})),s=[];if(Object.keys(e.groups).forEach((function(e){var t=parseInt(e,10);-1===a.indexOf(t)&&s.push(t)})),s.forEach((function(t){delete e.groups[t]})),e.LoadPolicyInt&&(clearInterval(e.LoadPolicyInt),e.LoadPolicyInt=void 0),e.updateCampusNetworkState(),e.user.policy=e,setTimeout((function(){e.user.sendTabs()}),1e3),d.activePolicy.lockExpiration=n.screen_lock_expire||-1,(new Date).getTime()<1e3*n.screen_lock_expire)var u=setTimeout((function(){clearTimeout(u),d.lock({data:{lockMessage:"This screen is locked"}})}),1e3);else var p=setTimeout((function(){clearTimeout(p),d.unlock({})}),1e3);return t(r.data),r.data})).catch((function(e){console.error("Error loading policy: ",e)}))};e.LoadPolicyInt=setInterval(n,31e3),n()}))}}])&&a(t.prototype,r),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=y},{"./commands":1,"./group":3,"./scheduler":12,"./user":17,axios:24,debug:76}],8:[function(e,t,r){(function(t){(function(){"use strict";function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */r=function(){return t};var e,t={},n=Object.prototype,o=n.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==n&&o.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(n,a,s,c){var u=h(e[n],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==i(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var n;a(this,"_invoke",{value:function(e,o){function i(){return new t((function(t,n){r(e,o,t,n)}))}return n=n?n.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(i(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function n(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=e("debug")("ls-classroom:real_time"),s=chrome.runtime.getManifest(),c=e("./config"),u=e("ably"),l=e("./policy"),f=new(e("./tab_capture")),d=new l,h=e("./tab_reporter"),p=e("../utilities/groups").setCurrentHost,m=e("../utilities/tabs").filterTabs;t.sessionId=Math.floor(1e5*Math.random()).toString(36),document.TabCapture=f,h.Configure({policy:d}),f.policy=d;var y,g,v,b,w="G52kOXvb7p7UbwFRV3ahn74m6xklosio2XUdLlTL",_=["60-8732-A000","55-4551-A000","74-1335-F000"],O=!1,S=function(e,t){(g!==e||t)&&(g=e,void 0!==d&&(void 0!==d.groups&&Object.keys(d.groups).forEach((function(e){d.groups[e].setState(g)})),void 0!==d.user&&(d.user.currentState={state:g,ip:d.user.currentIP,recording:d.user.recording,agent_platform:"cros",agent_version:s.version},d.user.channel.presence.update({state:g,ip:d.user.currentIP,recording:d.user.recording,agent_platform:"cros",agent_version:s.version},(function(e){if(e)return a("[updateState] error ->",e)})))))};LSClassroomWASM.SetTabCB((function(e){a("[sendTabs] ->",e),d.user.channel.publish("tabs",JSON.parse(e))}));var E,k,C,A=function(){if(!O){S("working"),chrome.webRequest.onCompleted.addListener((function(e){if(d.isClassroomActive()){var t=document.createElement("a");t.href=e.url,t.protocol.match(/^chrome/)||Object.keys(d.groups).forEach((function(e){var r=d.groups[e];r.isActive()&&r.insights.Observe(t.hostname)}))}}),{types:["main_frame"],urls:["<all_urls>"]});var e=function(){d.isClassroomActive()&&(a("[tabTrigger]"),Promise.all([new Promise((function(e){return chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(t){if(d.isClassroomActive()){var r=t[0];r&&Object.keys(d.groups).forEach((function(e){var t=d.groups[e];p(t,r)})),e()}}))})),m(d)]).then((function(){void 0!==d&&void 0!==d.user&&d.user.sendTabs()})).catch((function(e){console.error("[tabTrigger] error ->",e)})))};["onActivated","onHighlighted","onDetached","onAttached","onRemoved","onUpdated","onCreated"].forEach((function(t){a("[tabEvents] ->",t),chrome.tabs[t].addListener((function(){a("[tabEvents] ".concat(t," fired ->"),t),e()}))})),["onCreated","onRemoved","onFocusChanged"].forEach((function(t){a("[windowEvents] ".concat(t," fired ->"),t),chrome.windows[t].addListener((function(){a("[windowEvents] ".concat(t," fired ->"),t),e()}))})),e(),chrome.runtime.onMessage.addListener((function(e,t,r){var n={};return e.newState?S(e.newState,!0):"getState"===e.query?(n={currentState:g,groups:[]},void 0!==d&&void 0!==d.groups&&Object.keys(d.groups).forEach((function(e){var t=d.groups[e];t.isActive()&&"object"===i(t.quickPoll)&&n.groups.push({id:t.id,name:t.id,quickPoll:{selectedOption:t.attributes.selectedQuickPollOption,options:t.quickPoll.options}})})),a("[getState] ->",n)):"quickPollUpdate"===e.query?a("[quickPollUpdate] ->",e):e.incHit&&e.host&&Object.keys(d.groups).forEach((function(t){d.groups[t].incrementVisits(e.host)})),r(n),!0}));setInterval((function(){chrome.tabs.query({active:!0},(function(e){e.forEach((function(e){var t=document.createElement("a");t.href=e.url,Object.keys(d.groups).forEach((function(e){d.groups[e].incrementHostTime(t.hostname,1)}))}))}))}),1e3),document.echo=function(){var e=[];e.push("policy"),e.push(d),e.push("TabCapture"),e.push(f),a("[TabCapture] ->",e)},document.echo(),setInterval(document.echo,1e4),LSClassroomWASM.FetchIP(),O=!0,chrome.bookmarks.onCreated.addListener((function(e,t){t.url&&t.url.match(/^javascript:/i)&&chrome.bookmarks.remove(t.id)}))}},x=function(e){"string"==typeof e.newState?(a("[updateStateFromSocket] ->",e),S(e.newState,!0)):e.updateRecording&&S(g,!0)};function j(){if(y)if(navigator.onLine)switch(a("[AblyHealthCheck] current state ->",y.connection.state),y.connection.state){case"closed":case"disconnected":case"suspended":case"failed":a("[AblyHealthCheck] state is bad, starting reconnect process"),function(){if(k)try{clearTimeout(k),a("[ForceAblyReconnect] previous reconnect timer cleared"),k=void 0}catch(e){}if(C){a("[ForceAblyReconnect] previous health check timer cleared");try{clearTimeout(C),C=void 0}catch(e){}}k=setTimeout((function(){switch(y.connection.state){case"closed":case"disconnected":case"suspended":case"failed":a("[ForceAblyReconnect] telling library to connect");break;default:return void a("[ForceAblyReconnect] the client reconnected, exiting")}a("[ForceAblyReconnect] forcing reconnect"),c.SetStorage({lastIdentCheck:Date.now()-864e5})}),250),C=setTimeout(j,3e4),a("[ForceAblyReconnect] connection will be re-tried in 250ms, health will be verified in 30 seconds")}();break;default:a("[AblyHealthCheck] state is connected/connecting, health check seems okay")}else a("[AblyHealthCheck] currently offline, skipping");else a("]AblyHealthCheck] no connection yet")}function R(e){return new Promise((function(t){setTimeout(t,e)}))}setInterval(j,6e4);var T=0,I=void 0,P=function(){var e=o(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t&&("function"==typeof t.stopPropagation&&t.stopPropagation(),"function"==typeof t.preventDefault&&t.preventDefault()),e.prev=1,!O){e.next=5;break}return e.next=5,R(5e3);case 5:if(n=(new Date).getTime(),!I){e.next=11;break}return e.next=9,I;case 9:e.next=19;break;case 11:if(!(T<n)){e.next=19;break}return I=this,e.next=15,d.LoadPolicy();case 15:f.policy=d,m(d),T=(new Date).getTime(),I=void 0;case 19:a("[reloadPolicy] loaded ->",d),A(),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(1),console.error("[reloadPolicy] load error ->",e.t0);case 26:case"end":return e.stop()}}),e,this,[[1,23]])})));return function(t){return e.apply(this,arguments)}}();function L(){return M.apply(this,arguments)}function M(){return(M=o(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.GetIdentInt();case 2:return t=e.sent,e.next=5,c.GetStorage("lastIdentCheck");case 5:if(n=e.sent,!(Date.now()-n>t)){e.next=11;break}return a("[checkIdentityInterval] time for ident"),LSClassroomWASM.GetIdent(),e.abrupt("return");case 11:a("[checkIdentityInterval] next ident ->",new Date(n+t).toLocaleString());case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}LSClassroomWASM.SetIPCB((function(e){d.updateIP(e),S(g,!0)})),LSClassroomWASM.SetIdentCB((function(e){a("[checkIdentity] ->",e);var t=(v=e.chromeUser).toLowerCase(),r={authHeaders:{"Content-Type":"application/json","x-api-key":w,jwt:e.jwt,exp:10},authUrl:"https://ably.lightspeedsystems.app/",clientId:t,echoMessages:!1,environment:"lightspeed",fallbackHosts:["a-fallback-lightspeed.ably.io","b-fallback-lightspeed.ably.io","c-fallback-lightspeed.ably.io"],recover:function(e,t){t(!0)}};-1!==_.indexOf("62-1656-A000")&&(r.log={level:4}),y&&(a("[checkIdentity] closing ably"),y.close(),y=void 0),(y=new u.Realtime(r)).connection.on((function(e){a("[checkIdentity] Ably connection state change event ->",e)})),d.Configure({ably:y,apiKey:w,apiUri:"https://devices.classroom.relay.school",customerId:"62-1656-A000",osPlatform:e.osPlatform}),a("[checkIdentity] ->",d.currentUser," - ",v),d.currentUser===v?(d.user.setAbly(y,"62-1656-A000"),f.setUser(d.user,!0),LSClassroomWASM.FetchIP()):(d.SetCurrentUser(t),document.addEventListener("policyUpdate",P),document.addEventListener("setState",x),P().then((function(){f.setUser(d.user),LSClassroomWASM.FetchIP()}))),c.SetStorage({lastIdentCheck:Date.now()}),b&&(clearInterval(b),b=void 0),b=setInterval(L,1e4)})),window.addEventListener("offline",(function(){if(a("[offline]"),y)try{y.connection.connectionManager.disconnectAllTransports()}catch(e){a("[offline] error when attempting to close Ably connection ->",e)}})),window.addEventListener("online",(function(){if(a("[online]"),E)try{clearTimeout(E),E=void 0}catch(e){}c.SetStorage({lastIdentCheck:Date.now()-864e5})})),chrome.runtime.onUpdateAvailable.addListener((function(){chrome.runtime.reload()}));chrome.notifications.onButtonClicked.addListener((function(e,t){a("[onButtonClicked] ->",e,t);var r=e.match(/mtype-(\d+)/);if(r)switch(parseInt(r[1],10)){case 3:if(chrome.notifications.clear(e),0!==t)break;S("done");break;case 2:if(chrome.notifications.clear(e),0!==t)break;S("need help")}})),document.addEventListener("GroupSchedule",(function(e){a("[GroupSchedule] ->",e)})),console.log(s.description,"version:",s.version)}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../utilities/groups":21,"../utilities/tabs":22,"./config":2,"./policy":7,"./tab_capture":14,"./tab_reporter":15,ably:23,debug:76}],9:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=e("debug")("ls-classroom:rtc_connection"),s=e("./config"),c=[{url:"stun:stun.l.google.com:19302"},{url:"stun:stun1.l.google.com:19302"},{url:"stun:stun2.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{url:"stun:stun3.l.google.com:19302"},{url:"stun:stun4.l.google.com:19302"},{url:"turn:turn.bistri.com:80",credential:"homeo",username:"homeo"},{url:"turn:turn.anyfirewall.com:443?transport=tcp",credential:"webrtc",username:"webrtc"}],u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=c;if("object"===n(t)){if(void 0!==t.customIce){if(!Array.isArray(t.customIce))throw new Error("custom ice must be an array");this.customIce=t.customIce,r=this.customIce}}else if(void 0!==t)throw new Error("args must be an object when provided");this.ice=[],this.onIceCallbacks=[],this.onOfferCallbacks=[],this.haveAllIce=!1,"undefined"!=typeof RTCPeerConnection&&(this.rtc=new RTCPeerConnection({iceServers:r}),this.rtc.onicecandidate=this.onIce.bind(this))}var t,r,i;return t=e,(r=[{key:"createOffer",value:function(){return this.rtc.createOffer()}},{key:"onIce",value:function(e){if(a("[onIce] ->",e),void 0===e)throw new Error("rtc event required");e.candidate?(this.haveAllIce=!1,this.ice.push(e.candidate),this.onIceCallbacks.forEach((function(t){t(e.candidate)}))):(this.haveAllIce=!0,this.onIceCallbacks.forEach((function(e){e(null)})))}},{key:"setStream",value:function(e){var t=this;if("object"!==n(e))throw new Error("stream must be an object");this.stream=e,void 0!==this.rtc&&e.getTracks().forEach((function(r){t.rtc.addTrack(r,e)}))}},{key:"setOffer",value:function(e,t){if(a("[setOffer] offer ->",e),"object"!==n(e))throw new Error("offer must be an object");void 0!==this.rtc&&(this.rtc.setLocalDescription(e).catch((function(e){console.error("[setLocalDescription] error ->",e),t.publish("webrtc_error",e.message)})),this.offer=e,this.onOfferCallbacks.forEach((function(e){a("[onOfferCallbacks] calling offer callback"),e()})),this.onOfferCallbacks=[])}},{key:"setAnswer",value:function(e,t){if(void 0===e)throw new Error("answer required");var r=s.GetBitrate();a("[setAnswer] bitrate ->",r);var n=e.sdp.split("\r\n");n.forEach((function(e,t){/^a=fmtp:\d*/.test(e)?n[t]=e+";x-google-max-bitrate=".concat(r,";x-google-min-bitrate=0;x-google-start-bitrate=5000"):/^a=mid:(0|video)/.test(e)&&(n[t]+="\r\nb=AS:".concat(r))})),e.sdp=n.join("\r\n"),a("[setAnswer] answer ->",e),this.rtc.setRemoteDescription(e).catch((function(e){console.error("[setRemoteDescription] error ->",e),t.publish("webrtc_error",e.message)})),a("[setAnswer] rtc ->",this.rtc)}},{key:"addIce",value:function(e,t){if(a("[addIce] ->",e),void 0===e)throw new Error("ice required");this.rtc.addIceCandidate(e).catch((function(e){console.error("[addIceCandidate] error ->",e),t.publish("webrtc_error",e.message)})),a("[addIce] rtc ->",this.rtc)}},{key:"addIceCallback",value:function(e){if("function"!=typeof e)throw new Error("callback function requred");this.onIceCallbacks.push(e)}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=u},{"./config":2,debug:76}],10:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=e("debug")("ls-classroom:rtc_connection_handler"),s=e("./rtc_connection"),c=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"!==n(t))throw new Error("stream required");if("object"!==n(r))throw new Error("channel required");this.stream=t,this.channel=r,this.connections={},this.presentSessionIds=[],this.applyBindings(),this.cleanConnectionsInt=setInterval(this.cleanConnections.bind(this),3e4)}var t,r,i;return t=e,(r=[{key:"applyBindings",value:function(){this.channel.subscribe("request_rtc",this.onRequestRtc.bind(this)),this.channel.subscribe("answer_rtc",this.onAnswerRtc.bind(this)),this.channel.subscribe("answer_rtc_ice",this.onAnswerIce.bind(this))}},{key:"onRequestRtc",value:function(e){var t=this;a("[onRequestRtc] msg ->",e);try{if("object"!==n(e))throw new Error("message required");if("object"!==n(e.data))throw new Error("message data must be an object");if(void 0===e.data.sessionId)throw new Error("sessionId required");if(this.policy&&!this.policy.isClassroomActive())return;var r=e.data.sessionId;this.addPresence(r);var o=this.connections[r];if(void 0===o){var i={};Array.isArray(e.data.customIce)&&(i.customIce=e.data.customIce),(o=this.connections[r]=new s(i)).setStream(this.stream),a("[onRequestRtc] no rtc for session id, creating new one ->",this.connections)}o.addIceCallback((function(e){e&&t.sendIce(r,e)})),o.createOffer().then(this.onRtcOffer.bind(this,r))}catch(e){throw console.error("[onRequestRtc] error ->",e),e}}},{key:"onRtcOffer",value:function(e,t){if(a("[onRtcOffer] sessionId:",e," offer:",t),void 0===e)throw new Error("sessionId required");if("object"!==n(t))throw new Error("offer required");if(!this.policy||this.policy.isClassroomActive()){var r=this.connections[e];if(void 0===r)throw new Error("no RTC for sessionId: ".concat(e));r.setOffer(t,this.channel),this.sendOffer(e,t)}}},{key:"sendOffer",value:function(e,t){if(void 0===e)throw new Error("sessionId required");if(void 0===t)throw new Error("offer required");var r={sessionId:e,offer:t};this.policy&&!this.policy.isClassroomActive()||this.channel.publish("offer_rtc",r)}},{key:"sendIce",value:function(e,t){if(void 0===e)throw new Error("sessionId required");if(void 0===t)throw new Error("ice required");var r={sessionId:e,ice:t};this.policy&&!this.policy.isClassroomActive()||this.channel.publish("offer_rtc_ice",r)}},{key:"onAnswerRtc",value:function(e){if(a("[onAnswerRtc] msg ->",e),"object"!==n(e))throw new Error("message required");if("object"!==n(e.data))throw new Error("message data must be an object");if(void 0===e.data.sessionId)throw new Error("sessionId required");if(void 0===e.data.answer)throw new Error("answer required");if(!this.policy||this.policy.isClassroomActive()){var t=e.data.sessionId,r=this.connections[t];if(void 0===r)throw new Error("sessionId ".concat(t," does not have a rtc connection"));r.setAnswer(e.data.answer,this.channel)}}},{key:"onAnswerIce",value:function(e){if(a("[onAnswerIce] msg ->",e),"object"!==n(e))throw new Error("message required");if("object"!==n(e.data))throw new Error("message data must be an object");if(void 0===e.data.sessionId)throw new Error("sessionId required");if(void 0===e.data.ice)throw new Error("ice required");if(!this.policy||this.policy.isClassroomActive()){var t=e.data.sessionId,r=this.connections[t];if(void 0===r)throw new Error("sessionId ".concat(t," does not have a rtc connection"));r.addIce(e.data.ice,this.channel)}}},{key:"updatePresence",value:function(e){if(!Array.isArray(e))throw new Error("sessionIds required");this.presentSessionIds=e}},{key:"addPresence",value:function(e){if(void 0===e)throw new Error("sessionId required");-1===this.presentSessionIds.indexOf(e)&&this.presentSessionIds.push(e)}},{key:"cleanConnections",value:function(){var e=this;Object.keys(this.connections).forEach((function(t){if(-1===e.presentSessionIds.indexOf(t)){var r=e.connections[t];void 0!==r&&void 0!==r.rtc&&(r.rtc.close(),delete r.rtc),delete e.connections[t]}}))}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=c},{"./rtc_connection":9,debug:76}],11:[function(e,t,r){"use strict";var n,o=e("debug")("ls-classroom:s3"),i=e("axios").default,a={},s=!1,c=[],u=function(){return o("[fetchPresignedConfig] presignedConfig ->",n),new Promise((function(e){void 0===n?(o("[updatePresignedConfig]"),s?new Promise((function(e){c.push(e)})):(s=!0,i({method:"post",url:"https://devices.classroom.relay.school/pre",headers:{"x-api-key":"G52kOXvb7p7UbwFRV3ahn74m6xklosio2XUdLlTL","Content-Type":"application/json",customerId:"62-1656-A000"},data:{}}).then((function(e){return o("[updatePresignedConfig] success ->",e),s=!1,n=e.data,c.forEach((function(e){e(n)})),c=[],setTimeout((function(){s=!1,n=void 0}),36e5),n})).catch((function(e){s=!1,console.error("[updatePresignedConfig] error ->",e)})))).then(e):e(n)}))},l=function(e,t,r){return u().then((function(n){return new Promise((function(o,i){var a=n.prefix+e,s=new FormData;s.append("key",a),Object.keys(n.presigned.fields).forEach((function(e){s.append(e,n.presigned.fields[e])})),s.append("file",t);var c=new XMLHttpRequest;void 0!==r&&(c.responseType=r),c.open("POST",n.presigned.url,!0),c.send(s),c.onload=function(){o(a)},c.onerror=i,c.ontimeout=i}))}))};a.SaveText=function(e,t){if(o("[SaveText] key: ",e," body: ",t),"string"!=typeof e)throw new Error("key must be a string");if("string"!=typeof t)throw new Error("body must be a string");return l(e,t)},a.SaveImage=function(e,t){if(o("[SaveImage] key: ",e),"string"!=typeof e)throw new Error("key must be a string");if("string"!=typeof t)throw new Error("body must be a dataURL string");return l(e,function(e){var t;if(-1===e.indexOf(";base64,"))return t=e.split(","),new Blob([decodeURIComponent(t[1])],{type:t[0].split(":")[1]});t=e.split(";base64,");for(var r=window.atob(t[1]),n=r.length,o=0,i=new Uint8Array(n);o<n;++o)i[o]=r.charCodeAt(o);return new Blob([i],{type:t[0].split(":")[1]})}(t),"blob")},t.exports=a},{axios:24,debug:76}],12:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=e("debug")("ls-classroom:scheduler"),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.groupSchedules={},this.groupStates={},this.checkInt=setInterval(this.updateActive.bind(this),15e3)}var t,r,i;return t=e,(r=[{key:"setGroups",value:function(e){if(!Array.isArray(e))throw new Error("groups required");var t={};e.forEach((function(e){t[e.id]={},e.class_schedule&&"object"===n(e.class_schedule)&&Object.keys(e.class_schedule).forEach((function(r){r.split("").map((function(e){return parseInt(e,10)})).forEach((function(n){t[e.id][n]=e.class_schedule[r]}))}))})),this.groupSchedules=t,this.updateActive()}},{key:"isGroupActive",value:function(e){if(void 0===e)throw new Error("groupId required");var t=new Date,r=t.getHours()+t.getMinutes()/100,n=this.groupSchedules[e];if(void 0!==n){var o=n[t.getDay()];if(void 0!==o&&o.s<=r&&r<o.e)return!0}return!1}},{key:"updateActive",value:function(){var e=this;a("[updateActive]");var t={},r=[],n=[];Object.keys(this.groupSchedules).forEach((function(o){t[o]=e.isGroupActive(o),t[o]&&!e.groupStates[o]?n.push(o):!t[o]&&e.groupStates[o]&&r.push(o)})),Object.keys(this.groupStates).forEach((function(e){void 0===t[e]&&r.push(e)})),"undefined"!=typeof document&&"function"==typeof document.dispatchEvent&&(n.forEach((function(e){var t=new Event("GroupSchedule");t.groupId=e,t.newState="online",document.dispatchEvent(t)})),r.forEach((function(e){var t=new Event("GroupSchedule");t.groupId=e,t.newState="offline",document.dispatchEvent(t)}))),this.groupStates=t}},{key:"addListener",value:function(){}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=s},{debug:76}],13:[function(e,t,r){(function(r){(function(){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=e("debug")("ls-classroom:snapshot"),s=e("./s3"),c=function(){function e(t,n){var o=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"!=typeof t)throw new Error("dataURL required");this.user=n,this.username=this.user.attributes.username,this.dataComplete=!1,this.at=new Date;var i=this.at.getTime().toString(36);this.dataURL=t,this.TabsKey="".concat(i,"/").concat(this.username,"/").concat(r.sessionId,"/tabs.json"),this.ImageKey="".concat(i,"/").concat(this.username,"/").concat(r.sessionId,"/image.jpg"),this.MetaKey="".concat(i,"/").concat(this.username,"/").concat(r.sessionId,"/meta.json"),this.getCurrentTabs().then((function(e){o.tabs=e,o.dataComplete=!0})).catch((function(e){console.error("[snapshot] error ->",e)}))}var t,n,i;return t=e,(n=[{key:"getCurrentTabs",value:function(){return new Promise((function(e,t){if("undefined"!=typeof chrome&&void 0!==chrome.tabs&&"function"==typeof chrome.tabs.query)return chrome.tabs.query({},(function(t){var r=t.map((function(e){return{active:e.active,id:e.id,title:e.title,url:e.url,windowId:e.windowId,favico:e.favIconUrl}}));e(r)}));t(new Error("error querying chrome tabs api"))}))}},{key:"Save",value:function(){var e=this;return this.dataComplete?s.SaveText(this.TabsKey,JSON.stringify(this.tabs)).then((function(t){return s.SaveImage(e.ImageKey,e.dataURL).then((function(n){a("[Save] tabs: ",t," imageKey: ",n);var o={un:e.username,at:e.at.toISOString(),tKey:t,iKey:n,sId:r.sessionId};return s.SaveText(e.MetaKey,JSON.stringify(o))}))})):new Promise((function(t){var r=setInterval((function(){if(e.dataComplete)return clearInterval(r),e.Save().then(t)}),100)}))}}])&&o(t.prototype,n),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=c}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./s3":11,debug:76}],14:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}var a=e("debug")("ls-classroom:tabcapture"),s=e("./snapshot"),c=e("./rtc_connection_handler"),u=e("../utilities/capture"),l=u.isValidTabs,f=u.checkListenerQuality,d=u.getCurrentCaptureInfo,h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a("[TabCapture] init"),this.createCanvas(),this.checkCaptureStatus(),this.snapshots=[],this.listenerQuality=null,this.capturingInterval=null,this.policy=null;var t=this.captureRecording.bind(this),r=this.captureActiveTab.bind(this,t);setInterval(r,1e4),setInterval(this.checkCaptureStatus.bind(this),1e3)}var t,r,i;return t=e,(r=[{key:"createCanvas",value:function(){void 0===this.canvas&&(this.canvas=document.createElement("canvas"),this.canvasCtx=this.canvas.getContext("2d"))}},{key:"checkCaptureStatus",value:function(){var e=f(this.user);if(e!==this.listenerQuality){if(!e&&this.listenerQuality&&a("[checkCaptureStatus] tab capture stopped"),this.listenerQuality=e,e&&a("[checkCaptureStatus] capturing on ->",e),clearInterval(this.capturingInterval),!e)return void(this.capturingInterval=null);var t=this.captureImageToStream.bind(this),r=this.captureActiveTab.bind(this,t);this.capturingInterval=setInterval(r,2e3)}}},{key:"captureActiveTab",value:function(e){var t=d(this.listenerQuality).jpegQuality;try{chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(r){l(r)?chrome.tabs.captureVisibleTab({quality:t},(function(t){if("string"!=typeof t)throw new Error("dataUrl required");if(!t.match(/^data:image\/jpeg;base64/))throw new Error("invalid dataUrl");a("[captureActiveTab] successful capture"),e(t)})):a("[captureActiveTab] invalid tab")}))}catch(e){console.error("[captureActiveTab] error ->",e)}}},{key:"captureImageToStream",value:function(e){var t=this;this.policy&&!this.policy.isClassroomActive()||e&&(void 0===this.img&&(this.img=document.createElement("img"),this.img.addEventListener("load",(function(){var e=d(t.listenerQuality).screenDivisor;if(t.img.width>0&&t.img.height>0){var r=Math.ceil(t.img.width/e),n=Math.ceil(t.img.height/e);t.canvas.width=r,t.canvas.height=n,t.canvasCtx.drawImage(t.img,0,0,t.canvas.width,t.canvas.height),a("[captureActiveTab] drawing image to canvas")}}))),this.img.setAttribute("src",e))}},{key:"captureRecording",value:function(e){this.snapshots.push(new s(e,this.user)),this.snapshots.length>10&&(this.snapshots=this.snapshots.slice(this.snapshots.length-10,this.snapshots.length),this.snapshots=this.snapshots.slice(this.snapshots.length-10,this.snapshots.length)),void 0!==this.user&&this.user.recording&&this.saveRecordings()}},{key:"saveRecordings",value:function(){var e=this.snapshots;this.snapshots=[],e.forEach((function(e){return e.Save()}))}},{key:"setUser",value:function(e,t){var r=this;if("object"!==n(e))throw new Error("user object required");if(this.user=e,void 0!==e.channel&&(void 0===this.connectionHandler||t)){var o=d("high").fps,i=this.canvas.captureStream(o);this.connectionHandler=new c(i,this.user.channel),this.policy?this.connectionHandler.policy=this.policy:this.user&&this.user.policy&&(this.connectionHandler.policy=this.user.policy),a("[setUser] connectionHandler"),this.rtcPresenceInt=setInterval((function(){var e=[];Object.keys(r.user.presence).forEach((function(t){if(r.user.presence[t]){var n=r.user.presence[t].sessionId;void 0!==n&&-1===e.indexOf(n)&&e.push(n)}})),r.connectionHandler.updatePresence(e)}),3e4)}}}])&&o(t.prototype,r),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=h},{"../utilities/capture":20,"./rtc_connection_handler":10,"./snapshot":13,debug:76}],15:[function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i,a=e("debug")("ls-classroom:tab_reporter"),s=e("../utilities/groups"),c=s.getAllActiveGroupGuids,u=s.setCurrentHost,l=[],f=[],d=null;setInterval((function(){if(i)if(i.isClassroomActive()){var e=!1;for(var t in i.groups)if(i.groups[t].isActive()){e=!0;break}if(e){var r=n(f);f=[],0!==r.length&&(a("[reportSessionTabs] sending report ->",r),LSClassroomWASM.SendReport(r))}else a("[reportSessionTabs] no active groups detected, not reporting")}else a("[reportSessionTabs] Classroom is not active, not reporting");else console.error("Unable to report visited urls, policy was not provided to TabReporter.Configure.")}),45e3),chrome.tabs.onUpdated.addListener((function(e,t){var r=t.url;r&&c(i).forEach((function(e,t){var n=Date.now()+t;f.push({gguid:e,url:r,at:n})}))})),chrome.tabs.onActivated.addListener((function(e){var t=e.tabId;d=t,t&&!l.includes(t)&&l.push(t)})),document.addEventListener("GroupSchedule",(function(e){if("online"===e.newState){var t=e.groupId,r=i.groups[t];if(r){var n=r.id;l.forEach((function(e){chrome.tabs.get(e,(function(t){if(!chrome.runtime.lastError){var o=t.url;f.push({gguid:n,url:o,at:Date.now()}),d===e&&u(r,t)}}))}))}}})),t.exports.Configure=function(e){e.policy&&(i=e.policy)}},{"../utilities/groups":21,debug:76}],16:[function(e,t,r){(function(t){(function(){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */n=function(){return t};var e,t={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==o&&i.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function n(o,a,s,c){var u=h(e[o],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==r(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[c];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(r(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function o(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){o(a,n,i,s,c,"next",e)}function c(e){o(a,n,i,s,c,"throw",e)}s(void 0)}))}}var a,s,c=e("debug")("ls-classroom:telemetry"),u=e("ls-telemetry-js"),l=e("./config"),f=chrome.runtime.getManifest(),d=t.env.LS_TELEMETRY_INT||36e5,h=[30,60,120,300],p=0;function m(){return(m=i(n().mark((function e(t){var r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.chromeUser!==a){e.next=3;break}return c("[SetUser] no user change ->",t.chromeUser),e.abrupt("return");case 3:return a=t.chromeUser,e.next=6,l.GetStorage("ls_udid");case 6:(r=e.sent)||(r=u.GetUDID(),l.SetStorage({ls_udid:r})),u.SetAgentUser({email:a,udid:r,username:a}),o=y(5,30),c("[SetUser] report delay ->",o),setTimeout(v,o);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){return 1e3*Math.floor(Math.random()*(t-e+1)+e)}function g(e){var t=h.length;return e>=t?h[t-1]:h[e-1]}function v(){return b.apply(this,arguments)}function b(){return(b=i(n().mark((function e(){var t,r,o,i,a,h;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.GetStorage("lastTelemetryReport");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0="0:0";case 5:if(t=e.t0,r=t.split(":"),c("[telemetryReport] lastReport ->",r),o=f.version.split(".").slice(0,-1).join("."),i=w(),a=d,r[0]===i.toString()&&r[1]===o){e.next=18;break}return e.next=14,u.SendReport();case 14:e.sent.ok?(l.SetStorage({lastTelemetryReport:"".concat(i,":").concat(o)}),p=0,c("[telemetryReport] report successful")):(p++,h=1e3*g(p),c("[telemetryReport] report retry ->",h),a=h),e.next=19;break;case 18:c("[telemetryReport] already reported for today");case 19:s&&clearTimeout(s),s=setTimeout(v,a);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){var e=new Date,t=e.getFullYear(),r="0"+(e.getMonth()+1),n="0"+e.getDate();return"".concat(t,"-").concat(r.slice(-2),"-").concat(n.slice(-2))}u.Init({agent_type:"classroom",agent_version:f.version,customer_id:"62-1656-A000",ls_telemetry_host:"agent-backend-api-production.lightspeedsystems.com",ls_telemetry_key:"l4glwgbrumye5fll6q2yxp38lmb2hd39wrioqp9a",product:"classroom"}),LSClassroomWASM.SetIdentCB((function(e){return m.apply(this,arguments)})),LSClassroomWASM.SetIPCB(u.SetPublicIp)}).call(this)}).call(this,e("_process"))},{"./config":2,_process:83,debug:76,"ls-telemetry-js":80}],17:[function(e,t,r){"use strict";function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */n=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,a=Object.create(o.prototype),s=new T(n||[]);return i(a,"_invoke",{value:A(e,r,s)}),a}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&o.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(n,i,a,c){var u=h(e[n],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==s(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,c)}))}c(u.arg)}var n;i(this,"_invoke",{value:function(e,o){function i(){return new t((function(t,n){r(e,o,t,n)}))}return n=n?n.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(s(t)+" is not iterable")}return b.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function o(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){o(a,n,i,s,c,"next",e)}function c(e){o(a,n,i,s,c,"throw",e)}s(void 0)}))}}function a(e,t,r){return(t=u(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:String(t)}var l=e("debug")("ls-classroom:user"),f=chrome.runtime.getManifest();function d(e,t){return new Promise((function(r,n){e.presence.get({clientId:t},(function(e,t){if(e)return l("[getUserPresence] error retrieving list ->",e),void n(e);r(t)}))}))}var h=function(){function e(t,r,n,o){var i=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"object"!==s(t))throw new Error("user attributes required");if("string"!=typeof t.email)throw new Error("email must be a string");if("object"!==s(r))throw new Error("ably object required");if("string"!=typeof n)throw new Error("customerId required");if("object"!==s(o))throw new Error("commands object required");this.attributes=t,this.presence={},this.lastGroupMsg={},this.recording=!1,this.recordUntil=0,this.commands=o,this.setAbly(r,n),"undefined"!=typeof document&&"function"==typeof document.addEventListener&&(document.addEventListener("GroupUpdate",(function(e){l("[GroupUpdate] ->",e),e.stopPropagation();var t={agentType:"chrome"};t.currentHost=e.attributes.currentHost,t.favico=e.attributes.favico,t.visits=e.attributes.visits,t.top=e.attributes.top,t.topTime=e.attributes.topTime,t.insightHost=e.attributes.insightHost,i.lastGroupMsg[e.groupId]=t,i.publishGroupUpdate(a({},e.groupId,t))})),document.addEventListener("startRecording",(function(e){e.stopPropagation(),l("[startRecording] ->",e);var t=(new Date).getTime()+e.duration;i.recording=!0;var r=new Event("setState");if(r.updateRecording=!0,document.dispatchEvent(r),i.recordUntil<t){if(l("[startRecording] duration is longer than current recording duration, updating"),i.recordUntil=t,void 0!==i.clearRecordTimeoutID)try{clearTimeout(i.clearRecordTimeoutID),delete i.clearRecordTimeoutID}catch(e){console.error("[startRecording] error ->",e)}i.clearRecordTimeoutID=setTimeout((function(){l("[clearRecordTimeoutID] setting recording to false\nthis ->",i),i.recording=!1,(r=new Event("setState")).updateRecording=!0,document.dispatchEvent(r)}),e.duration),l("[startRecording] new recordUntil: ",i.recordUntil," timeoutID: ",i.clearRecordTimeoutID,"\nthis:",i)}}))),this.watchUserPresence()}var t,r,o,u,h;return t=e,(r=[{key:"setAbly",value:function(e,t){var r=this;this.channel=e.channels.get("".concat(t,":").concat(this.attributes.email));try{this.channel.presence.get((function(e,t){if(e)return l("[presence] get presence error ->",e);t.forEach(r.updatePresence.bind(r))}))}catch(e){console.error("[presence] get error ->",e)}this.channel.presence.subscribe(this.updatePresence.bind(this)),this.channel.presence.enter(this.currentState||{state:"working",recording:!1,agent_platform:"cros",agent_version:f.version},(function(e){e&&(console.error("[presence] enter presence error ->",e),r.refreshPresence())})),this.channel.subscribe("closeTab",this.onCloseTab.bind(this)),this.channel.subscribe("focusTab",this.onFocusTab.bind(this)),this.channel.subscribe("sendGroupUpdate",(function(e){if(l("[sendGroupUpdate] msg ->",e),"object"===s(e.data)&&e.data.groupGuid){var t=r.lastGroupMsg[e.data.groupGuid]||{};r.publishGroupUpdate(a({},e.data.groupGuid,t),!0)}})),this.commands.applyBindings(this.channel)}},{key:"refreshPresence",value:function(){var e=this.currentState||{state:"working",recording:!1,agent_platform:"cros",agent_version:f.version};l("[refreshPresence] setting presence state ->",e),this.channel.presence.update(e)}},{key:"watchUserPresenceCheck",value:(h=i(n().mark((function e(){var t,r,o,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(this.channel,this.attributes.email);case 3:t=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),l("[watchUserPresenceCheck] error obtaining presence ->",e.t0),e.abrupt("return");case 10:if(l("[watchUserPresenceCheck] checking presence state using email: ",this.attributes.email," got: ",t),0!==t.length){e.next=15;break}return l("[watchUserPresenceCheck] refreshing empty presence list"),this.refreshPresence(),e.abrupt("return");case 15:r=0,o=t.length;case 16:if(!(r<o)){e.next=24;break}if((i=t[r]).clientId!==this.attributes.email||void 0===i.data.state){e.next=21;break}return l("[watchUserPresenceCheck] We have a presence, no need to refresh."),e.abrupt("return");case 21:r++,e.next=16;break;case 24:l("[watchUserPresenceCheck] no valid presence found, refreshing"),this.refreshPresence();case 26:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return h.apply(this,arguments)})},{key:"watchUserPresence",value:function(){this.watchUserPresenceIntId&&(clearInterval(this.watchUserPresenceIntId),this.watchUserPresenceIntId=void 0),l("[watchUserPresence] starting timer"),this.watchUserPresenceIntId=setInterval(this.watchUserPresenceCheck.bind(this),3e4)}},{key:"groupHasListener",value:function(e){var t=this,r=!1;return Object.keys(this.presence).some((function(n){var o=t.presence[n];if(l("[groupHasListener] presence data ->",o),void 0!==o.groupGuid&&o.groupGuid===e)return r=!0,!0})),l("[groupHasListener] group: ",e," is ",r),r}},{key:"getActiveWindowActiveTabUrl",value:function(){return new Promise((function(e,t){try{chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(t){var r=t[0]&&t[0].url?t[0].url:null;e(r)}))}catch(e){t(e)}}))}},{key:"publishGroupUpdate",value:(u=i(n().mark((function e(t,r){var o,i,a,s,c,u=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l("[publishGroupUpdate] sending: ",t," force send is:",r),e.next=3,this.getActiveWindowActiveTabUrl();case 3:if(o=e.sent,i=Object.keys(t)[0],t[i].activeWindowActiveTabUrl=o,this.policy&&!this.policy.isClassroomActive()?(l("[Classroom] IS NOT active"),a=Object.keys(t)[0],s=Object.values(t)[0],t[a]=Object.assign({},s,{activeWindowActiveTabUrl:null,currentHost:null,favico:null,top:null})):l("[Classroom] is active"),l("[publishGroupUpdate] data ->",t),!r){e.next=13;break}if(!this.policy||this.policy.isClassroomActive()){e.next=11;break}return e.abrupt("return");case 11:return this.channel.publish("groupUpdate",t),e.abrupt("return");case 13:if(c={},Object.keys(t).forEach((function(e){u.groupHasListener(e)&&(c[e]=t[e])})),l("[publishGroupUpdate] sending ->",c),!(Object.keys(c).length>0)){e.next=20;break}if(!this.policy||this.policy.isClassroomActive()){e.next=19;break}return e.abrupt("return");case 19:this.channel.publish("groupUpdate",t);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"updatePresence",value:function(e){if("object"!==s(e))throw new Error("presence event required");if(l("[updatePresence] presence new event ->",e),"leave"===e.action)delete this.presence[e.connectionId];else{var t=this.presence[e.connectionId]||{};if(this.presence[e.connectionId]=e.data,this.presence[e.connectionId].clientId=e.clientId,!t.viewingTabs&&e.data&&e.data.viewingTabs&&this.sendTabs(),t.groupId!==e.data.groupId){var r=e.data.groupId,n=this.lastGroupMsg[r];l("[updatePresence] connectionId ".concat(e.connectionId," joined a new group, resending last packet")),void 0!==n&&this.publishGroupUpdate(a({},r,n),!0)}}l("[updatePresence] updated presence list ->",this.presence)}},{key:"listenerHasFlag",value:function(e){var t=this;if("string"!=typeof e)throw new Error("flagName must be a string");var r=!1;return Object.keys(this.presence).some((function(n){if("object"===s(t.presence[n])&&Boolean(t.presence[n][e]))return r=!0,!0})),r}},{key:"sendTabs",value:function(){!this.policy||this.policy.isClassroomActive()?this.listenerHasFlag("viewingTabs")&&LSClassroomWASM.SendTabs():this.channel.publish("tabs",[])}},{key:"onCloseTab",value:function(e){l("[onCloseTab] msg ->",e),this.policy&&!this.policy.isClassroomActive()||"object"===s(e)&&"object"===s(e.data)&&("number"==typeof e.data.tabId?chrome.tabs.remove(e.data.tabId):"string"==typeof e.data.url&&chrome.tabs.query({},(function(t){t.forEach((function(t){t.url===e.data.url&&chrome.tabs.remove(t.id)}))})))}},{key:"onFocusTab",value:function(e){l("[onFocusTab] ->",e),this.policy&&!this.policy.isClassroomActive()||"object"===s(e)&&"object"===s(e.data)&&"number"==typeof e.data.windowId&&"number"==typeof e.data.tabId&&chrome.windows.update(e.data.windowId,{focused:!0},(function(){chrome.tabs.update(e.data.tabId,{active:!0})}))}}])&&c(t.prototype,r),o&&c(t,o),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.exports=h},{debug:76}],18:[function(e,t,r){"use strict";function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e("./wasm_exec");var i,a=e("debug")("ls-classroom:wasm"),s=chrome.runtime.getManifest(),c={ident:[],ip:[],tab:[]};!function e(){var t=new Go;WebAssembly.instantiateStreaming(fetch(chrome.runtime.getURL("classroom.wasm")),t.importObject).then((function(e){t.run(e.instance),LSClassroomWASM.Setup("62-1656-A000",s.version)})).catch((function(t){console.error("[setup] error ->",t),i&&clearTimeout(i),i=setTimeout(e,5e3)}))}(),t.exports.Debug=a,t.exports.GetPolicy=function(){if("undefined"!=typeof Event){var e=new Event("policyUpdate");e.triggeredAt=Date.now(),document.dispatchEvent(e)}},t.exports.SetIdentCB=function(e){c.ident.push(e)},t.exports.SendIdentCB=function(e){var t,r=n(c.ident);try{for(r.s();!(t=r.n()).done;){var o=t.value;try{o(e)}catch(e){a("[SendIdentCB] Error triggering callback ->",e)}}}catch(e){r.e(e)}finally{r.f()}},t.exports.SetIPCB=function(e){c.ip.push(e)},t.exports.SendIPCB=function(e){var t,r=n(c.ip);try{for(r.s();!(t=r.n()).done;){var o=t.value;try{o(e)}catch(e){a("[SendIPCB] Error triggering callback ->",e)}}}catch(e){r.e(e)}finally{r.f()}},t.exports.SetTabCB=function(e){c.tab.push(e)},t.exports.SendTabCB=function(e){var t,r=n(c.tab);try{for(r.s();!(t=r.n()).done;){var o=t.value;try{o(e)}catch(e){a("[SendTabCB] Error triggering callback ->",e)}}}catch(e){r.e(e)}finally{r.f()}}},{"./wasm_exec":19,debug:76}],19:[function(e,t,r){"use strict";function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */n=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&o.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(n,a,s,c){var u=h(e[n],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==i(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var n;a(this,"_invoke",{value:function(e,o){function i(){return new t((function(t,n){r(e,o,t,n)}))}return n=n?n.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(i(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function o(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:String(t)}!function(){var e=function(){var e=new Error("not implemented");return e.code="ENOSYS",e};if(!globalThis.fs){var t="";globalThis.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync:function(e,r){var n=(t+=s.decode(r)).lastIndexOf("\n");return-1!==n&&(console.log(t.substring(0,n)),t=t.substring(n+1)),r.length},write:function(t,r,n,o,i,a){0===n&&o===r.length&&null===i?a(null,this.writeSync(t,r)):a(e())},chmod:function(t,r,n){n(e())},chown:function(t,r,n,o){o(e())},close:function(t,r){r(e())},fchmod:function(t,r,n){n(e())},fchown:function(t,r,n,o){o(e())},fstat:function(t,r){r(e())},fsync:function(e,t){t(null)},ftruncate:function(t,r,n){n(e())},lchown:function(t,r,n,o){o(e())},link:function(t,r,n){n(e())},lstat:function(t,r){r(e())},mkdir:function(t,r,n){n(e())},open:function(t,r,n,o){o(e())},read:function(t,r,n,o,i,a){a(e())},readdir:function(t,r){r(e())},readlink:function(t,r){r(e())},rename:function(t,r,n){n(e())},rmdir:function(t,r){r(e())},stat:function(t,r){r(e())},symlink:function(t,r,n){n(e())},truncate:function(t,r,n){n(e())},unlink:function(t,r){r(e())},utimes:function(t,r,n,o){o(e())}}}if(globalThis.process||(globalThis.process={getuid:function(){return-1},getgid:function(){return-1},geteuid:function(){return-1},getegid:function(){return-1},getgroups:function(){throw e()},pid:-1,ppid:-1,umask:function(){throw e()},cwd:function(){throw e()},chdir:function(){throw e()}}),!globalThis.crypto)throw new Error("globalThis.crypto is not available, polyfill required (crypto.getRandomValues only)");if(!globalThis.performance)throw new Error("globalThis.performance is not available, polyfill required (performance.now only)");if(!globalThis.TextEncoder)throw new Error("globalThis.TextEncoder is not available, polyfill required");if(!globalThis.TextDecoder)throw new Error("globalThis.TextDecoder is not available, polyfill required");var r=new TextEncoder("utf-8"),s=new TextDecoder("utf-8");globalThis.Go=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.argv=["js"],this.env={},this.exit=function(e){0!==e&&console.warn("exit code:",e)},this._exitPromise=new Promise((function(e){t._resolveExitPromise=e})),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;var n=function(e,r){t.mem.setUint32(e+0,r,!0),t.mem.setUint32(e+4,Math.floor(r/4294967296),!0)},o=function(e){return t.mem.getUint32(e+0,!0)+4294967296*t.mem.getInt32(e+4,!0)},a=function(e){var r=t.mem.getFloat64(e,!0);if(0!==r){if(!isNaN(r))return r;var n=t.mem.getUint32(e,!0);return t._values[n]}},c=function(e,r){if("number"==typeof r&&0!==r)return isNaN(r)?(t.mem.setUint32(e+4,2146959360,!0),void t.mem.setUint32(e,0,!0)):void t.mem.setFloat64(e,r,!0);if(void 0!==r){var n=t._ids.get(r);void 0===n&&(void 0===(n=t._idPool.pop())&&(n=t._values.length),t._values[n]=r,t._goRefCounts[n]=0,t._ids.set(r,n)),t._goRefCounts[n]++;var o=0;switch(i(r)){case"object":null!==r&&(o=1);break;case"string":o=2;break;case"symbol":o=3;break;case"function":o=4}t.mem.setUint32(e+4,2146959360|o,!0),t.mem.setUint32(e,n,!0)}else t.mem.setFloat64(e,0,!0)},u=function(e){var r=o(e+0),n=o(e+8);return new Uint8Array(t._inst.exports.mem.buffer,r,n)},l=function(e){for(var t=o(e+0),r=o(e+8),n=new Array(r),i=0;i<r;i++)n[i]=a(t+8*i);return n},f=function(e){var r=o(e+0),n=o(e+8);return s.decode(new DataView(t._inst.exports.mem.buffer,r,n))},d=Date.now()-performance.now();this.importObject={_gotest:{add:function(e,t){return e+t}},gojs:{"runtime.wasmExit":function(e){e>>>=0;var r=t.mem.getInt32(e+8,!0);t.exited=!0,delete t._inst,delete t._values,delete t._goRefCounts,delete t._ids,delete t._idPool,t.exit(r)},"runtime.wasmWrite":function(e){var r=o((e>>>=0)+8),n=o(e+16),i=t.mem.getInt32(e+24,!0);fs.writeSync(r,new Uint8Array(t._inst.exports.mem.buffer,n,i))},"runtime.resetMemoryDataView":function(e){t.mem=new DataView(t._inst.exports.mem.buffer)},"runtime.nanotime1":function(e){n((e>>>=0)+8,1e6*(d+performance.now()))},"runtime.walltime":function(e){e>>>=0;var r=(new Date).getTime();n(e+8,r/1e3),t.mem.setInt32(e+16,r%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":function(e){e>>>=0;var r=t._nextCallbackTimeoutID;t._nextCallbackTimeoutID++,t._scheduledTimeouts.set(r,setTimeout((function(){for(t._resume();t._scheduledTimeouts.has(r);)console.warn("scheduleTimeoutEvent: missed timeout event"),t._resume()}),o(e+8))),t.mem.setInt32(e+16,r,!0)},"runtime.clearTimeoutEvent":function(e){e>>>=0;var r=t.mem.getInt32(e+8,!0);clearTimeout(t._scheduledTimeouts.get(r)),t._scheduledTimeouts.delete(r)},"runtime.getRandomData":function(e){e>>>=0,crypto.getRandomValues(u(e+8))},"syscall/js.finalizeRef":function(e){e>>>=0;var r=t.mem.getUint32(e+8,!0);if(t._goRefCounts[r]--,0===t._goRefCounts[r]){var n=t._values[r];t._values[r]=null,t._ids.delete(n),t._idPool.push(r)}},"syscall/js.stringVal":function(e){c((e>>>=0)+24,f(e+8))},"syscall/js.valueGet":function(e){e>>>=0;var r=Reflect.get(a(e+8),f(e+16));e=t._inst.exports.getsp()>>>0,c(e+32,r)},"syscall/js.valueSet":function(e){e>>>=0,Reflect.set(a(e+8),f(e+16),a(e+32))},"syscall/js.valueDelete":function(e){e>>>=0,Reflect.deleteProperty(a(e+8),f(e+16))},"syscall/js.valueIndex":function(e){c((e>>>=0)+24,Reflect.get(a(e+8),o(e+16)))},"syscall/js.valueSetIndex":function(e){e>>>=0,Reflect.set(a(e+8),o(e+16),a(e+24))},"syscall/js.valueCall":function(e){e>>>=0;try{var r=a(e+8),n=Reflect.get(r,f(e+16)),o=l(e+32),i=Reflect.apply(n,r,o);e=t._inst.exports.getsp()>>>0,c(e+56,i),t.mem.setUint8(e+64,1)}catch(r){e=t._inst.exports.getsp()>>>0,c(e+56,r),t.mem.setUint8(e+64,0)}},"syscall/js.valueInvoke":function(e){e>>>=0;try{var r=a(e+8),n=l(e+16),o=Reflect.apply(r,void 0,n);e=t._inst.exports.getsp()>>>0,c(e+40,o),t.mem.setUint8(e+48,1)}catch(r){e=t._inst.exports.getsp()>>>0,c(e+40,r),t.mem.setUint8(e+48,0)}},"syscall/js.valueNew":function(e){e>>>=0;try{var r=a(e+8),n=l(e+16),o=Reflect.construct(r,n);e=t._inst.exports.getsp()>>>0,c(e+40,o),t.mem.setUint8(e+48,1)}catch(r){e=t._inst.exports.getsp()>>>0,c(e+40,r),t.mem.setUint8(e+48,0)}},"syscall/js.valueLength":function(e){n((e>>>=0)+16,parseInt(a(e+8).length))},"syscall/js.valuePrepareString":function(e){e>>>=0;var t=r.encode(String(a(e+8)));c(e+16,t),n(e+24,t.length)},"syscall/js.valueLoadString":function(e){var t=a((e>>>=0)+8);u(e+16).set(t)},"syscall/js.valueInstanceOf":function(e){e>>>=0,t.mem.setUint8(e+24,a(e+8)instanceof a(e+16)?1:0)},"syscall/js.copyBytesToGo":function(e){var r=u((e>>>=0)+8),o=a(e+32);if(o instanceof Uint8Array||o instanceof Uint8ClampedArray){var i=o.subarray(0,r.length);r.set(i),n(e+40,i.length),t.mem.setUint8(e+48,1)}else t.mem.setUint8(e+48,0)},"syscall/js.copyBytesToJS":function(e){var r=a((e>>>=0)+8),o=u(e+16);if(r instanceof Uint8Array||r instanceof Uint8ClampedArray){var i=o.subarray(0,r.length);r.set(i),n(e+40,i.length),t.mem.setUint8(e+48,1)}else t.mem.setUint8(e+48,0)},debug:function(e){console.log(e)}}}}var t,c,u,l,f;return t=e,(c=[{key:"run",value:(l=n().mark((function e(t){var o,i,a,s,c,u=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof WebAssembly.Instance){e.next=2;break}throw new Error("Go.run: WebAssembly.Instance expected");case 2:if(this._inst=t,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,globalThis,this],this._goRefCounts=new Array(this._values.length).fill(1/0),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[globalThis,5],[this,6]]),this._idPool=[],this.exited=!1,o=4096,i=function(e){var t=o,n=r.encode(e+"\0");return new Uint8Array(u.mem.buffer,o,n.length).set(n),(o+=n.length)%8!=0&&(o+=8-o%8),t},a=this.argv.length,s=[],this.argv.forEach((function(e){s.push(i(e))})),s.push(0),Object.keys(this.env).sort().forEach((function(e){s.push(i("".concat(e,"=").concat(u.env[e])))})),s.push(0),c=o,s.forEach((function(e){u.mem.setUint32(o,e,!0),u.mem.setUint32(o+4,0,!0),o+=8})),!(o>=12288)){e.next=23;break}throw new Error("total length of command line and environment variables exceeds limit");case 23:return this._inst.exports.run(a,c),this.exited&&this._resolveExitPromise(),e.next=27,this._exitPromise;case 27:case"end":return e.stop()}}),e,this)})),f=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=l.apply(e,t);function a(e){o(i,r,n,a,s,"next",e)}function s(e){o(i,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return f.apply(this,arguments)})},{key:"_resume",value:function(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}},{key:"_makeFuncWrapper",value:function(e){var t=this;return function(){var r={id:e,this:this,args:arguments};return t._pendingEvent=r,t._resume(),r.result}}}])&&a(t.prototype,c),u&&a(t,u),Object.defineProperty(t,"prototype",{writable:!1}),e}()}()},{}],20:[function(e,t,r){"use strict";var n=e("../src/config");var o={high:{fps:1,screenDivisor:1,jpegQuality:60},medium:{fps:1,screenDivisor:1,jpegQuality:60},low:{fps:1,screenDivisor:4,jpegQuality:20}};t.exports={isValidTabs:function(e){if(!Array.isArray(e)||0===e.length)return!1;var t=e[0],r=document.createElement("a");return r.href=t.url,!r.protocol||!r.protocol.match(/^chrome/i)},checkListenerQuality:function(e){return void 0===e?null:e.listenerHasFlag("viewingBroadcast")?"high":e.listenerHasFlag("viewingFlyout")?"medium":e.listenerHasFlag("viewingThumbnail")?"low":e.listenerHasFlag("viewingScreen")?"medium":void 0},getCurrentCaptureInfo:function(e){var t=n.GetJpegQuality();return t&&t>0&&t<=100?{fps:1,screenDivisor:1,jpegQuality:t}:o[e]||o.medium}}},{"../src/config":2}],21:[function(e,t,r){"use strict";t.exports={getAllActiveGroupGuids:function(e){if(!e||!e.isClassroomActive())return[];var t=[];for(var r in e.groups)e.groups[r].isActive()&&t.push(e.groups[r].id);return t},setCurrentHost:function(e,t){if(t&&e){var r=t.favIconUrl||null,n=document.createElement("a");n.href=t.url,e.setCurrent(n.hostname,r)}}}},{}],22:[function(e,t,r){"use strict";var n=e("debug")("ls-classroom:tabs");t.exports={filterTabs:function(e){if(e.isClassroomActive())return new Promise((function(t,r){return chrome.tabs.query({},(function(o){if(e.isClassroomActive()){var i="https://devices.classroom.relay.school/block",a=[];return o.forEach((function(t){if(n("[filterTabs] tab: ",t),t.url&&!t.url.startsWith(i)&&!t.url.match(/^chrome[^:]*:/i)&&t.url.match(/^https?:\/\//i)){var r,o,s=Object.keys(e.groups).map((function(n){var i=e.groups[n],a=i.scoreUrl(t.url).allowed;return!1===a&&(r=i.id,o=i.encryptedUserEmail),a}));if(n("[filterTabs] tab: ",t," decisions: ",s),-1!==s.indexOf(!1)&&-1===s.indexOf(!0)){var c=i;r&&(c+="?guid=".concat(r,"&cId=").concat(e.encryptedCustomerId,"&encryptedUserEmail=").concat(o)),a.push(function(e,t,r){if(r.isClassroomActive())return new Promise((function(r){return chrome.tabs.update(e,{url:t},(function(){r()}))}))}(t.id,c,e))}}})),Promise.all(a).then(t).catch(r)}}))}))}}},{debug:76}],23:[function(e,t,r){(function(e){(function(){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*!
 * @license Copyright 2015-2022 Ably Real-time Ltd (ably.com)
 * 
 * Ably JavaScript Library v1.2.48
 * https://github.com/ably/ably-js
 * 
 * Released under the Apache Licence v2.0
 */var o,i;o=window,i=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===n(e)&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(o,i,function(t){return e[t]}.bind(null,i));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=42)}([function(e,t,r){r.r(t),r.d(t,"__extends",(function(){return i})),r.d(t,"__assign",(function(){return a})),r.d(t,"__rest",(function(){return s})),r.d(t,"__decorate",(function(){return c})),r.d(t,"__param",(function(){return u})),r.d(t,"__metadata",(function(){return l})),r.d(t,"__awaiter",(function(){return f})),r.d(t,"__generator",(function(){return d})),r.d(t,"__createBinding",(function(){return h})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return m})),r.d(t,"__read",(function(){return y})),r.d(t,"__spread",(function(){return g})),r.d(t,"__spreadArrays",(function(){return v})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return w})),r.d(t,"__asyncGenerator",(function(){return _})),r.d(t,"__asyncDelegator",(function(){return O})),r.d(t,"__asyncValues",(function(){return S})),r.d(t,"__makeTemplateObject",(function(){return E})),r.d(t,"__importStar",(function(){return C})),r.d(t,"__importDefault",(function(){return A})),r.d(t,"__classPrivateFieldGet",(function(){return x})),r.d(t,"__classPrivateFieldSet",(function(){return j}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function c(e,t,r,o){var i,a=arguments.length,s=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(a<3?i(s):a>3?i(t,r,s):i(t,r))||s);return a>3&&s&&Object.defineProperty(t,r,s),s}function u(e,t){return function(r,n){t(r,n,e)}}function l(e,t){if("object"===("undefined"==typeof Reflect?"undefined":n(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var h=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||h(t,e,r)}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function v(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,u):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){s("next",e)}function u(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function O(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:w(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=m(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&h(t,e,r);return k(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function x(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function j(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}},function(t,r,o){(function(t){Object.defineProperty(r,"__esModule",{value:!0}),r.allToUpperCase=r.allToLowerCase=r.encodeBody=r.decodeBody=r.Format=r.promisify=r.trim=r.arrChooseN=r.randomHexString=r.randomString=r.cheapRandStr=r.dataSizeBytes=r.inspectBody=r.inspectError=r.isErrorInfoOrPartialErrorInfo=r.now=r.parseQueryString=r.toQueryString=r.arrPopRandomElement=r.defaultPostHeaders=r.defaultGetHeaders=r.allSame=r.arrEvery=r.arrFilter=r.arrMap=r.safeArrForEach=r.arrForEach=r.forInOwnNonNullProperties=r.valuesArray=r.keysArray=r.arrWithoutValue=r.arrDeleteValue=r.arrIn=r.arrIndexOf=r.arrSubtract=r.arrIntersectOb=r.arrIntersect=r.intersect=r.containsValue=r.inherits=r.prototypicalClone=r.shallowClone=r.isEmptyArg=r.isOnlyPropIn=r.isEmpty=r.isObject=r.ensureArray=r.isArray=r.copy=r.mixin=void 0,r.arrEquals=r.toBase64=r.matchDerivedChannel=r.shallowEquals=r.getGlobalObject=r.getRetryTime=r.getJitterCoefficient=r.getBackoffCoefficient=void 0;var i=o(0),a=i.__importDefault(o(3)),s=i.__importStar(o(8)),c=i.__importDefault(o(4)),u=o(11),l=o(31);function f(e){return Math.floor(Math.random()*e.length)}function d(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var o=t[n];if(!o)break;var i=Object.prototype.hasOwnProperty;for(var a in o)i&&!i.call(o,a)||(e[a]=o[a])}return e}function h(e){return null==e}function p(e,t){var r=function(){};r.prototype=e;var n=new r;return t&&d(n,t),n}function m(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o];-1!=(0,r.arrIndexOf)(t,i)&&n.push(i)}return n}function y(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];o in t&&r.push(o)}return r}function g(e,t){var n=(0,r.arrIndexOf)(e,t),o=-1!=n;return o&&e.splice(n,1),o}r.mixin=d,r.copy=function(e){return d({},e)},r.isArray=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},r.ensureArray=function(e){return h(e)?[]:(0,r.isArray)(e)?e:[e]},r.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},r.isEmpty=function(e){for(var t in e)return!1;return!0},r.isOnlyPropIn=function(e,t){for(var r in e)if(r!==t)return!1;return!0},r.isEmptyArg=h,r.shallowClone=function(e){var t=new Object;for(var r in e)t[r]=e[r];return t},r.prototypicalClone=p,r.inherits=function(e,t){a.default.Config.inherits?a.default.Config.inherits(e,t):(e.super_=t,e.prototype=p(t.prototype,{constructor:e}))},r.containsValue=function(e,t){for(var r in e)if(e[r]==t)return!0;return!1},r.intersect=function(e,t){return(0,r.isArray)(t)?m(e,t):y(e,t)},r.arrIntersect=m,r.arrIntersectOb=y,r.arrSubtract=function(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o];-1==(0,r.arrIndexOf)(t,i)&&n.push(i)}return n},r.arrIndexOf=Array.prototype.indexOf?function(e,t,r){return e.indexOf(t,r)}:function(e,t,r){r=r||0;for(var n=e.length;r<n;r++)if(e[r]===t)return r;return-1},r.arrIn=function(e,t){return-1!==(0,r.arrIndexOf)(e,t)},r.arrDeleteValue=g,r.arrWithoutValue=function(e,t){var r=e.slice();return g(r,t),r},r.keysArray=function(e,t){var r=[];for(var n in e)t&&!Object.prototype.hasOwnProperty.call(e,n)||r.push(n);return r},r.valuesArray=function(e,t){var r=[];for(var n in e)t&&!Object.prototype.hasOwnProperty.call(e,n)||r.push(e[n]);return r},r.forInOwnNonNullProperties=function(e,t){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&e[r]&&t(r)},r.arrForEach=Array.prototype.forEach?function(e,t){e.forEach(t)}:function(e,t){for(var r=e.length,n=0;n<r;n++)t(e[n],n,e)},r.safeArrForEach=function(e,t){return(0,r.arrForEach)(e.slice(),t)},r.arrMap=Array.prototype.map?function(e,t){return e.map(t)}:function(e,t){for(var r=[],n=e.length,o=0;o<n;o++)r.push(t(e[o],o,e));return r},r.arrFilter=Array.prototype.filter?function(e,t){return e.filter(t)}:function(e,t){for(var r=[],n=e.length,o=0;o<n;o++)t(e[o])&&r.push(e[o]);return r},r.arrEvery=Array.prototype.every?function(e,t){return e.every(t)}:function(e,t){for(var r=e.length,n=0;n<r;n++)if(!t(e[n],n,e))return!1;return!0},r.allSame=function(e,t){if(0===e.length)return!0;var n=e[0][t];return(0,r.arrEvery)(e,(function(e){return e[t]===n}))};var v,b={json:"application/json",jsonp:"application/javascript",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack"};function w(e){return e.splice(f(e),1)[0]}function _(e){return Math.min((e+2)/3,2)}function O(){return 1-.2*Math.random()}r.defaultGetHeaders=function(e,t){return{accept:b[t||v.json],"X-Ably-Version":s.default.protocolVersion.toString(),"Ably-Agent":(0,s.getAgentString)(e)}},r.defaultPostHeaders=function(e,t){var r;return{accept:r=b[t||v.json],"content-type":r,"X-Ably-Version":s.default.protocolVersion.toString(),"Ably-Agent":(0,s.getAgentString)(e)}},r.arrPopRandomElement=w,r.toQueryString=function(e){var t=[];if(e)for(var r in e)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.length?"?"+t.join("&"):""},r.parseQueryString=function(e){for(var t,r=/([^?&=]+)=?([^&]*)/g,n={};t=r.exec(e);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n},r.now=Date.now||function(){return(new Date).getTime()},r.isErrorInfoOrPartialErrorInfo=function(e){return"object"==n(e)&&null!==e&&("ErrorInfo"==e.constructor.name||"PartialErrorInfo"==e.constructor.name)},r.inspectError=function(e){var t,r;return e instanceof Error||"ErrorInfo"===(null===(t=null==e?void 0:e.constructor)||void 0===t?void 0:t.name)||"PartialErrorInfo"===(null===(r=null==e?void 0:e.constructor)||void 0===r?void 0:r.name)?e.toString():a.default.Config.inspect(e)},r.inspectBody=function(e){return a.default.BufferUtils.isBuffer(e)?e.toString():"string"==typeof e?e:a.default.Config.inspect(e)},r.dataSizeBytes=function(e){if(a.default.BufferUtils.isBuffer(e))return a.default.BufferUtils.byteLength(e);if("string"==typeof e)return a.default.Config.stringByteSize(e);throw new Error("Expected input of Utils.dataSizeBytes to be a buffer or string, but was: "+n(e))},r.cheapRandStr=function(){return String(Math.random()).substr(2)},r.randomString=function(e){if(a.default.Config.getRandomValues&&"undefined"!=typeof Uint8Array){var t=new Uint8Array(e);return a.default.Config.getRandomValues(t),a.default.BufferUtils.base64Encode(t)}for(var r=a.default.BufferUtils.base64CharSet,n=Math.round(4*e/3),o="",i=0;i<n;i++)o+=r[f(r)];return o},r.randomHexString=function(e){if(a.default.Config.getRandomValues&&"undefined"!=typeof Uint8Array){var t=new Uint8Array(e);return a.default.Config.getRandomValues(t),a.default.BufferUtils.hexEncode(t)}for(var r=a.default.BufferUtils.hexCharSet,n=2*e,o="",i=0;i<n;i++)o+=r[f(r)];return o},r.arrChooseN=function(e,t){for(var r=Math.min(t,e.length),n=e.slice(),o=[],i=0;i<r;i++)o.push(w(n));return o},r.trim=String.prototype.trim?function(e){return e.trim()}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},r.promisify=function(e,t,r){return new Promise((function(n,o){e[t].apply(e,i.__spreadArray(i.__spreadArray([],r,!1),[function(e,t){e?o(e):n(t)}],!1))}))},function(e){e.msgpack="msgpack",e.json="json"}(v=r.Format||(r.Format={})),r.decodeBody=function(e,t){return"msgpack"==t?a.default.Config.msgpack.decode(e):JSON.parse(String(e))},r.encodeBody=function(e,t){return"msgpack"==t?a.default.Config.msgpack.encode(e,!0):JSON.stringify(e)},r.allToLowerCase=function(e){return e.map((function(e){return e&&e.toLowerCase()}))},r.allToUpperCase=function(e){return e.map((function(e){return e&&e.toUpperCase()}))},r.getBackoffCoefficient=_,r.getJitterCoefficient=O,r.getRetryTime=function(e,t){return e*_(t)*O()},r.getGlobalObject=function(){return t||("undefined"!=typeof window?window:self)},r.shallowEquals=function(e,t){return Object.keys(e).every((function(r){return e[r]===t[r]}))&&Object.keys(t).every((function(r){return t[r]===e[r]}))},r.matchDerivedChannel=function(e){var t=e.match(/^(\[([^?]*)(?:(.*))\])?(.+)$/);if(!t||!t.length||t.length<5)throw new c.default("regex match failed",400,40010);if(t[2])throw new c.default("cannot use a derived option with a ".concat(t[2]," channel"),400,40010);return{qualifierParam:t[3]||"",channelName:t[4]}},r.toBase64=function(t){return a.default.Config.createHmac?e.from(t,"ascii").toString("base64"):(0,u.stringify)((0,l.parse)(t))},r.arrEquals=function(e,t){return e.length===t.length&&(0,r.arrEvery)(e,(function(e,r){return e===t[r]}))}}).call(this,o(13))},function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0).__importDefault(r(3)),i=e||("undefined"!=typeof window?window:self);function a(e,t){return"".concat(e).padStart(t?3:2,"0")}function s(e){return o.default.Config.logTimestamps?function(t){var r=new Date;e(a(r.getHours())+":"+a(r.getMinutes())+":"+a(r.getSeconds())+"."+a(r.getMilliseconds(),1)+" "+t)}:e}!function(e){e[e.None=0]="None",e[e.Error=1]="Error",e[e.Major=2]="Major",e[e.Minor=3]="Minor",e[e.Micro=4]="Micro"}(n||(n={}));var c=function(){function e(){e.logLevel=e.LOG_DEFAULT}return e.initLogHandlers=function(){var e=function(){var e,t,r,n;return"undefined"==typeof Window&&"undefined"==typeof WorkerGlobalScope||"function"==typeof(null===(t=null===(e=null==i?void 0:i.console)||void 0===e?void 0:e.log)||void 0===t?void 0:t.apply)?(r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)},n=console.warn?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,e)}:r):r=n=(null==i?void 0:i.console.log)?function(){Function.prototype.apply.call(console.log,console,arguments)}:function(){},[r,n].map(s)}(),t=e[0],r=e[1];this.logHandler=t,this.logErrorHandler=r},e.logLevel=n.Error,e.LOG_NONE=n.None,e.LOG_ERROR=n.Error,e.LOG_MAJOR=n.Major,e.LOG_MINOR=n.Minor,e.LOG_MICRO=n.Micro,e.LOG_DEFAULT=n.Error,e.LOG_DEBUG=n.Micro,e.logAction=function(t,r,o){e.shouldLog(t)&&(t===n.Error?e.logErrorHandler:e.logHandler)("Ably: "+r+": "+o)},e.deprecated=function(t,r){e.deprecatedWithMsg(t,"Please use '"+r+"' instead.")},e.deprecatedWithMsg=function(t,r){e.shouldLog(n.Error)&&e.logErrorHandler("Ably: Deprecation warning - '"+t+"' is deprecated and will be removed from a future version. "+r)},e.shouldLog=function(t){return t<=e.logLevel},e.setLog=function(t,r){void 0!==t&&(e.logLevel=t),void 0!==r&&(e.logHandler=e.logErrorHandler=r)},e}();t.default=c}).call(this,r(13))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.default=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PartialErrorInfo=void 0;var n=r(0),o=n.__importDefault(r(3)),i=n.__importStar(r(1));function a(e){var t="["+e.constructor.name;return e.message&&(t+=": "+e.message),e.statusCode&&(t+="; statusCode="+e.statusCode),e.code&&(t+="; code="+e.code),e.cause&&(t+="; cause="+i.inspectError(e.cause)),!e.href||e.message&&e.message.indexOf("help.ably.io")>-1||(t+="; see "+e.href+" "),t+="]"}var s=function(e){function t(r,n,o,i){var a=e.call(this,r)||this;return void 0!==Object.setPrototypeOf&&Object.setPrototypeOf(a,t.prototype),a.code=n,a.statusCode=o,a.cause=i,a}return n.__extends(t,e),t.prototype.toString=function(){return a(this)},t.fromValues=function(e){var r=e,n=r.message,i=r.code,a=r.statusCode;if("string"!=typeof n||"number"!=typeof i||"number"!=typeof a)throw new Error("ErrorInfo.fromValues(): invalid values: "+o.default.Config.inspect(e));var s=Object.assign(new t(n,i,a),e);return s.code&&!s.href&&(s.href="https://help.ably.io/error/"+s.code),s},t}(Error);t.default=s;var c=function(e){function t(r,n,o,i){var a=e.call(this,r)||this;return void 0!==Object.setPrototypeOf&&Object.setPrototypeOf(a,t.prototype),a.code=n,a.statusCode=o,a.cause=i,a}return n.__extends(t,e),t.prototype.toString=function(){return a(this)},t}(Error);t.PartialErrorInfo=c},function(e,t,r){var n;e.exports=(n=r(6),function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var r=e.byteLength,n=[],o=0;o<r;o++)n[o>>>2]|=e[o]<<24-o%4*8;t.call(this,n,r)}else t.apply(this,arguments)}).prototype=e}}(),n.lib.WordArray)},function(e,t,r){(function(t){var n;e.exports=n=n||function(e,n){var o;if("undefined"!=typeof window&&window.crypto&&(o=window.crypto),!o&&"undefined"!=typeof window&&window.msCrypto&&(o=window.msCrypto),!o&&void 0!==t&&t.crypto&&(o=t.crypto),!o)try{o=r(44)}catch(e){}var i=function(){if(o){if("function"==typeof o.getRandomValues)try{return o.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof o.randomBytes)try{return o.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),s={},c=s.lib={},u=c.Base={extend:function(e){var t=a(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=c.WordArray=u.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||d).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(var i=0;i<o;i++){var a=r[i>>>2]>>>24-i%4*8&255;t[n+i>>>2]|=a<<24-(n+i)%4*8}else for(i=0;i<o;i+=4)t[n+i>>>2]=r[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=u.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(i());return new l.init(t,e)}}),f=s.enc={},d=f.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new l.init(r,t/2)}},h=f.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o++){var i=t[o>>>2]>>>24-o%4*8&255;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new l.init(r,t)}},p=f.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},m=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,n=this._data,o=n.words,i=n.sigBytes,a=this.blockSize,s=i/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,u=e.min(4*c,i);if(c){for(var f=0;f<c;f+=a)this._doProcessBlock(o,f);r=o.splice(0,c),n.sigBytes-=u}return new l.init(r,u)},clone:function(){var e=u.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),y=(c.Hasher=m.extend({cfg:u.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new y.HMAC.init(e,r).finalize(t)}}}),s.algo={});return s}(Math)}).call(this,r(13))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(2)),a=n.__importDefault(r(3));function s(e,t,r){try{t.apply(e,r)}catch(e){i.default.logAction(i.default.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+e+"; stack = "+(e&&e.stack))}}function c(e,t,r){for(var n,i,a,s=0;s<e.length;s++)if(n=e[s],r&&(n=n[r]),o.isArray(n)){for(;-1!==(i=o.arrIndexOf(n,t));)n.splice(i,1);r&&0===n.length&&delete e[s][r]}else if(o.isObject(n))for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&o.isArray(n[a])&&c([n],t,a)}var u=function(){function e(){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}return e.prototype.on=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(1===t.length){var n=t[0];if("function"!=typeof n)throw new Error("EventListener.on(): Invalid arguments: "+a.default.Config.inspect(t));this.any.push(n)}if(2===t.length){var i=t[0],s=t[1];if("function"!=typeof s)throw new Error("EventListener.on(): Invalid arguments: "+a.default.Config.inspect(t));if(o.isEmptyArg(i))this.any.push(s);else if(o.isArray(i))i.forEach((function(t){e.on(t,s)}));else{if("string"!=typeof i)throw new Error("EventListener.on(): Invalid arguments: "+a.default.Config.inspect(t));var c=this.events[i]||(this.events[i]=[]);c.push(s)}}},e.prototype.off=function(){for(var e,t=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(0==r.length||o.isEmptyArg(r[0])&&o.isEmptyArg(r[1]))return this.any=[],this.events=Object.create(null),this.anyOnce=[],void(this.eventsOnce=Object.create(null));var i=r[0],s=r[1],u=null,l=null;if(1!==r.length&&s){if("function"!=typeof s)throw new Error("EventEmitter.off(): invalid arguments:"+a.default.Config.inspect(r));l=(e=[i,s])[0],u=e[1]}else"function"==typeof i?u=i:l=i;if(u&&o.isEmptyArg(l))c([this.any,this.events,this.anyOnce,this.eventsOnce],u);else if(o.isArray(l))l.forEach((function(e){t.off(e,u)}));else{if("string"!=typeof l)throw new Error("EventEmitter.off(): invalid arguments:"+a.default.Config.inspect(r));u?c([this.events,this.eventsOnce],u,l):(delete this.events[l],delete this.eventsOnce[l])}},e.prototype.listeners=function(e){if(e){var t=this.events[e]||[];return this.eventsOnce[e]&&Array.prototype.push.apply(t,this.eventsOnce[e]),t.length?t:null}return this.any.length?this.any:null},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={event:e},i=[];this.anyOnce.length&&(Array.prototype.push.apply(i,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(i,this.any);var a=this.eventsOnce[e];a&&(Array.prototype.push.apply(i,a),delete this.eventsOnce[e]);var c=this.events[e];c&&Array.prototype.push.apply(i,c),o.arrForEach(i,(function(e){s(n,e,t)}))},e.prototype.once=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t.length;if((0===n||1===n&&"function"!=typeof t[0])&&a.default.Config.Promise){var i=t[0];return new a.default.Config.Promise((function(t){e.once(i,t)}))}var s=t[0],c=t[1];if(1===t.length&&"function"==typeof s)this.anyOnce.push(s);else if(o.isEmptyArg(s)){if("function"!=typeof c)throw new Error("EventEmitter.once(): Invalid arguments:"+a.default.Config.inspect(t));this.anyOnce.push(c)}else if(o.isArray(s)){var u=this,l=function e(){var r=Array.prototype.slice.call(arguments);if(o.arrForEach(s,(function(t){u.off(t,e)})),"function"!=typeof c)throw new Error("EventEmitter.once(): Invalid arguments:"+a.default.Config.inspect(t));c.apply(this,r)};o.arrForEach(s,(function(e){u.on(e,l)}))}else{if("string"!=typeof s)throw new Error("EventEmitter.once(): Invalid arguments:"+a.default.Config.inspect(t));var f=this.eventsOnce[s]||(this.eventsOnce[s]=[]);if(c){if("function"!=typeof c)throw new Error("EventEmitter.once(): Invalid arguments:"+a.default.Config.inspect(t));f.push(c)}}},e.prototype.whenState=function(t,r,n){for(var o=this,i=[],c=3;c<arguments.length;c++)i[c-3]=arguments[c];var u={event:t};if("string"!=typeof t||"string"!=typeof r)throw"whenState requires a valid event String argument";if("function"!=typeof n&&a.default.Config.Promise)return new a.default.Config.Promise((function(n){e.prototype.whenState.apply(o,[t,r,n].concat(i))}));t===r?s(u,n,i):this.once(t,n)},e}();t.default=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaults=t.normaliseOptions=t.objectifyOptions=t.getAgentString=t.getHosts=t.getFallbackHosts=t.environmentFallbackHosts=t.getHttpScheme=t.getPort=t.getHost=void 0;var o=r(0),i=o.__importDefault(r(3)),a=o.__importStar(r(1)),s=o.__importDefault(r(2)),c=o.__importDefault(r(4)),u=r(43),l="ably-js/"+u.version,f={ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["A.ably-realtime.com","B.ably-realtime.com","C.ably-realtime.com","D.ably-realtime.com","E.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,preferenceConnectTimeout:6e3,parallelUpgradeDelay:6e3},httpMaxRetryCount:3,maxMessageSize:65536,version:u.version,protocolVersion:2,agent:l,getHost:d,getPort:h,getHttpScheme:p,environmentFallbackHosts:m,getFallbackHosts:y,getHosts:g,checkHost:v,objectifyOptions:b,normaliseOptions:w};function d(e,t,r){return t=r?t==e.restHost&&e.realtimeHost||t||e.realtimeHost:t||e.restHost}function h(e,t){return t||e.tls?e.tlsPort:e.port}function p(e){return e.tls?"https://":"http://"}function m(e){return[e+"-a-fallback.ably-realtime.com",e+"-b-fallback.ably-realtime.com",e+"-c-fallback.ably-realtime.com",e+"-d-fallback.ably-realtime.com",e+"-e-fallback.ably-realtime.com"]}function y(e){var t=e.fallbackHosts,r=void 0!==e.httpMaxRetryCount?e.httpMaxRetryCount:f.httpMaxRetryCount;return t?a.arrChooseN(t,r):[]}function g(e){return[e.restHost].concat(y(e))}function v(e){if("string"!=typeof e)throw new c.default("host must be a string; was a "+n(e),4e4,400);if(!e.length)throw new c.default("host must not be zero-length",4e4,400)}function b(e){return"string"==typeof e?-1==e.indexOf(":")?{token:e}:{key:e}:e}function w(e){if(e.host&&(s.default.deprecated("host","restHost"),e.restHost=e.host),e.wsHost&&(s.default.deprecated("wsHost","realtimeHost"),e.realtimeHost=e.wsHost),e.queueEvents&&(s.default.deprecated("queueEvents","queueMessages"),e.queueMessages=e.queueEvents),e.fallbackHostsUseDefault){if(e.fallbackHosts){var t="fallbackHosts and fallbackHostsUseDefault cannot both be set";throw s.default.logAction(s.default.LOG_ERROR,"Defaults.normaliseOptions",t),new c.default(t,4e4,400)}if(e.port||e.tlsPort)throw t="fallbackHostsUseDefault cannot be set when port or tlsPort are set",s.default.logAction(s.default.LOG_ERROR,"Defaults.normaliseOptions",t),new c.default(t,4e4,400);e.environment?s.default.deprecatedWithMsg("fallbackHostsUseDefault","There is no longer a need to set this when the environment option is also set since the library will now generate the correct fallback hosts using the environment option."):s.default.deprecated("fallbackHostsUseDefault","fallbackHosts: Ably.Defaults.FALLBACK_HOSTS"),e.fallbackHosts=f.FALLBACK_HOSTS}!0===e.recover&&(s.default.deprecated("{recover: true}","{recover: function(lastConnectionDetails, cb) { cb(true); }}"),e.recover=function(e,t){t(!0)}),"function"==typeof e.recover&&!0===e.closeOnUnload&&(s.default.logAction(s.default.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),e.recover=void 0),"closeOnUnload"in e||(e.closeOnUnload=!e.recover),e.transports&&a.arrIn(e.transports,"xhr")&&(s.default.deprecated('transports: ["xhr"]','transports: ["xhr_streaming"]'),a.arrDeleteValue(e.transports,"xhr"),e.transports.push("xhr_streaming")),"queueMessages"in e||(e.queueMessages=!0);var r=e.environment&&String(e.environment).toLowerCase()||f.ENVIRONMENT,n=!r||"production"===r;e.fallbackHosts||e.restHost||e.realtimeHost||e.port||e.tlsPort||(e.fallbackHosts=n?f.FALLBACK_HOSTS:m(r));var u=e.restHost||(n?f.REST_HOST:r+"-"+f.REST_HOST),l=function(e,t,r){return e.realtimeHost?e.realtimeHost:e.restHost?(s.default.logAction(s.default.LOG_MINOR,"Defaults.normaliseOptions",'restHost is set to "'+e.restHost+'" but realtimeHost is not set, so setting realtimeHost to "'+e.restHost+'" too. If this is not what you want, please set realtimeHost explicitly.'),e.restHost):t?f.REALTIME_HOST:r+"-"+f.REALTIME_HOST}(e,n,r);a.arrForEach((e.fallbackHosts||[]).concat(u,l),v),e.port=e.port||f.PORT,e.tlsPort=e.tlsPort||f.TLS_PORT,"tls"in e||(e.tls=!0);var d=function(e){var t={};for(var r in f.TIMEOUTS)t[r]=e[r]||f.TIMEOUTS[r];return t}(e);e.useBinaryProtocol="useBinaryProtocol"in e?i.default.Config.supportsBinary&&e.useBinaryProtocol:i.default.Config.preferBinary,e.clientId&&((e.headers=e.headers||{})["X-Ably-ClientId"]=i.default.BufferUtils.base64Encode(i.default.BufferUtils.utf8Encode(e.clientId))),"idempotentRestPublishing"in e||(e.idempotentRestPublishing=!0),e.promises&&!i.default.Config.Promise&&(s.default.logAction(s.default.LOG_ERROR,"Defaults.normaliseOptions","{promises: true} was specified, but no Promise constructor found; disabling promises"),e.promises=!1);var h=null,p=e.connectivityCheckUrl;if(e.connectivityCheckUrl){var y=e.connectivityCheckUrl.split("?"),g=y[0],b=y[1];h=b?a.parseQueryString(b):{},-1===g.indexOf("://")&&(g="https://"+g),p=g}return o.__assign(o.__assign({},e),{useBinaryProtocol:"useBinaryProtocol"in e?i.default.Config.supportsBinary&&e.useBinaryProtocol:i.default.Config.preferBinary,realtimeHost:l,restHost:u,maxMessageSize:e.maxMessageSize||f.maxMessageSize,timeouts:d,connectivityCheckParams:h,connectivityCheckUrl:p})}t.getHost=d,t.getPort=h,t.getHttpScheme=p,t.environmentFallbackHosts=m,t.getFallbackHosts=y,t.getHosts=g,t.getAgentString=function(e){var t=f.agent;if(e.agents)for(var r in e.agents)t+=" "+r+"/"+e.agents[r];return t},t.objectifyOptions=b,t.normaliseOptions=w,t.default=f,t.getDefaults=function(e){return Object.assign(f,e)}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(3)),i=n.__importDefault(r(2)),a=n.__importDefault(r(4)),s=n.__importStar(r(1));function c(e){var t=0;return e.name&&(t+=e.name.length),e.clientId&&(t+=e.clientId.length),e.extras&&(t+=JSON.stringify(e.extras).length),e.data&&(t+=s.dataSizeBytes(e.data)),t}var u=function(){function e(){}return e.prototype.toJSON=function(){var e=this.encoding,t=this.data;return t&&o.default.BufferUtils.isBuffer(t)&&(arguments.length>0?(e=e?e+"/base64":"base64",t=o.default.BufferUtils.base64Encode(t)):t=o.default.BufferUtils.toBuffer(t)),{name:this.name,id:this.id,clientId:this.clientId,connectionId:this.connectionId,connectionKey:this.connectionKey,extras:this.extras,encoding:e,data:t}},e.prototype.toString=function(){var e="[Message";return this.name&&(e+="; name="+this.name),this.id&&(e+="; id="+this.id),this.timestamp&&(e+="; timestamp="+this.timestamp),this.clientId&&(e+="; clientId="+this.clientId),this.connectionId&&(e+="; connectionId="+this.connectionId),this.encoding&&(e+="; encoding="+this.encoding),this.extras&&(e+="; extras ="+JSON.stringify(this.extras)),this.data&&("string"==typeof this.data?e+="; data="+this.data:o.default.BufferUtils.isBuffer(this.data)?e+="; data (buffer)="+o.default.BufferUtils.base64Encode(this.data):e+="; data (json)="+JSON.stringify(this.data)),this.extras&&(e+="; extras="+JSON.stringify(this.extras)),e+="]"},e.encrypt=function(e,t,r){var n=e.data,i=e.encoding,a=t.channelCipher;i=i?i+"/":"",o.default.BufferUtils.isBuffer(n)||(n=o.default.BufferUtils.utf8Encode(String(n)),i+="utf-8/"),a.encrypt(n,(function(t,n){t?r(t):(e.data=n,e.encoding=i+"cipher+"+a.algorithm,r(null,e))}))},e.encode=function(t,r,n){var i=t.data;if("string"!=typeof i&&!o.default.BufferUtils.isBuffer(i)&&null!=i){if(!s.isObject(i)&&!s.isArray(i))throw new a.default("Data type is unsupported",40013,400);t.data=JSON.stringify(i),t.encoding=t.encoding?t.encoding+"/json":"json"}null!=r&&r.cipher?e.encrypt(t,r,n):n(null,t)},e.encodeArray=function(t,r,n){for(var o=0,i=0;i<t.length;i++)e.encode(t[i],r,(function(e){e?n(e):++o==t.length&&n(null,t)}))},e.decode=function(e,t){var r=function(e){return e&&e.channelOptions?e:{channelOptions:e,plugins:{},baseEncodedPreviousPayload:void 0}}(t),n=e.data,i=e.encoding;if(i){var s=i.split("/"),c=void 0,u=s.length,l=e.data,f="";try{for(;(c=u)>0;){var d=s[--u].match(/([-\w]+)(\+([\w-]+))?/);if(!d)break;switch(f=d[1]){case"base64":l=o.default.BufferUtils.base64Decode(String(l)),c==s.length&&(n=l);continue;case"utf-8":l=o.default.BufferUtils.utf8Decode(l);continue;case"json":l=JSON.parse(l);continue;case"cipher":if(null!=r.channelOptions&&r.channelOptions.cipher&&r.channelOptions.channelCipher){var h=d[3],p=r.channelOptions.channelCipher;if(h!=p.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");l=p.decrypt(l);continue}throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!r.plugins||!r.plugins.vcdiff)throw new a.default("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if("undefined"==typeof Uint8Array)throw new a.default("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{var m=r.baseEncodedPreviousPayload;"string"==typeof m&&(m=o.default.BufferUtils.utf8Encode(m)),m=o.default.BufferUtils.toBuffer(m),l=o.default.BufferUtils.toBuffer(l),n=l=o.default.BufferUtils.typedArrayToBuffer(r.plugins.vcdiff.decode(l,m))}catch(e){throw new a.default("Vcdiff delta decode failed with "+e,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(e){var y=e;throw new a.default("Error processing the "+f+" encoding, decoder returned ‘"+y.message+"’",y.code||40013,400)}finally{e.encoding=c<=0?null:s.slice(0,c).join("/"),e.data=l}}r.baseEncodedPreviousPayload=n},e.fromResponseBody=function(t,r,n){n&&(t=s.decodeBody(t,n));for(var o=0;o<t.length;o++){var a=t[o]=e.fromValues(t[o]);try{e.decode(a,r)}catch(e){i.default.logAction(i.default.LOG_ERROR,"Message.fromResponseBody()",e.toString())}}return t},e.fromValues=function(t){return Object.assign(new e,t)},e.fromValuesArray=function(t){for(var r=t.length,n=new Array(r),o=0;o<r;o++)n[o]=e.fromValues(t[o]);return n},e.fromEncoded=function(t,r){var n=e.fromValues(t),a=function(e){if(e&&e.cipher){if(!o.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var t=o.default.Crypto.getCipher(e.cipher);return{cipher:t.cipherParams,channelCipher:t.cipher}}return null!=e?e:{}}(null!=r?r:null);try{e.decode(n,a)}catch(e){i.default.logAction(i.default.LOG_ERROR,"Message.fromEncoded()",e.toString())}return n},e.fromEncodedArray=function(t,r){return t.map((function(t){return e.fromEncoded(t,r)}))},e.getMessagesSize=function(e){for(var t,r=0,n=0;n<e.length;n++)r+=(t=e[n]).size||(t.size=c(t));return r},e.serialize=s.encodeBody,e}();t.default=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(4)),a=n.__importDefault(r(9)),s=n.__importDefault(r(15)),c={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18},u=[];Object.keys(c).forEach((function(e){u[c[e]]=e}));var l={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19},f=Object.keys(l);function d(e){var t=[];if(e)for(var r=0;r<e.length;r++)t.push(e[r].toString());return"[ "+t.join(", ")+" ]"}l.MODE_ALL=l.PRESENCE|l.PUBLISH|l.SUBSCRIBE|l.PRESENCE_SUBSCRIBE;var h="id channel channelSerial connectionId count msgSerial timestamp".split(" "),p=function(){function e(){var e=this;this.hasFlag=function(t){return(e.flags&l[t])>0}}return e.prototype.setFlag=function(e){return this.flags=this.flags|l[e]},e.prototype.getMode=function(){return this.flags&&this.flags&l.MODE_ALL},e.prototype.encodeModesToFlags=function(e){var t=this;e.forEach((function(e){return t.setFlag(e)}))},e.prototype.decodeModesFromFlags=function(){var t=this,r=[];return e.channelModes.forEach((function(e){t.hasFlag(e)&&r.push(e)})),r.length>0?r:void 0},e.fromValues=function(t){return Object.assign(new e,t)},e.Action=c,e.channelModes=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE"],e.ActionName=u,e.serialize=o.encodeBody,e.deserialize=function(t,r){var n=o.decodeBody(t,r);return e.fromDeserialized(n)},e.fromDeserialized=function(t){var r=t.error;r&&(t.error=i.default.fromValues(r));var n=t.messages;if(n)for(var o=0;o<n.length;o++)n[o]=a.default.fromValues(n[o]);var c=t.presence;if(c)for(o=0;o<c.length;o++)c[o]=s.default.fromValues(c[o],!0);return Object.assign(new e,t)},e.stringify=function(t){var r,n="[ProtocolMessage";void 0!==t.action&&(n+="; action="+e.ActionName[t.action]||!1);for(var c=0;c<h.length;c++)r=h[c],void 0!==t[r]&&(n+="; "+r+"="+t[r]);if(t.messages&&(n+="; messages="+d(a.default.fromValuesArray(t.messages))),t.presence&&(n+="; presence="+d(s.default.fromValuesArray(t.presence))),t.error&&(n+="; error="+i.default.fromValues(t.error).toString()),t.auth&&t.auth.accessToken&&(n+="; token="+t.auth.accessToken),t.flags&&(n+="; flags="+f.filter(t.hasFlag).join(",")),t.params){var u="";o.forInOwnNonNullProperties(t.params,(function(e){u.length>0&&(u+="; "),u+=e+"="+t.params[e]})),u.length>0&&(n+="; params=["+u+"]")}return n+="]"},e}();t.default=p},function(e,t,r){var n,o,i;e.exports=(i=r(6),o=(n=i).lib.WordArray,n.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.clamp();for(var o=[],i=0;i<r;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<r;s++)o.push(n.charAt(a>>>6*(3-s)&63));var c=n.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var i=0;i<r.length;i++)n[r.charCodeAt(i)]=i}var a=r.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,r){for(var n=[],i=0,a=0;a<t;a++)if(a%4){var s=r[e.charCodeAt(a-1)]<<a%4*2,c=r[e.charCodeAt(a)]>>>6-a%4*2,u=s|c;n[i>>>2]|=u<<24-i%4*8,i++}return o.create(n,i)}(e,t,n)}},i.enc.Base64)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(10)),a=n.__importDefault(r(26)),s=n.__importDefault(r(2)),c=n.__importDefault(r(8)),u=n.__importDefault(r(20)),l=n.__importDefault(r(17)),f=n.__importDefault(r(4)),d=n.__importDefault(r(21)),h=n.__importDefault(r(3));function p(e){return function(e){return!!e.code&&!l.default.isTokenErr(e)&&(!!o.arrIn([80015,80017,80030],e.code)||e.code>=4e4&&e.code<5e4)}(e)?[i.default.fromValues({action:i.default.Action.ERROR,error:e})]:[i.default.fromValues({action:i.default.Action.DISCONNECTED,error:e})]}var m=function(e){function t(t,r,n){var o=e.call(this,t,r,n,!0)||this;return o.onAuthUpdated=function(e){o.authParams={access_token:e.token}},o.stream=!("stream"in n)||n.stream,o.sendRequest=null,o.recvRequest=null,o.pendingCallback=null,o.pendingItems=null,o}return n.__extends(t,e),t.prototype.connect=function(){var e=this;s.default.logAction(s.default.LOG_MINOR,"CometTransport.connect()","starting"),a.default.prototype.connect.call(this);var t=this.params,r=t.options,n=c.default.getHost(r,t.host),i=c.default.getPort(r),u=r.tls?"https://":"http://";this.baseUri=u+n+":"+i+"/comet/";var l=this.baseUri+"connect";s.default.logAction(s.default.LOG_MINOR,"CometTransport.connect()","uri: "+l),this.auth.getAuthParams((function(t,r){if(t)e.disconnect(t);else if(!e.isDisposed){e.authParams=r;var n=e.params.getConnectParams(r);"stream"in n&&(e.stream=n.stream),s.default.logAction(s.default.LOG_MINOR,"CometTransport.connect()","connectParams:"+o.toQueryString(n));var i=!1,a=e.recvRequest=e.createRequest(l,null,n,null,e.stream?d.default.REQ_RECV_STREAM:d.default.REQ_RECV);a.on("data",(function(t){e.recvRequest&&(i||(i=!0,e.emit("preconnect")),e.onData(t))})),a.on("complete",(function(t){e.recvRequest||(t=t||new f.default("Request cancelled",80003,400)),e.recvRequest=null,i||t||(i=!0,e.emit("preconnect")),e.onActivity(),t?t.code?e.onData(p(t)):e.disconnect(t):h.default.Config.nextTick((function(){e.recv()}))})),a.exec()}}))},t.prototype.requestClose=function(){s.default.logAction(s.default.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)},t.prototype.requestDisconnect=function(){s.default.logAction(s.default.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)},t.prototype._requestCloseOrDisconnect=function(e){var t=this,r=e?this.closeUri:this.disconnectUri;if(r){var n=this.createRequest(r,null,this.authParams,null,d.default.REQ_SEND);n.on("complete",(function(r){r&&(s.default.logAction(s.default.LOG_ERROR,"CometTransport.request"+(e?"Close()":"Disconnect()"),"request returned err = "+o.inspectError(r)),t.finish("disconnected",r))})),n.exec()}},t.prototype.dispose=function(){var e=this;s.default.logAction(s.default.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(s.default.logAction(s.default.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",u.default.disconnected()),h.default.Config.nextTick((function(){e.emit("disposed")})))},t.prototype.onConnect=function(e){var t;if(!this.isDisposed){var r=null===(t=e.connectionDetails)||void 0===t?void 0:t.connectionKey;a.default.prototype.onConnect.call(this,e);var n=this.baseUri+r;s.default.logAction(s.default.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+n),this.sendUri=n+"/send",this.recvUri=n+"/recv",this.closeUri=n+"/close",this.disconnectUri=n+"/disconnect"}},t.prototype.send=function(e){if(this.sendRequest)return this.pendingItems=this.pendingItems||[],void this.pendingItems.push(e);var t=this.pendingItems||[];t.push(e),this.pendingItems=null,this.sendItems(t)},t.prototype.sendAnyPending=function(){var e=this.pendingItems;e&&(this.pendingItems=null,this.sendItems(e))},t.prototype.sendItems=function(e){var t=this,r=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(e),d.default.REQ_SEND);r.on("complete",(function(e,r){e&&s.default.logAction(s.default.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+o.inspectError(e)),t.sendRequest=null,e?e.code?t.onData(p(e)):t.disconnect(e):(r&&t.onData(r),t.pendingItems&&h.default.Config.nextTick((function(){t.sendRequest||t.sendAnyPending()})))})),r.exec()},t.prototype.recv=function(){var e=this;if(!this.recvRequest&&this.isConnected){var t=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?d.default.REQ_RECV_STREAM:d.default.REQ_RECV_POLL);t.on("data",(function(t){e.onData(t)})),t.on("complete",(function(t){e.recvRequest=null,e.onActivity(),t?t.code?e.onData(p(t)):e.disconnect(t):h.default.Config.nextTick((function(){e.recv()}))})),t.exec()}},t.prototype.onData=function(e){try{var t=this.decodeResponse(e);if(t&&t.length)for(var r=0;r<t.length;r++)this.onProtocolMessage(i.default.fromDeserialized(t[r]))}catch(e){s.default.logAction(s.default.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+e.stack)}},t.prototype.encodeRequest=function(e){return JSON.stringify(e)},t.prototype.decodeResponse=function(e){return"string"==typeof e?JSON.parse(e):e},t}(a.default);t.default=m},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(3)),i=n.__importStar(r(1)),a=n.__importDefault(r(2)),s=n.__importDefault(r(17)),c=n.__importDefault(r(18)),u=r(4);function l(e,t,r,n,o){e.http.supportsAuthHeaders?e.auth.getAuthHeaders((function(e,a){e?n(e):o(i.mixin(a,t),r)})):e.auth.getAuthParams((function(e,a){e?n(e):o(t,i.mixin(a,r))}))}function f(e){var t=[];if(e)for(var r in e)t.push(r+"="+e[r]);return t.join("&")}function d(e,t){return e+(t?"?":"")+f(t)}var h=function(){function e(){}return e.get=function(t,r,n,o,i,a){e.do(c.default.Get,t,r,null,n,o,i,a)},e.delete=function(t,r,n,o,i,a){e.do(c.default.Delete,t,r,null,n,o,i,a)},e.post=function(t,r,n,o,i,a,s){e.do(c.default.Post,t,r,n,o,i,a,s)},e.patch=function(t,r,n,o,i,a,s){e.do(c.default.Patch,t,r,n,o,i,a,s)},e.put=function(t,r,n,o,i,a,s){e.do(c.default.Put,t,r,n,o,i,a,s)},e.do=function(e,t,r,n,c,h,p,m){a.default.shouldLog(a.default.LOG_MICRO)&&(m=function(e,t,r,n){return function(s,c,u,l,h){s?a.default.logAction(a.default.LOG_MICRO,"Resource."+t+"()","Received Error; "+d(r,n)+"; Error: "+i.inspectError(s)):a.default.logAction(a.default.LOG_MICRO,"Resource."+t+"()","Received; "+d(r,n)+"; Headers: "+f(u)+"; StatusCode: "+h+"; Body: "+(o.default.BufferUtils.isBuffer(c)?c.toString():c)),e&&e(s,c,u,l,h)}}(m,e,r,h)),p&&(m=m&&function(e,t){return function(r,n,o,a,s){if(!r||n){if(!a)try{n=i.decodeBody(n,t)}catch(t){return void(i.isErrorInfoOrPartialErrorInfo(t)?e(t):e(new u.PartialErrorInfo(i.inspectError(t),null)))}if(n){var c=n,l=c.statusCode,f=c.response,d=c.headers;if(void 0!==l){if(l<200||l>=300){var h=f&&f.error||r;return h||((h=new Error("Error in unenveloping "+n)).statusCode=l),void e(h,f,d,!0,l)}e(r,f,d,!0,l)}else e(r,n,o,!0,s)}else e(new u.PartialErrorInfo("unenvelope(): Response body is missing",null))}else e(r)}}(m,p),(h=h||{}).envelope=p),l(t,c,h,m,(function c(u,f){var h;if(a.default.shouldLog(a.default.LOG_MICRO)&&a.default.logAction(a.default.LOG_MICRO,"Resource."+e+"()","Sending; "+d(r,f)),a.default.shouldLog(a.default.LOG_MICRO)){var p=n;if((null===(h=u["content-type"])||void 0===h?void 0:h.indexOf("msgpack"))>0)try{p=o.default.Config.msgpack.decode(n)}catch(t){a.default.logAction(a.default.LOG_MICRO,"Resource."+e+"()","Sending MsgPack Decoding Error: "+i.inspectError(t))}a.default.logAction(a.default.LOG_MICRO,"Resource."+e+"()","Sending; "+d(r,f)+"; Body: "+p)}t.http.do(e,t,r,u,n,f,(function(e,r,n,o,i){e&&s.default.isTokenErr(e)?t.auth.authorize(null,null,(function(e){e?m(e):l(t,n,f,m,c)})):m(e,r,n,o,i)}))}))},e}();t.default=h},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(2)),i=n.__importDefault(r(3)),a=n.__importDefault(r(9)),s=n.__importStar(r(1));function c(e){return u.Actions.indexOf(e)}var u=function(){function e(){}return e.prototype.isSynthesized=function(){return!this.id||!this.connectionId||this.id.substring(this.connectionId.length,0)!==this.connectionId},e.prototype.parseId=function(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");var e=this.id.split(":");return{connectionId:e[0],msgSerial:parseInt(e[1],10),index:parseInt(e[2],10)}},e.prototype.toJSON=function(){var e=this.data,t=this.encoding;return e&&i.default.BufferUtils.isBuffer(e)&&(arguments.length>0?(t=t?t+"/base64":"base64",e=i.default.BufferUtils.base64Encode(e)):e=i.default.BufferUtils.toBuffer(e)),{id:this.id,clientId:this.clientId,action:c(this.action),data:e,encoding:t,extras:this.extras}},e.prototype.toString=function(){var e="[PresenceMessage";return e+="; action="+this.action,this.id&&(e+="; id="+this.id),this.timestamp&&(e+="; timestamp="+this.timestamp),this.clientId&&(e+="; clientId="+this.clientId),this.connectionId&&(e+="; connectionId="+this.connectionId),this.encoding&&(e+="; encoding="+this.encoding),this.data&&("string"==typeof this.data?e+="; data="+this.data:i.default.BufferUtils.isBuffer(this.data)?e+="; data (buffer)="+i.default.BufferUtils.base64Encode(this.data):e+="; data (json)="+JSON.stringify(this.data)),this.extras&&(e+="; extras="+JSON.stringify(this.extras)),e+="]"},e.fromResponseBody=function(t,r,n){var i=[];n&&(t=s.decodeBody(t,n));for(var a=0;a<t.length;a++){var c=i[a]=e.fromValues(t[a],!0);try{e.decode(c,r)}catch(e){o.default.logAction(o.default.LOG_ERROR,"PresenceMessage.fromResponseBody()",e.toString())}}return i},e.fromValues=function(t,r){return r&&(t.action=e.Actions[t.action]),Object.assign(new e,t)},e.fromValuesArray=function(t){for(var r=t.length,n=new Array(r),o=0;o<r;o++)n[o]=e.fromValues(t[o]);return n},e.fromEncoded=function(t,r){var n=e.fromValues(t,!0);try{e.decode(n,null!=r?r:{})}catch(e){o.default.logAction(o.default.LOG_ERROR,"PresenceMessage.fromEncoded()",e.toString())}return n},e.fromEncodedArray=function(t,r){return t.map((function(t){return e.fromEncoded(t,r)}))},e.fromData=function(t){return t instanceof e?t:e.fromValues({data:t})},e.Actions=["absent","present","enter","leave","update"],e.encode=a.default.encode,e.decode=a.default.decode,e.getMessagesSize=a.default.getMessagesSize,e}();t.default=u},function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(7)),a=n.__importStar(r(4)),s=n.__importDefault(r(2)),c=n.__importDefault(r(8)),u=n.__importDefault(r(21)),l=n.__importDefault(r(3));function f(e,t){if(function(e,t){return o.arrIn(o.allToLowerCase(o.keysArray(t)),"x-ably-errorcode")}(0,t))return e.error&&a.default.fromValues(e.error)}var d=function(){},h=0,p={},m=void 0!==e&&e.XDomainRequest;function y(){var e,t;return m&&(e=(t=navigator.userAgent.toString().match(/MSIE\s([\d.]+)/))&&Number(t[1]))&&10===e}var g=function(e){function t(t,r,n,i,a,s,c){var u=e.call(this)||this;return(n=n||{}).rnd=o.cheapRandStr(),y()&&!n.envelope&&(n.envelope="json"),u.uri=t+o.toQueryString(n),u.headers=r||{},u.body=i,u.method=c?c.toUpperCase():o.isEmptyArg(i)?"GET":"POST",u.requestMode=a,u.timeouts=s,u.timedOut=!1,u.requestComplete=!1,u.id=String(++h),p[u.id]=u,u}return n.__extends(t,e),t.createRequest=function(e,r,n,i,a,s,u){var l=s||c.default.TIMEOUTS;return new t(e,r,o.copy(n),i,a,l,u)},t.prototype.complete=function(e,t,r,n,o){this.requestComplete||(this.requestComplete=!0,!e&&t&&this.emit("data",t),this.emit("complete",e,t,r,n,o),this.dispose())},t.prototype.abort=function(){this.dispose()},t.prototype.exec=function(){var e=this,t=this.headers,r=this.requestMode==u.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,n=this.timer=setTimeout((function(){e.timedOut=!0,c.abort()}),r),i=this.method,c=this.xhr=new XMLHttpRequest,d=t.accept,h=this.body,p="text";for(var m in d?0===d.indexOf("application/x-msgpack")&&(p="arraybuffer"):t.accept="application/json",h&&(t["content-type"]||(t["content-type"]="application/json")).indexOf("application/json")>-1&&"string"!=typeof h&&(h=JSON.stringify(h)),c.open(i,this.uri,!0),c.responseType=p,"authorization"in t&&(c.withCredentials=!0),t)c.setRequestHeader(m,t[m]);var y,g,v,b=function(t,r,n,o){var i,c=r+" (event type: "+t.type+")";(null===(i=null==e?void 0:e.xhr)||void 0===i?void 0:i.statusText)&&(c+=", current statusText is "+e.xhr.statusText),s.default.logAction(s.default.LOG_ERROR,"Request.on"+t.type+"()",c),e.complete(new a.PartialErrorInfo(c,n,o))};c.onerror=function(e){b(e,"XHR error occurred",null,400)},c.onabort=function(t){e.timedOut?b(t,"Request aborted due to request timeout expiring",null,408):b(t,"Request cancelled",null,400)},c.ontimeout=function(e){b(e,"Request timed out",null,408)};var w=0,_=!1,O=function(){var r;try{var n=function(e,t){return e.getResponseHeader&&e.getResponseHeader(t)}(c,"content-type");if(n?n.indexOf("application/json")>=0:"text"==c.responseType){var i="arraybuffer"===c.responseType?l.default.BufferUtils.utf8Decode(c.response):String(c.responseText);r=i.length?JSON.parse(i):i,_=!0}else r=c.response;void 0!==r.response?(g=r.statusCode,v=g<400,t=r.headers,r=r.response):t=function(e){for(var t=o.trim(e.getAllResponseHeaders()).split("\r\n"),r={},n=0;n<t.length;n++){var i=t[n].split(":").map(o.trim);r[i[0].toLowerCase()]=i[1]}return r}(c)}catch(t){return void e.complete(new a.PartialErrorInfo("Malformed response body from server: "+t.message,null,400))}if(v||o.isArray(r))e.complete(null,r,t,_,g);else{var s=f(r,t);s||(s=new a.PartialErrorInfo("Error response received from server: "+g+" body was: "+l.default.Config.inspect(r),null,g)),e.complete(s,r,t,_,g)}};function S(){for(var e,t,r=c.responseText,n=r.length-1;w<n&&(e=r.indexOf("\n",w))>-1;)t=r.slice(w,e),w=e+1,E(t)}var E=function(t){try{t=JSON.parse(t)}catch(t){return void e.complete(new a.PartialErrorInfo("Malformed response body from server: "+t.message,null,400))}e.emit("data",t)};c.onreadystatechange=function(){var t=c.readyState;t<3||0!==c.status&&(void 0===g&&(1223===(g=c.status)&&(g=204),clearTimeout(n),v=g<400,204!=g?y=e.requestMode==u.default.REQ_RECV_STREAM&&v&&function(e){return e.getResponseHeader&&(e.getResponseHeader("transfer-encoding")||!e.getResponseHeader("content-length"))}(c):e.complete(null,null,null,null,g)),3==t&&y?S():4==t&&(y?(S(),e.streamComplete=!0,l.default.Config.nextTick((function(){e.complete()}))):O()))},c.send(h)},t.prototype.dispose=function(){var e=this.xhr;if(e){e.onreadystatechange=e.onerror=e.onabort=e.ontimeout=d,this.xhr=null;var t=this.timer;t&&(clearTimeout(t),this.timer=null),this.requestComplete||e.abort()}delete p[this.id]},t}(i.default);t.default=g}).call(this,r(13))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=o.__importDefault(r(2)),a=o.__importStar(r(1)),s=o.__importDefault(r(23)),c=o.__importDefault(r(4)),u=o.__importDefault(r(45)),l=r(11),f=o.__importDefault(r(18)),d=o.__importDefault(r(25)),h=o.__importDefault(r(3)),p=o.__importDefault(r(14)),m=Math.pow(2,17);function y(){}function g(){return("000000"+Math.floor(1e16*Math.random())).slice(-16)}function v(e){return!!e.connection}function b(e){return a.isErrorInfoOrPartialErrorInfo(e)?(e.code||(403===e.statusCode?e.code=40300:(e.code=40170,e.statusCode=401)),e):new c.default(a.inspectError(e),e.code||40170,e.statusCode||401)}var w=function(e,t){if(h.default.Config.createHmac){var r=h.default.Config.createHmac("SHA256",t);return r.update(e),r.digest("base64")}return(0,l.stringify)((0,u.default)(e,t))};function _(e){if(!e)return"";"string"==typeof e&&(e=JSON.parse(e));var t=Object.create(null),r=a.keysArray(e,!0);if(!r)return"";r.sort();for(var n=0;n<r.length;n++)t[r[n]]=e[r[n]].sort();return JSON.stringify(t)}function O(e){if(e.authCallback)i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with authCallback");else if(e.authUrl)i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with authUrl");else if(e.key)i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with client-side signing");else{if(!e.tokenDetails){var t="authOptions must include valid authentication parameters";throw i.default.logAction(i.default.LOG_ERROR,"Auth()",t),new Error(t)}i.default.logAction(i.default.LOG_MINOR,"Auth()","using token auth with supplied token only")}}function S(e){return e.useTokenAuth||!function(e){return"useTokenAuth"in e&&!e.useTokenAuth}(e)&&(e.authCallback||e.authUrl||e.token||e.tokenDetails)}var E=0,k=function(){function e(e,t){if(this.authOptions={},this.client=e,this.tokenParams=t.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,S(t)){if(t.key&&!w){var r="client-side token request signing not supported";throw i.default.logAction(i.default.LOG_ERROR,"Auth()",r),new Error(r)}(function(e){return!e.key&&!e.authCallback&&!e.authUrl})(t)&&i.default.logAction(i.default.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(t.defaultTokenParams,t),O(this.authOptions)}else{if(!t.key)throw r="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)",i.default.logAction(i.default.LOG_ERROR,"Auth()",r),new c.default(r,40160,401);i.default.logAction(i.default.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(t)}}return e.prototype.authorize=function(e,t,r){var n,o=this;if("function"!=typeof e||r?"function"!=typeof t||r?n=t:(r=t,n=null):(r=e,n=e=null),!r&&this.client.options.promises)return a.promisify(this,"authorize",arguments);if(n&&n.key&&this.authOptions.key!==n.key)throw new c.default("Unable to update auth options with incompatible key",40102,401);n&&"force"in n&&(i.default.logAction(i.default.LOG_ERROR,"Auth.authorize","Deprecation warning: specifying {force: true} in authOptions is no longer necessary, authorize() now always gets a new token. Please remove this, as in version 1.0 and later, having a non-null authOptions will overwrite stored library authOptions, which may not be what you want"),a.isOnlyPropIn(n,"force")&&(n=null)),this._forceNewToken(e,n,(function(e,t){if(e)return o.client.connection&&e.statusCode===d.default.Forbidden&&o.client.connection.connectionManager.actOnErrorFromAuthorize(e),void(null==r||r(e));v(o.client)?o.client.connection.connectionManager.onAuthUpdated(t,r||y):null==r||r(null,t)}))},e.prototype.authorise=function(e,t,r){i.default.deprecated("Auth.authorise","Auth.authorize"),this.authorize(e,t,r)},e.prototype._forceNewToken=function(e,t,r){var n=this;this.tokenDetails=null,this._saveTokenOptions(e,t),O(this.authOptions),this._ensureValidAuthCredentials(!0,(function(e,t){delete n.tokenParams.timestamp,delete n.authOptions.queryTime,r(e,t)}))},e.prototype.requestToken=function(e,t,r){var o=this;if("function"!=typeof e||r?"function"!=typeof t||r||(r=t,t=null):(r=e,t=e=null),!r&&this.client.options.promises)return a.promisify(this,"requestToken",arguments);t=t||this.authOptions,e=e||a.copy(this.tokenParams);var s,u=r||y,l=this.client;if(t.authCallback)i.default.logAction(i.default.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),s=t.authCallback;else if(t.authUrl)i.default.logAction(i.default.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),s=function(e,r){var n,s=a.mixin({accept:"application/json, text/plain"},t.authHeaders),u=t.authMethod&&"post"===t.authMethod.toLowerCase(),d=t.authUrl.indexOf("?");d>-1&&(n=a.parseQueryString(t.authUrl.slice(d)),t.authUrl=t.authUrl.slice(0,d),u||(t.authParams=a.mixin(n,t.authParams)));var p=a.mixin({},t.authParams||{},e),y=function(e,t,n,o){var s;if(e?i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+a.inspectError(e)):(s=n["content-type"],i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+s+"; body: "+a.inspectBody(t))),e||o)return r(e,t);if(h.default.BufferUtils.isBuffer(t)&&(t=t.toString()),s){var u=s.indexOf("application/json")>-1,l=s.indexOf("text/plain")>-1||s.indexOf("application/jwt")>-1;if(u||l){if(u){if(t.length>m)return void r(new c.default("authUrl response exceeded max permitted length",40170,401));try{t=JSON.parse(t)}catch(e){return void r(new c.default("Unexpected error processing authURL response; err = "+e.message,40170,401))}}r(null,t,s)}else r(new c.default("authUrl responded with unacceptable content-type "+s+", should be either text/plain, application/jwt or application/json",40170,401))}else r(new c.default("authUrl response is missing a content-type header",40170,401))};if(i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+t.authUrl+"; Params: "+JSON.stringify(p)+"; method: "+(u?"POST":"GET")),u){var g=s||{};g["content-type"]="application/x-www-form-urlencoded";var v=a.toQueryString(p).slice(1);o.client.http.doUri(f.default.Post,l,t.authUrl,g,v,n,y)}else o.client.http.doUri(f.default.Get,l,t.authUrl,s||{},null,p,y)};else{if(!t.key){var d="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";return i.default.logAction(i.default.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),void u(new c.default(d,40171,403))}i.default.logAction(i.default.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),s=function(e,r){o.createTokenRequest(e,t,r)}}"capability"in e&&(e.capability=_(e.capability));var p=function(e,r){var n="/keys/"+e.keyName+"/requestToken",s=a.defaultPostHeaders(o.client.options);t.requestHeaders&&a.mixin(s,t.requestHeaders),i.default.logAction(i.default.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+n+"; Token params: "+JSON.stringify(e)),o.client.http.do(f.default.Post,l,(function(e){return l.baseUri(e)+n}),s,JSON.stringify(e),null,r)},g=!1,v=this.client.options.timeouts.realtimeRequestTimeout,w=setTimeout((function(){g=!0;var e="Token request callback timed out after "+v/1e3+" seconds";i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()",e),u(new c.default(e,40170,401))}),v);s(e,(function(e,r,o){if(!g){if(clearTimeout(w),e)return i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+a.inspectError(e)),void u(b(e));if("string"!=typeof r){if("object"!==n(r)){var s="Expected token request callback to call back with a token string or token request/details object, but got a "+n(r);return i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()",s),void u(new c.default(s,40170,401))}var l=JSON.stringify(r).length;if(l>m&&!t.suppressMaxLengthCheck)u(new c.default("Token request/details object exceeded max permitted stringified size (was "+l+" bytes)",40170,401));else if("issued"in r)u(null,r);else{if(!("keyName"in r))return s="Expected token request callback to call back with a token string, token request object, or token details object",i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()",s),void u(new c.default(s,40170,401));p(r,(function(e,t,r,n){if(e)return i.default.logAction(i.default.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+a.inspectError(e)),void u(b(e));n||(t=JSON.parse(t)),i.default.logAction(i.default.LOG_MINOR,"Auth.getToken()","token received"),u(null,t)}))}}else 0===r.length?u(new c.default("Token string is empty",40170,401)):r.length>m?u(new c.default("Token string exceeded max permitted length (was "+r.length+" bytes)",40170,401)):"undefined"===r||"null"===r?u(new c.default("Token string was literal null/undefined",40170,401)):"{"!==r[0]||o&&o.indexOf("application/jwt")>-1?u(null,{token:r}):u(new c.default("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401))}}))},e.prototype.createTokenRequest=function(e,t,r){var n=this;if("function"!=typeof e||r?"function"!=typeof t||r||(r=t,t=null):(r=e,t=e=null),!r&&this.client.options.promises)return a.promisify(this,"createTokenRequest",arguments);t=t||this.authOptions,e=e||a.copy(this.tokenParams);var o=t.key;if(o){var s=o.split(":"),u=s[0],l=s[1];if(l)if(""!==e.clientId){"capability"in e&&(e.capability=_(e.capability));var f,d=a.mixin({keyName:u},e),h=e.clientId||"",p=e.ttl||"",m=e.capability||"";f=function(){var e=d.nonce||(d.nonce=g()),t=d.timestamp,n=d.keyName+"\n"+p+"\n"+m+"\n"+h+"\n"+t+"\n"+e+"\n";d.mac=d.mac||w(n,l),i.default.logAction(i.default.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),r(null,d)},d.timestamp?f():n.getTimestamp(t&&t.queryTime,(function(e,t){e?r(e):(d.timestamp=t,f())}))}else r(new c.default("clientId can’t be an empty string",40012,400));else r(new c.default("Invalid key specified",40101,403))}else r(new c.default("No key specified",40101,403))},e.prototype.getAuthParams=function(e){"basic"==this.method?e(null,{key:this.key}):this._ensureValidAuthCredentials(!1,(function(t,r){if(t)e(t);else{if(!r)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");e(null,{access_token:r.token})}}))},e.prototype.getAuthHeaders=function(e){"basic"==this.method?e(null,{authorization:"Basic "+this.basicKey}):this._ensureValidAuthCredentials(!1,(function(t,r){if(t)e(t);else{if(!r)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");e(null,{authorization:"Bearer "+a.toBase64(r.token)})}}))},e.prototype.getTimestamp=function(e,t){this.isTimeOffsetSet()||!e&&!this.authOptions.queryTime?t(null,this.getTimestampUsingOffset()):this.client.time(t)},e.prototype.getTimestampUsingOffset=function(){return a.now()+(this.client.serverTimeOffset||0)},e.prototype.isTimeOffsetSet=function(){return null!==this.client.serverTimeOffset},e.prototype._saveBasicOptions=function(e){this.method="basic",this.key=e.key,this.basicKey=a.toBase64(e.key),this.authOptions=e||{},"clientId"in e&&this._userSetClientId(e.clientId)},e.prototype._saveTokenOptions=function(e,t){this.method="token",e&&(this.tokenParams=e),t&&(t.token&&(t.tokenDetails="string"==typeof t.token?{token:t.token}:t.token),t.tokenDetails&&(this.tokenDetails=t.tokenDetails),"clientId"in t&&this._userSetClientId(t.clientId),this.authOptions=t)},e.prototype._ensureValidAuthCredentials=function(e,t){var r=this,n=this.tokenDetails;if(n){if(this._tokenClientIdMismatch(n.clientId))return void t(new c.default("Mismatch between clientId in token ("+n.clientId+") and current clientId ("+this.clientId+")",40102,403));if(!this.isTimeOffsetSet()||!n.expires||n.expires>=this.getTimestampUsingOffset())return i.default.logAction(i.default.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+n.expires),void t(null,n);i.default.logAction(i.default.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}if((this.waitingForTokenRequest||(this.waitingForTokenRequest=s.default.create())).push(t),null===this.currentTokenRequestId||e){var o=this.currentTokenRequestId=E++;this.requestToken(this.tokenParams,this.authOptions,(function(e,t){if(r.currentTokenRequestId>o)i.default.logAction(i.default.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one");else{r.currentTokenRequestId=null;var n=r.waitingForTokenRequest||y;r.waitingForTokenRequest=null,e?n(e):n(null,r.tokenDetails=t)}}))}},e.prototype._userSetClientId=function(e){if("string"!=typeof e&&null!==e)throw new c.default("clientId must be either a string or null",40012,400);if("*"===e)throw new c.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);var t=this._uncheckedSetClientId(e);if(t)throw t},e.prototype._uncheckedSetClientId=function(e){if(this._tokenClientIdMismatch(e)){var t="Unexpected clientId mismatch: client has "+this.clientId+", requested "+e,r=new c.default(t,40102,401);return i.default.logAction(i.default.LOG_ERROR,"Auth._uncheckedSetClientId()",t),r}return this.clientId=this.tokenParams.clientId=e,null},e.prototype._tokenClientIdMismatch=function(e){return!(!this.clientId||"*"===this.clientId||!e||"*"===e||this.clientId===e)},e.isTokenErr=function(e){return e.code&&e.code>=40140&&e.code<40150},e.prototype.revokeTokens=function(e,t,r){if(S(this.client.options))throw new c.default("Cannot revoke tokens when using token auth",40162,401);var n,i=this.client.options.keyName;if("function"==typeof t?(r=t,n={}):n=null!=t?t:{},void 0===r){if(this.client.options.promises)return a.promisify(this,"revokeTokens",[e,n]);r=y}var s=r,u=o.__assign({targets:e.map((function(e){return"".concat(e.type,":").concat(e.value)}))},n),l=this.client.options.useBinaryProtocol?a.Format.msgpack:a.Format.json,f=a.defaultPostHeaders(this.client.options,l);this.client.options.headers&&a.mixin(f,this.client.options.headers);var d=a.encodeBody(u,l);p.default.post(this.client,"/keys/".concat(i,"/revokeTokens"),d,f,{newBatchResponse:"true"},null,(function(e,t,r,n){if(e)s(e);else{var o=n?t:a.decodeBody(t,l);s(null,o)}}))},e}();t.default=k},function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Get="get",e.Delete="delete",e.Post="post",e.Put="put",e.Patch="patch"}(n||(n={})),t.default=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.HttpPaginatedResponse=t.PaginatedResult=void 0;var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(2)),a=n.__importDefault(r(14)),s=function(){function e(e,t,r,n,o,i){this.rest=e,this.path=t,this.headers=r,this.envelope=null!=n?n:null,this.bodyHandler=o,this.useHttpPaginatedResponse=i||!1}return e.prototype.get=function(e,t){var r=this;a.default.get(this.rest,this.path,this.headers,e,this.envelope,(function(e,n,o,i,a){r.handlePage(e,n,o,i,a,t)}))},e.prototype.delete=function(e,t){var r=this;a.default.delete(this.rest,this.path,this.headers,e,this.envelope,(function(e,n,o,i,a){r.handlePage(e,n,o,i,a,t)}))},e.prototype.post=function(e,t,r){var n=this;a.default.post(this.rest,this.path,t,this.headers,e,this.envelope,(function(e,t,o,i,a){r&&n.handlePage(e,t,o,i,a,r)}))},e.prototype.put=function(e,t,r){var n=this;a.default.put(this.rest,this.path,t,this.headers,e,this.envelope,(function(e,t,o,i,a){r&&n.handlePage(e,t,o,i,a,r)}))},e.prototype.patch=function(e,t,r){var n=this;a.default.patch(this.rest,this.path,t,this.headers,e,this.envelope,(function(e,t,o,i,a){r&&n.handlePage(e,t,o,i,a,r)}))},e.prototype.handlePage=function(e,t,r,n,a,s){if(e&&function(e,t,r){return!(r&&(t||"number"==typeof e.code))}(e,t,this.useHttpPaginatedResponse))return i.default.logAction(i.default.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+o.inspectError(e)),void(null==s||s(e));var l,f,d;try{l=this.bodyHandler(t,r||{},n)}catch(t){return void(null==s||s(e||t))}r&&(f=r.Link||r.link)&&(d=function(e){"string"==typeof e&&(e=e.split(","));for(var t,r,n={},i=0;i<e.length;i++){var a=e[i].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(a){var s=(t=a[1],r=void 0,(r=t.match(/^\.\/(\w+)\?(.*)$/))&&r[2]&&o.parseQueryString(r[2]));s&&(n[a[2]]=s)}}return n}(f)),this.useHttpPaginatedResponse?s(null,new u(this,l,r||{},a,d,e)):s(null,new c(this,l,d))},e}(),c=function(){function e(e,t,r){var n=this;this.resource=e,this.items=t;var i=this;r&&("first"in r&&(this.first=function(e){if(!e&&i.resource.rest.options.promises)return o.promisify(i,"first",[]);i.get(r.first,e)}),"current"in r&&(this.current=function(e){if(!e&&i.resource.rest.options.promises)return o.promisify(i,"current",[]);i.get(r.current,e)}),this.next=function(e){if(!e&&i.resource.rest.options.promises)return o.promisify(i,"next",[]);"next"in r?i.get(r.next,e):e(null)},this.hasNext=function(){return"next"in r},this.isLast=function(){var e;return!(null===(e=n.hasNext)||void 0===e?void 0:e.call(n))})}return e.prototype.get=function(e,t){var r=this.resource;a.default.get(r.rest,r.path,r.headers,e,r.envelope,(function(e,n,o,i,a){r.handlePage(e,n,o,i,a,t)}))},e}();t.PaginatedResult=c;var u=function(e){function t(t,r,n,o,i,a){var s=e.call(this,t,r,i)||this;return s.statusCode=o,s.success=o<300&&o>=200,s.headers=n,s.errorCode=a&&a.code,s.errorMessage=a&&a.message,s}return n.__extends(t,e),t.prototype.toJSON=function(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}},t}(c);t.HttpPaginatedResponse=u,t.default=s},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.isRetriable=void 0;var n=r(0).__importDefault(r(4)),o={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},i={disconnected:function(){return n.default.fromValues({statusCode:400,code:o.DISCONNECTED,message:"Connection to server temporarily unavailable"})},suspended:function(){return n.default.fromValues({statusCode:400,code:o.SUSPENDED,message:"Connection to server unavailable"})},failed:function(){return n.default.fromValues({statusCode:400,code:o.FAILED,message:"Connection failed or disconnected by server"})},closing:function(){return n.default.fromValues({statusCode:400,code:o.CLOSING,message:"Connection closing"})},closed:function(){return n.default.fromValues({statusCode:400,code:o.CLOSED,message:"Connection closed"})},unknownConnectionErr:function(){return n.default.fromValues({statusCode:500,code:o.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"})},unknownChannelErr:function(){return n.default.fromValues({statusCode:500,code:o.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})}};t.isRetriable=function(e){return!e.statusCode||!e.code||e.statusCode>=500||Object.values(o).includes(e.code)},t.default=i},function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.REQ_SEND=0]="REQ_SEND",e[e.REQ_RECV=1]="REQ_RECV",e[e.REQ_RECV_POLL=2]="REQ_RECV_POLL",e[e.REQ_RECV_STREAM=3]="REQ_RECV_STREAM"}(n||(n={})),t.default=n},function(e,t,r){var n;e.exports=(n=r(6),r(5),r(58),r(11),r(40),r(32),r(24),r(27),r(28),r(59),r(60),n)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0).__importDefault(r(2)),o=function(){function e(e){this.members=e||[]}return e.prototype.call=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,o=this.members;r<o.length;r++){var i=o[r];if(i)try{i.apply(void 0,e)}catch(e){n.default.logAction(n.default.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+e+"; stack = "+e.stack)}}},e.prototype.push=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.members).push.apply(e,t)},e.create=function(t){var r=new e(t);return Object.assign((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.call.apply(r,e)}),{push:function(e){return r.push(e)}})},e}();t.default=o},function(e,t,r){var n,o,i,a;e.exports=(n=r(6),i=(o=n).lib.Base,a=o.enc.Utf8,void(o.algo.HMAC=i.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,c=i.words,u=0;u<r;u++)s[u]^=1549556828,c[u]^=909522486;o.sigBytes=i.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})))},function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isSuccessCode=void 0,function(e){e[e.Success=200]="Success",e[e.NoContent=204]="NoContent",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.RequestTimeout=408]="RequestTimeout",e[e.InternalServerError=500]="InternalServerError"}(n||(n={})),t.isSuccessCode=function(e){return e>=n.Success&&e<n.BadRequest},t.default=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(10)),i=n.__importStar(r(1)),a=n.__importDefault(r(7)),s=n.__importDefault(r(2)),c=n.__importDefault(r(20)),u=n.__importDefault(r(4)),l=n.__importDefault(r(3)),f=o.default.Action,d=o.default.fromValues({action:f.CLOSE}),h=o.default.fromValues({action:f.DISCONNECT}),p=function(e){function t(t,r,n,o){var i=e.call(this)||this;return o&&(n.format=void 0,n.heartbeats=!0),i.connectionManager=t,t.registerProposedTransport(i),i.auth=r,i.params=n,i.timeouts=n.options.timeouts,i.format=n.format,i.isConnected=!1,i.isFinished=!1,i.isDisposed=!1,i.maxIdleInterval=null,i.idleTimer=null,i.lastActivity=null,i}return n.__extends(t,e),t.prototype.connect=function(){},t.prototype.close=function(){this.isConnected&&this.requestClose(),this.finish("closed",c.default.closed())},t.prototype.disconnect=function(e){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",e||c.default.disconnected())},t.prototype.fail=function(e){this.isConnected&&this.requestDisconnect(),this.finish("failed",e||c.default.failed())},t.prototype.finish=function(e,t){var r;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout(null!==(r=this.idleTimer)&&void 0!==r?r:void 0),this.idleTimer=null,this.emit(e,t),this.dispose())},t.prototype.onProtocolMessage=function(e){switch(s.default.shouldLog(s.default.LOG_MICRO)&&s.default.logAction(s.default.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+o.default.stringify(e)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),e.action){case f.HEARTBEAT:s.default.logAction(s.default.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",e.id);break;case f.CONNECTED:this.onConnect(e),this.emit("connected",e.error,e.connectionId,e.connectionDetails,e);break;case f.CLOSED:this.onClose(e);break;case f.DISCONNECTED:this.onDisconnect(e);break;case f.ACK:this.emit("ack",e.msgSerial,e.count);break;case f.NACK:this.emit("nack",e.msgSerial,e.count,e.error);break;case f.SYNC:this.connectionManager.onChannelMessage(e,this);break;case f.ACTIVATE:break;case f.AUTH:this.auth.authorize((function(e){e&&s.default.logAction(s.default.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+i.inspectError(e))}));break;case f.ERROR:if(s.default.logAction(s.default.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+l.default.Config.inspect(e.error)+(e.channel?", channel: "+e.channel:"")),void 0===e.channel){this.onFatalError(e);break}this.connectionManager.onChannelMessage(e,this);break;default:this.connectionManager.onChannelMessage(e,this)}},t.prototype.onConnect=function(e){if(this.isConnected=!0,!e.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");var t=e.connectionDetails.maxIdleInterval;t&&(this.maxIdleInterval=t+this.timeouts.realtimeRequestTimeout,this.onActivity())},t.prototype.onDisconnect=function(e){var t=e&&e.error;s.default.logAction(s.default.LOG_MINOR,"Transport.onDisconnect()","err = "+i.inspectError(t)),this.finish("disconnected",t)},t.prototype.onFatalError=function(e){var t=e&&e.error;s.default.logAction(s.default.LOG_MINOR,"Transport.onFatalError()","err = "+i.inspectError(t)),this.finish("failed",t)},t.prototype.onClose=function(e){var t=e&&e.error;s.default.logAction(s.default.LOG_MINOR,"Transport.onClose()","err = "+i.inspectError(t)),this.finish("closed",t)},t.prototype.requestClose=function(){s.default.logAction(s.default.LOG_MINOR,"Transport.requestClose()",""),this.send(d)},t.prototype.requestDisconnect=function(){s.default.logAction(s.default.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(h)},t.prototype.ping=function(e){var t={action:o.default.Action.HEARTBEAT};e&&(t.id=e),this.send(o.default.fromValues(t))},t.prototype.dispose=function(){s.default.logAction(s.default.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()},t.prototype.onActivity=function(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=i.now(),this.setIdleTimer(this.maxIdleInterval+100))},t.prototype.setIdleTimer=function(e){var t=this;this.idleTimer||(this.idleTimer=setTimeout((function(){t.onIdleTimerExpire()}),e))},t.prototype.onIdleTimerExpire=function(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;var e=i.now()-this.lastActivity,t=this.maxIdleInterval-e;if(t<=0){var r="No activity seen from realtime in "+e+"ms; assuming connection has dropped";s.default.logAction(s.default.LOG_ERROR,"Transport.onIdleTimerExpire()",r),this.disconnect(new u.default(r,80003,408))}else this.setIdleTimer(t+100)},t.tryConnect=function(e,t,r,n,o){var i,a=new e(t,r,n),c=function(e){clearTimeout(i),o({event:this.event,error:e})},l=t.options.timeouts.realtimeRequestTimeout;i=setTimeout((function(){a.off(["preconnect","disconnected","failed"]),a.dispose(),c.call({event:"disconnected"},new u.default("Timeout waiting for transport to indicate itself viable",5e4,500))}),l),a.on(["failed","disconnected"],c),a.on("preconnect",(function(){s.default.logAction(s.default.LOG_MINOR,"Transport.tryConnect()","viable transport "+a),clearTimeout(i),a.off(["failed","disconnected"],c),o(null,a)})),a.connect()},t}(a.default);t.default=p},function(e,t,r){var n,o,i,a,s,c,u,l;e.exports=(l=r(6),r(40),r(24),o=(n=l).lib,i=o.Base,a=o.WordArray,s=n.algo,c=s.MD5,u=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:c,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r,n=this.cfg,o=n.hasher.create(),i=a.create(),s=i.words,c=n.keySize,u=n.iterations;s.length<c;){r&&o.update(r),r=o.update(e).finalize(t),o.reset();for(var l=1;l<u;l++)r=o.finalize(r),o.reset();i.concat(r)}return i.sigBytes=4*c,i}}),n.EvpKDF=function(e,t,r){return u.create(r).compute(e,t)},l.EvpKDF)},function(e,t,r){var n,o,i,a,s,c,u,l,f,d,h,p,m,y,g,v,b,w,_;e.exports=(n=r(6),r(27),void(n.lib.Cipher||(o=n,i=o.lib,a=i.Base,s=i.WordArray,c=i.BufferedBlockAlgorithm,u=o.enc,u.Utf8,l=u.Base64,f=o.algo.EvpKDF,d=i.Cipher=c.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?_:b}return function(t){return{encrypt:function(r,n,o){return e(n).encrypt(t,r,n,o)},decrypt:function(r,n,o){return e(n).decrypt(t,r,n,o)}}}}()}),i.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),h=o.mode={},p=i.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=h.CBC=function(){var e=p.extend();function t(e,t,r){var n,o=this._iv;o?(n=o,this._iv=void 0):n=this._prevBlock;for(var i=0;i<r;i++)e[t+i]^=n[i]}return e.Encryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize;t.call(this,e,r,o),n.encryptBlock(e,r),this._prevBlock=e.slice(r,r+o)}}),e.Decryptor=e.extend({processBlock:function(e,r){var n=this._cipher,o=n.blockSize,i=e.slice(r,r+o);n.decryptBlock(e,r),t.call(this,e,r,o),this._prevBlock=i}}),e}(),y=(o.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,n=r-e.sigBytes%r,o=n<<24|n<<16|n<<8|n,i=[],a=0;a<n;a+=4)i.push(o);var c=s.create(i,n);e.concat(c)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},i.BlockCipher=d.extend({cfg:d.cfg.extend({mode:m,padding:y}),reset:function(){var e;d.reset.call(this);var t=this.cfg,r=t.iv,n=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=n.createEncryptor:(e=n.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,r&&r.words):(this._mode=e.call(n,this,r&&r.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),g=i.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),v=(o.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;return(r?s.create([1398893684,1701076831]).concat(r).concat(t):t).toString(l)},parse:function(e){var t,r=l.parse(e),n=r.words;return 1398893684==n[0]&&1701076831==n[1]&&(t=s.create(n.slice(2,4)),n.splice(0,4),r.sigBytes-=16),g.create({ciphertext:r,salt:t})}},b=i.SerializableCipher=a.extend({cfg:a.extend({format:v}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var o=e.createEncryptor(r,n),i=o.finalize(t),a=o.cfg;return g.create({ciphertext:i,key:r,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),w=(o.kdf={}).OpenSSL={execute:function(e,t,r,n){n||(n=s.random(8));var o=f.create({keySize:t+r}).compute(e,n),i=s.create(o.words.slice(t),4*r);return o.sigBytes=4*t,g.create({key:o,iv:i,salt:n})}},_=i.PasswordBasedCipher=b.extend({cfg:b.cfg.extend({kdf:w}),encrypt:function(e,t,r,n){var o=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize);n.iv=o.iv;var i=b.encrypt.call(this,e,t,o.key,n);return i.mixIn(o),i},decrypt:function(e,t,r,n){n=this.cfg.extend(n),t=this._parse(t,n.format);var o=n.kdf.execute(r,e.keySize,e.ivSize,t.salt);return n.iv=o.iv,b.decrypt.call(this,e,t,o.key,n)}}))))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.createRequest=void 0;var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(12)),a=n.__importDefault(r(3)),s=n.__importDefault(r(7)),c=r(4),u=n.__importDefault(r(8)),l=n.__importDefault(r(2)),f=n.__importDefault(r(21)),d=o.getGlobalObject(),h=function(){},p=d._ablyjs_jsonp={};p._=function(e){return p["_"+e]||h};var m=1;function y(e,t,r,n,i,a,s){return a=a||u.default.TIMEOUTS,new v(void 0,e,t,o.copy(r),n,i,a,s)}t.createRequest=y;var g=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.shortName="jsonp",n.stream=!1,o}return n.__extends(t,e),t.isAvailable=function(){return a.default.Config.jsonpSupported&&a.default.Config.allowComet},t.prototype.toString=function(){return"JSONPTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},t.prototype.createRequest=function(e,t,r,n,o,i,a){return y(e,t,r,n,o,i=(null==this?void 0:this.timeouts)||i||u.default.TIMEOUTS,a)},t}(i.default),v=function(e){function t(t,r,n,i,a,s,c,u){var l=e.call(this)||this;return void 0===t&&(t=m++),l.id=t,l.uri=r,l.params=i||{},l.params.rnd=o.cheapRandStr(),n&&(n["X-Ably-Version"]&&(l.params.v=n["X-Ably-Version"]),n["X-Ably-Lib"]&&(l.params.lib=n["X-Ably-Lib"])),l.body=a,l.method=u,l.requestMode=s,l.timeouts=c,l.requestComplete=!1,l}return n.__extends(t,e),t.prototype.exec=function(){var e=this,t=this.id,r=this.body,n=this.method,i=this.uri,s=this.params;s.callback="_ablyjs_jsonp._("+t+")",s.envelope="jsonp",r&&(s.body=r),n&&"get"!==n&&(s.method=n);var u=this.script=document.createElement("script"),d=i+o.toQueryString(s);u.src=d,u.src.split("/").slice(-1)[0]!==d.split("/").slice(-1)[0]&&l.default.logAction(l.default.LOG_ERROR,"JSONP Request.exec()","Warning: the browser appears to have truncated the script URI. This will likely result in the request failing due to an unparseable body param"),u.async=!0,u.type="text/javascript",u.charset="UTF-8",u.onerror=function(t){e.complete(new c.PartialErrorInfo("JSONP script error (event: "+a.default.Config.inspect(t)+")",null,400))},p["_"+t]=function(t){if(t.statusCode){var r=t.response;if(204==t.statusCode)e.complete(null,null,null,t.statusCode);else if(r)if(t.statusCode<400||o.isArray(r))e.complete(null,r,t.headers,t.statusCode);else{var n=r.error||new c.PartialErrorInfo("Error response received from server",null,t.statusCode);e.complete(n)}else e.complete(new c.PartialErrorInfo("Invalid server response: no envelope detected",null,500))}else e.complete(null,t)};var h=this.requestMode==f.default.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout;this.timer=setTimeout(this.abort.bind(this),h);var m=document.getElementsByTagName("head")[0];m.insertBefore(u,m.firstChild)},t.prototype.complete=function(e,t,r,n){if(r=r||{},!this.requestComplete){this.requestComplete=!0;var o=void 0;t&&(o="string"==typeof t?"text/plain":"application/json",r["content-type"]=o,this.emit("data",t)),this.emit("complete",e,t,r,!0,n),this.dispose()}},t.prototype.abort=function(){this.dispose()},t.prototype.dispose=function(){var e=this.timer;e&&(clearTimeout(e),this.timer=null);var t=this.script;t.parentNode&&t.parentNode.removeChild(t),delete p[this.id],this.emit("disposed")},t}(s.default);t.Request=v,t.default=function(e){return d.JSONPTransport=g,g.isAvailable()&&(e.supportedTransports.jsonp=g),g}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(2)),a=n.__importDefault(r(8)),s=n.__importDefault(r(17)),c=n.__importDefault(r(46)),u=n.__importDefault(r(19)),l=n.__importDefault(r(33)),f=n.__importDefault(r(4)),d=n.__importDefault(r(49)),h=n.__importDefault(r(18)),p=n.__importDefault(r(3)),m=n.__importDefault(r(9)),y=n.__importDefault(r(15)),g=n.__importDefault(r(14)),v=function(){},b=function(){function e(e){if(!e){var t="no options provided";throw i.default.logAction(i.default.LOG_ERROR,"Rest()",t),new Error(t)}var r=a.default.objectifyOptions(e);r.log&&i.default.setLog(r.log.level,r.log.handler),i.default.logAction(i.default.LOG_MICRO,"Rest()","initialized with clientOptions "+p.default.Config.inspect(e));var n=this.options=a.default.normaliseOptions(r);if(n.key){var o=n.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!o)throw t="invalid key parameter",i.default.logAction(i.default.LOG_ERROR,"Rest()",t),new f.default(t,40400,404);n.keyName=o[1],n.keySecret=o[2]}if("clientId"in n){if("string"!=typeof n.clientId&&null!==n.clientId)throw new f.default("clientId must be either a string or null",40012,400);if("*"===n.clientId)throw new f.default('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}i.default.logAction(i.default.LOG_MINOR,"Rest()","started; version = "+a.default.version),this.baseUri=this.authority=function(e){return a.default.getHttpScheme(n)+e+":"+a.default.getPort(n,!1)},this._currentFallback=null,this.serverTimeOffset=null,this.http=new p.default.Http(n),this.auth=new s.default(this,n),this.channels=new w(this),this.push=new c.default(this)}return e.prototype.stats=function(e,t){if(void 0===t)if("function"==typeof e)t=e,e=null;else{if(this.options.promises)return o.promisify(this,"stats",[e]);t=v}var r=o.defaultGetHeaders(this.options),n=this.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=this.http.supportsLinkHeaders?void 0:n;this.options.headers&&o.mixin(r,this.options.headers),new u.default(this,"/stats",r,i,(function(e,t,r){for(var n=r?e:JSON.parse(e),o=0;o<n.length;o++)n[o]=d.default.fromValues(n[o]);return n})).get(e,t)},e.prototype.time=function(e,t){var r=this;if(void 0===t)if("function"==typeof e)t=e,e=null;else if(this.options.promises)return o.promisify(this,"time",[e]);var n=t||v,i=o.defaultGetHeaders(this.options);this.options.headers&&o.mixin(i,this.options.headers),this.http.do(h.default.Get,this,(function(e){return r.authority(e)+"/time"}),i,null,e,(function(e,t,i,a){if(e)n(e);else{a||(t=JSON.parse(t));var s=t[0];s?(r.serverTimeOffset=s-o.now(),n(null,s)):n(new f.default("Internal error (unexpected result type from GET /time)",5e4,500))}}))},e.prototype.request=function(e,t,r,n,i,a){var s=this.options.useBinaryProtocol,c=s?p.default.Config.msgpack.encode:JSON.stringify,l=s?p.default.Config.msgpack.decode:JSON.parse,d=s?o.Format.msgpack:o.Format.json,h=this.http.supportsLinkHeaders?void 0:d;r=r||{};var m=e.toLowerCase(),y="get"==m?o.defaultGetHeaders(this.options,d):o.defaultPostHeaders(this.options,d);if(void 0===a){if(this.options.promises)return o.promisify(this,"request",[e,t,r,n,i]);a=v}"string"!=typeof n&&(n=c(n)),this.options.headers&&o.mixin(y,this.options.headers),i&&o.mixin(y,i);var g=new u.default(this,t,y,h,(function(e,t,r){return o.ensureArray(r?e:l(e))}),!0);if(!o.arrIn(p.default.Http.methods,m))throw new f.default("Unsupported method "+m,40500,405);o.arrIn(p.default.Http.methodsWithBody,m)?g[m](r,n,a):g[m](r,a)},e.prototype.batchPublish=function(e,t){if(void 0===t){if(this.options.promises)return o.promisify(this,"batchPublish",[e]);t=v}var r,n,i=t;o.isArray(e)?(r=e,n=!1):(r=[e],n=!0);var a=this.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,s=o.defaultPostHeaders(this.options,a);this.options.headers&&o.mixin(s,this.options.headers);var c=o.encodeBody(r,a);g.default.post(this,"/messages",c,s,{newBatchResponse:"true"},null,(function(e,t,r,s){if(e)i(e);else{var c=s?t:o.decodeBody(t,a);i(null,n?c[0]:c)}}))},e.prototype.batchPresence=function(e,t){if(void 0===t){if(this.options.promises)return o.promisify(this,"batchPresence",[e]);t=v}var r=t,n=this.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=o.defaultPostHeaders(this.options,n);this.options.headers&&o.mixin(i,this.options.headers);var a=e.join(",");g.default.get(this,"/presence",i,{newBatchResponse:"true",channels:a},null,(function(e,t,i,a){if(e)r(e);else{var s=a?t:o.decodeBody(t,n);r(null,s)}}))},e.prototype.setLog=function(e){i.default.setLog(e.level,e.handler)},e.Promise=function(t){return(t=a.default.objectifyOptions(t)).promises=!0,new e(t)},e.Callbacks=e,e.Platform=p.default,e.Message=m.default,e.PresenceMessage=y.default,e}(),w=function(){function e(e){this.rest=e,this.all=Object.create(null)}return e.prototype.get=function(e,t){e=String(e);var r=this.all[e];return r?t&&r.setOptions(t):this.all[e]=r=new l.default(this.rest,e,t),r},e.prototype.release=function(e){delete this.all[String(e)]},e}();t.default=b},function(e,t,r){e.exports=r(6).enc.Utf8},function(e,t,r){var n;e.exports=(n=r(6),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[],c=[];!function(){function t(t){for(var r=e.sqrt(t),n=2;n<=r;n++)if(!(t%n))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var n=2,o=0;o<64;)t(n)&&(o<8&&(s[o]=r(e.pow(n,.5))),c[o]=r(e.pow(n,1/3)),o++),n++}();var u=[],l=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],l=r[5],f=r[6],d=r[7],h=0;h<64;h++){if(h<16)u[h]=0|e[t+h];else{var p=u[h-15],m=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,y=u[h-2],g=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;u[h]=m+u[h-7]+g+u[h-16]}var v=n&o^n&i^o&i,b=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),w=d+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&f)+c[h]+u[h];d=f,f=l,l=s,s=a+w|0,a=i,i=o,o=n,n=w+(b+v)|0}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0,r[5]=r[5]+l|0,r[6]=r[6]+f|0,r[7]=r[7]+d|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;return r[o>>>5]|=128<<24-o%32,r[14+(o+64>>>9<<4)]=e.floor(n/4294967296),r[15+(o+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),n.SHA256)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=o.__importStar(r(1)),a=o.__importDefault(r(7)),s=o.__importDefault(r(2)),c=o.__importDefault(r(34)),u=o.__importDefault(r(9)),l=o.__importDefault(r(4)),f=o.__importDefault(r(19)),d=o.__importDefault(r(14)),h=o.__importDefault(r(3));function p(){}function m(e){return i.arrEvery(e,(function(e){return!e.id}))}function y(e){var t=e||{};if(t.cipher){if(!h.default.Crypto)throw new Error("Encryption not enabled; use ably.encryption.js instead");var r=h.default.Crypto.getCipher(t.cipher);t.cipher=r.cipherParams,t.channelCipher=r.cipher}else"cipher"in t&&(t.cipher=void 0,t.channelCipher=null);return t}var g=function(e){function t(t,r,n){var o=e.call(this)||this;return s.default.logAction(s.default.LOG_MINOR,"Channel()","started; name = "+r),o.rest=t,o.name=r,o.basePath="/channels/"+encodeURIComponent(r),o.presence=new c.default(o),o.channelOptions=y(n),o}return o.__extends(t,e),t.prototype.setOptions=function(e){this.channelOptions=y(e)},t.prototype.history=function(e,t){if(s.default.logAction(s.default.LOG_MICRO,"Channel.history()","channel = "+this.name),void 0===t)if("function"==typeof e)t=e,e=null;else{if(this.rest.options.promises)return i.promisify(this,"history",arguments);t=p}this._history(e,t)},t.prototype._history=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,o=this.rest.http.supportsLinkHeaders?void 0:n,a=i.defaultGetHeaders(r.options,n);r.options.headers&&i.mixin(a,r.options.headers);var s=this.channelOptions;new f.default(r,this.basePath+"/messages",a,o,(function(e,t,r){return u.default.fromResponseBody(e,s,r?void 0:n)})).get(e,t)},t.prototype.publish=function(){var e,t,r=this,o=arguments.length,a=arguments[0],s=arguments[1],c=arguments[o-1];if("function"!=typeof c){if(this.rest.options.promises)return i.promisify(this,"publish",arguments);c=p}if("string"==typeof a||null===a)e=[u.default.fromValues({name:a,data:s})],t=arguments[2];else if(i.isObject(a))e=[u.default.fromValues(a)],t=arguments[1];else{if(!i.isArray(a))throw new l.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);e=u.default.fromValuesArray(a),t=arguments[1]}"object"===n(t)&&t||(t={});var f=this.rest,d=f.options,h=d.useBinaryProtocol?i.Format.msgpack:i.Format.json,y=f.options.idempotentRestPublishing,g=i.defaultPostHeaders(f.options,h);if(d.headers&&i.mixin(g,d.headers),y&&m(e)){var v=i.randomString(9);i.arrForEach(e,(function(e,t){e.id=v+":"+t.toString()}))}u.default.encodeArray(e,this.channelOptions,(function(n){if(n)c(n);else{var o=u.default.getMessagesSize(e),i=d.maxMessageSize;o>i?c(new l.default("Maximum size of messages that can be published at once exceeded ( was "+o+" bytes; limit is "+i+" bytes)",40009,400)):r._publish(u.default.serialize(e,h),g,t,c)}}))},t.prototype._publish=function(e,t,r,n){d.default.post(this.rest,this.basePath+"/messages",e,t,r,null,n)},t.prototype.status=function(e){if("function"!=typeof e&&this.rest.options.promises)return i.promisify(this,"status",[]);var t=this.rest.options.useBinaryProtocol?i.Format.msgpack:i.Format.json,r=i.defaultPostHeaders(this.rest.options,t);d.default.get(this.rest,this.basePath,r,{},t,e||p)},t}(a.default);t.default=g},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(7)),a=n.__importDefault(r(2)),s=n.__importDefault(r(19)),c=n.__importDefault(r(15));function u(){}var l=function(e){function t(t){var r=e.call(this)||this;return r.channel=t,r.basePath=t.basePath+"/presence",r}return n.__extends(t,e),t.prototype.get=function(e,t){if(a.default.logAction(a.default.LOG_MICRO,"Presence.get()","channel = "+this.channel.name),void 0===t)if("function"==typeof e)t=e,e=null;else{if(this.channel.rest.options.promises)return o.promisify(this,"get",arguments);t=u}var r=this.channel.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=this.channel.rest.http.supportsLinkHeaders?void 0:n,l=o.defaultGetHeaders(r.options,n);r.options.headers&&o.mixin(l,r.options.headers);var f=this.channel.channelOptions;new s.default(r,this.basePath,l,i,(function(e,t,r){return c.default.fromResponseBody(e,f,r?void 0:n)})).get(e,t)},t.prototype.history=function(e,t){return a.default.logAction(a.default.LOG_MICRO,"Presence.history()","channel = "+this.channel.name),this._history(e,t)},t.prototype._history=function(e,t){if(void 0===t)if("function"==typeof e)t=e,e=null;else{if(this.channel.rest.options.promises)return o.promisify(this,"_history",[e]);t=u}var r=this.channel.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=this.channel.rest.http.supportsLinkHeaders?void 0:n,a=o.defaultGetHeaders(r.options,n);r.options.headers&&o.mixin(a,r.options.headers);var l=this.channel.channelOptions;new s.default(r,this.basePath+"/history",a,i,(function(e,t,r){return c.default.fromResponseBody(e,l,r?void 0:n)})).get(e,t)},t}(i.default);t.default=l},function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.TransportParams=void 0;var n=r(0),o=n.__importDefault(r(10)),i=n.__importStar(r(1)),a=n.__importStar(r(52)),s=n.__importStar(r(8)),c=n.__importDefault(r(3)),u=n.__importDefault(r(7)),l=n.__importDefault(r(36)),f=n.__importDefault(r(2)),d=n.__importDefault(r(37)),h=n.__importStar(r(20)),p=n.__importStar(r(4)),m=n.__importDefault(r(17)),y=n.__importDefault(r(9)),g=n.__importDefault(r(23)),v=n.__importDefault(r(53)),b=n.__importDefault(r(26)),w=n.__importDefault(r(25)),_=function(){var e;return void 0!==c.default.WebStorage&&(null===(e=c.default.WebStorage)||void 0===e?void 0:e.localSupported)},O=function(){var e;return void 0!==c.default.WebStorage&&(null===(e=c.default.WebStorage)||void 0===e?void 0:e.sessionSupported)},S=o.default.Action,E=function(){};function k(e){try{return JSON.parse(e)}catch(e){return null}}var C=function(){function e(e,t,r,n){this.options=e,this.host=t,this.mode=r,this.connectionKey=n,this.format=e.useBinaryProtocol?i.Format.msgpack:i.Format.json}return e.prototype.getConnectParams=function(e){var t=e?i.copy(e):{},r=this.options;switch(this.mode){case"upgrade":t.upgrade=this.connectionKey;break;case"resume":t.resume=this.connectionKey;break;case"recover":var n=k(r.recover);n&&(t.recover=n.connectionKey)}return void 0!==r.clientId&&(t.clientId=r.clientId),!1===r.echoMessages&&(t.echo="false"),void 0!==this.format&&(t.format=this.format),void 0!==this.stream&&(t.stream=this.stream),void 0!==this.heartbeats&&(t.heartbeats=this.heartbeats),t.v=s.default.protocolVersion,t.agent=(0,s.getAgentString)(this.options),void 0!==r.transportParams&&i.mixin(t,r.transportParams),t},e.prototype.toString=function(){var e="[mode="+this.mode;return this.host&&(e+=",host="+this.host),this.connectionKey&&(e+=",connectionKey="+this.connectionKey),this.format&&(e+=",format="+this.format),e+="]"},e}();t.TransportParams=C;var A=function(t){function r(e,n){var o=t.call(this)||this;o.disconnectedRetryCount=0,r.initTransports(),o.realtime=e,o.options=n;var a=n.timeouts,u=a.preferenceConnectTimeout+a.realtimeRequestTimeout;if(o.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:u,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},synchronizing:{state:"connected",terminal:!1,queueEvents:!0,sendEvents:!1,forceQueueEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:a.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:a.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:a.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},o.state=o.states.initialized,o.errorReason=null,o.queuedMessages=new l.default,o.msgSerial=0,o.connectionDetails=void 0,o.connectionId=void 0,o.connectionKey=void 0,o.connectionStateTtl=a.connectionStateTtl,o.maxIdleInterval=null,o.transports=i.intersect(n.transports||s.default.defaultTransports,r.supportedTransports),o.baseTransport=i.intersect(s.default.baseTransportOrder,o.transports)[0],o.upgradeTransports=i.intersect(o.transports,s.default.upgradeTransports),o.transportPreference=null,o.httpHosts=s.default.getHosts(n),o.activeProtocol=null,o.proposedTransports=[],o.pendingTransports=[],o.host=null,o.lastAutoReconnectAttempt=null,o.lastActivity=null,o.forceFallbackHost=!1,o.connectCounter=0,f.default.logAction(f.default.LOG_MINOR,"Realtime.ConnectionManager()","started"),f.default.logAction(f.default.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(n.transports||s.default.defaultTransports)+"]"),f.default.logAction(f.default.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+o.transports+"]"),f.default.logAction(f.default.LOG_MICRO,"Realtime.ConnectionManager()","http hosts = ["+o.httpHosts+"]"),!o.transports.length){var d="no requested transports available";throw f.default.logAction(f.default.LOG_ERROR,"realtime.ConnectionManager()",d),new Error(d)}var h=c.default.Config.addEventListener;return h&&(O()&&"function"==typeof n.recover&&h("beforeunload",o.persistConnection.bind(o)),!0===n.closeOnUnload&&h("beforeunload",(function(){f.default.logAction(f.default.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),o.requestState({state:"closing"})})),h("online",(function(){o.state==o.states.disconnected||o.state==o.states.suspended?(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),o.requestState({state:"connecting"})):o.state==o.states.connecting&&(o.pendingTransports.forEach((function(e){e.off()})),o.disconnectAllTransports(),o.startConnect())})),h("offline",(function(){o.state==o.states.connected&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),o.disconnectAllTransports())}))),o}return n.__extends(r,t),r.initTransports=function(){(0,v.default)(r),i.arrForEach(c.default.Transports,(function(e){e(r)}))},r.prototype.createTransportParams=function(e,t){return new C(this.options,e,t,this.connectionKey)},r.prototype.getTransportParams=function(e){var t=this;!function(e){if(t.connectionKey)e("resume");else if("string"!=typeof t.options.recover){var r,n,o=t.options.recover,i=O()&&(null===(n=null===(r=c.default.WebStorage)||void 0===r?void 0:r.getSession)||void 0===n?void 0:n.call(r,"ably-connection-recovery"));if(i&&"function"==typeof o)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data"),void o(i,(function(r){r?(t.options.recover=i.recoveryKey,e("recover")):e("clean")}));e("clean")}else e("recover")}((function(r){var n=t.createTransportParams(null,r);if("recover"===r){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+t.options.recover);var o=k(t.options.recover);o&&(t.msgSerial=o.msgSerial)}else f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+n.toString());e(n)}))},r.prototype.tryATransport=function(e,t,n){var o=this;f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+t),b.default.tryConnect(r.supportedTransports[t],this,this.realtime.auth,e,(function(r,i){var a=o.state;return a==o.states.closing||a==o.states.closed||a==o.states.failed?(i&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+a.state+" while we were attempting the transport; closing "+i),i.close()),void n(!0)):r?(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+t+" "+r.event+", err: "+r.error.toString()),void(!m.default.isTokenErr(r.error)||o.errorReason&&m.default.isTokenErr(o.errorReason)?"failed"===r.event?(o.notifyState({state:"failed",error:r.error}),n(!0)):"disconnected"===r.event&&((0,h.isRetriable)(r.error)?n(!1):(o.notifyState({state:o.states.connecting.failState,error:r.error}),n(!0))):(o.errorReason=r.error,o.realtime.auth._forceNewToken(null,null,(function(r){r?o.actOnErrorFromAuthorize(r):o.tryATransport(e,t,n)}))))):(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+t+"; setting pending"),o.setTransportPending(i,e),void n(null,i))}))},r.prototype.setTransportPending=function(e,t){var r=this,n=t.mode;f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+e+"; mode = "+n),i.arrDeleteValue(this.proposedTransports,e),this.pendingTransports.push(e);var o=c.default.Defaults.transportPreferenceOrder[c.default.Defaults.transportPreferenceOrder.length-1];e.once("connected",(function(a,s,u){"upgrade"==n&&r.activeProtocol?e.shortName!==o&&i.arrIn(r.getUpgradePossibilities(),o)&&r.activeProtocol?setTimeout((function(){r.scheduleTransportActivation(a,e,s,u)}),r.options.timeouts.parallelUpgradeDelay):r.scheduleTransportActivation(a,e,s,u):(r.activateTransport(a,e,s,u),c.default.Config.nextTick((function(){r.connectImpl(t)}))),"recover"===n&&r.options.recover&&(r.options.recover=null,r.unpersistConnection())}));var a=this;e.on(["disconnected","closed","failed"],(function(t){a.deactivateTransport(e,this.event,t)})),this.emit("transport.pending",e)},r.prototype.scheduleTransportActivation=function(e,t,r,n){var a,s,u=this,l=this.activeProtocol&&this.activeProtocol.getTransport(),d=function(){t.disconnect(),i.arrDeleteValue(u.pendingTransports,t)};if(this.state!==this.states.connected&&this.state!==this.states.connecting)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+t.shortName),void d();if(l&&(a=t,s=l,!(i.arrIndexOf(c.default.Defaults.transportPreferenceOrder,a.shortName)>i.arrIndexOf(c.default.Defaults.transportPreferenceOrder,s.shortName))))return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+t.shortName+" is no better than current active transport "+l.shortName+" - abandoning upgrade"),void d();f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Scheduling transport upgrade; transport = "+t);var h=null;if(!t.isConnected)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Proposed transport "+t.shortName+"is no longer connected; abandoning upgrade"),void d();if(this.state===this.states.connected)f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Currently connected, so temporarily pausing events until the upgrade is complete"),this.state=this.states.synchronizing,h=this.activeProtocol;else if(this.state!==this.states.connecting)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Current connection state ("+this.state.state+(this.state===this.states.synchronizing?", but with an upgrade already in progress":"")+") is not valid to upgrade in; abandoning upgrade to "+t.shortName),void d();f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Syncing transport; transport = "+t);var p=function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Activating transport; transport = "+t),t.send(o.default.fromValues({action:S.ACTIVATE})),u.activateTransport(e,t,r,n),u.state===u.states.synchronizing?(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, sending queued messages on upgraded transport; transport = "+t),u.state=u.states.connected):f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.scheduleTransportActivation()","Pre-upgrade protocol idle, but state is now "+u.state.state+", so leaving unchanged"),u.state.sendEvents&&u.sendQueuedMessages()};h?h.onceIdle(p):p()},r.prototype.activateTransport=function(e,t,r,n){var o=this;f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+t),e&&f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+e),r&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+r),n&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(n)),this.persistTransportPreference(t);var s=this.state,u=this.states.connected.state;if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+s.state),s.state==this.states.closing.state||s.state==this.states.closed.state||s.state==this.states.failed.state)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),t.disconnect(),!1;if(i.arrDeleteValue(this.pendingTransports,t),!t.isConnected)return f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+t+" since it appears to no longer be connected"),!1;var l=this.activeProtocol;this.activeProtocol=new a.default(t),this.host=t.params.host;var h=n.connectionKey;if(h&&this.connectionKey!=h&&this.setConnection(r,n,!!e),this.onConnectionDetailsUpdate(n,t),c.default.Config.nextTick((function(){t.on("connected",(function(e,r,n){o.onConnectionDetailsUpdate(n,t),o.emit("update",new d.default(u,u,null,e))}))})),s.state===this.states.connected.state?e&&(this.errorReason=this.realtime.connection.errorReason=e,this.emit("update",new d.default(u,u,null,e))):(this.notifyState({state:"connected",error:e}),this.errorReason=this.realtime.connection.errorReason=e||null),this.emit("transport.active",t),l)if(l.messageQueue.count()>0&&f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+l.transport.shortName+", new one is "+t.shortName+") finishing with "+l.messageQueue.count()+" messages still pending"),l.transport===t){var p="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+t.shortName+"; stack = "+(new Error).stack;f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()",p)}else l.finish();return i.safeArrForEach(this.pendingTransports,(function(e){if(e===t){var r="Assumption violated: activating a transport that is still marked as a pending transport; transport = "+t.shortName+"; stack = "+(new Error).stack;f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()",r),i.arrDeleteValue(o.pendingTransports,t)}else e.disconnect()})),i.safeArrForEach(this.proposedTransports,(function(e){e===t?(f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.activateTransport()","Assumption violated: activating a transport that is still marked as a proposed transport; transport = "+t.shortName+"; stack = "+(new Error).stack),i.arrDeleteValue(o.proposedTransports,t)):e.dispose()})),!0},r.prototype.deactivateTransport=function(e,t,r){var n=this.activeProtocol,o=n&&n.getTransport()===e,a=i.arrDeleteValue(this.pendingTransports,e),s=i.arrDeleteValue(this.proposedTransports,e),u=this.noTransportsScheduledForActivation();if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+e),f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+t+(o?"; was active":a?"; was pending":s?"; was proposed":"")+(u?"":"; another transport is scheduled for activation")),r&&r.message&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+r.message),o&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(n.getPendingMessages()),c.default.Config.nextTick((function(){n.clearPendingMessages()})),this.activeProtocol=this.host=null),this.emit("transport.inactive",e),o&&u||o&&"failed"===t||"closed"===t||null===n&&a&&0===this.pendingTransports.length){if("disconnected"===t&&r&&r.statusCode>500&&this.httpHosts.length>1)return this.unpersistTransportPreference(),this.forceFallbackHost=!0,void this.notifyState({state:t,error:r,retryImmediately:!0});var l="failed"===t&&m.default.isTokenErr(r)?"disconnected":t;this.notifyState({state:l,error:r})}else o&&"disconnected"===t&&this.state!==this.states.synchronizing&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.deactivateTransport()","wasActive but another transport is connected and scheduled for activation, so going into the connecting state until it activates"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),this.notifyState({state:"connecting",error:r}))},r.prototype.noTransportsScheduledForActivation=function(){return i.isEmpty(this.pendingTransports)||this.pendingTransports.every((function(e){return!e.isConnected}))},r.prototype.setConnection=function(e,t,r){var n=this.connectionId;(n&&n!==e||!n&&r)&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==e&&f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=e,this.realtime.connection.key=this.connectionKey=t.connectionKey},r.prototype.clearConnection=function(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()},r.prototype.createRecoveryKey=function(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null},r.prototype.checkConnectionStateFreshness=function(){if(this.lastActivity&&this.connectionId){var e=i.now()-this.lastActivity;e>this.connectionStateTtl+this.maxIdleInterval&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+e+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}},r.prototype.persistConnection=function(){if(O()){var t=this.createRecoveryKey();t&&(r={recoveryKey:t,disconnectedAt:i.now(),location:e.location,clientId:this.realtime.auth.clientId},O()&&(null===(o=null===(n=c.default.WebStorage)||void 0===n?void 0:n.setSession)||void 0===o||o.call(n,"ably-connection-recovery",r)))}var r,n,o},r.prototype.unpersistConnection=function(){var e,t;O()&&(null===(t=null===(e=c.default.WebStorage)||void 0===e?void 0:e.removeSession)||void 0===t||t.call(e,"ably-connection-recovery"))},r.prototype.getError=function(){return this.errorReason||this.getStateError()},r.prototype.getStateError=function(){var e,t;return null===(t=(e=h.default)[this.state.state])||void 0===t?void 0:t.call(e)},r.prototype.activeState=function(){return this.state.queueEvents||this.state.sendEvents},r.prototype.enactStateChange=function(e){var t="failed"===e.current?f.default.LOG_ERROR:f.default.LOG_MAJOR;f.default.logAction(t,"Connection state",e.current+(e.reason?"; reason: "+e.reason:"")),f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+e.current+"; reason = "+(e.reason&&e.reason.message));var r=this.state=this.states[e.current];e.reason&&(this.errorReason=e.reason,this.realtime.connection.errorReason=e.reason),(r.terminal||"suspended"===r.state)&&this.clearConnection(),this.emit("connectionstate",e)},r.prototype.startTransitionTimer=function(e){var t=this;f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+e.state),this.transitionTimer&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout((function(){t.transitionTimer&&(t.transitionTimer=null,f.default.logAction(f.default.LOG_MINOR,"ConnectionManager "+e.state+" timer expired","requesting new state: "+e.failState),t.notifyState({state:e.failState}))}),e.retryDelay)},r.prototype.cancelTransitionTimer=function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)},r.prototype.startSuspendTimer=function(){var e=this;this.suspendTimer||(this.suspendTimer=setTimeout((function(){e.suspendTimer&&(e.suspendTimer=null,f.default.logAction(f.default.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),e.states.connecting.failState="suspended",e.notifyState({state:"suspended"}))}),this.connectionStateTtl))},r.prototype.checkSuspendTimer=function(e){"disconnected"!==e&&"suspended"!==e&&"connecting"!==e&&this.cancelSuspendTimer()},r.prototype.cancelSuspendTimer=function(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)},r.prototype.startRetryTimer=function(e){var t=this;this.retryTimer=setTimeout((function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),t.retryTimer=null,t.requestState({state:"connecting"})}),e)},r.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},r.prototype.notifyState=function(e){var t,r,n=this,o=e.state,a="disconnected"===o&&(this.state===this.states.connected||this.state===this.states.synchronizing||e.retryImmediately||this.state===this.states.connecting&&e.error&&m.default.isTokenErr(e.error)&&!(this.errorReason&&m.default.isTokenErr(this.errorReason)));if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+o+(a?"; will retry connection immediately":"")),o!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(e.state),"suspended"!==o&&"connected"!==o||(this.disconnectedRetryCount=0),!this.state.terminal)){var s=this.states[e.state],u=s.retryDelay;"disconnected"===s.state&&(this.disconnectedRetryCount++,u=i.getRetryTime(s.retryDelay,this.disconnectedRetryCount));var l=new d.default(this.state.state,s.state,u,e.error||(null===(r=(t=h.default)[s.state])||void 0===r?void 0:r.call(t)));if(a){var p=function(){n.state===n.states.disconnected&&(n.lastAutoReconnectAttempt=i.now(),n.requestState({state:"connecting"}))},y=this.lastAutoReconnectAttempt&&i.now()-this.lastAutoReconnectAttempt+1;y&&y<1e3?(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+y+"ms ago, waiting another "+(1e3-y)+"ms before trying again"),setTimeout(p,1e3-y)):c.default.Config.nextTick(p)}else"disconnected"!==o&&"suspended"!==o||this.startRetryTimer(u);("disconnected"===o&&!a||"suspended"===o||s.terminal)&&c.default.Config.nextTick((function(){n.disconnectAllTransports()})),"connected"!=o||this.activeProtocol||f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(l),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(o,l.reason),this.failQueuedMessages(l.reason))}},r.prototype.requestState=function(e){var t,r,n=this,o=e.state;if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+o+"; current state: "+this.state.state),o!=this.state.state&&(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(o),!("connecting"==o&&"connected"==this.state.state||"closing"==o&&"closed"==this.state.state))){var i=this.states[o],a=new d.default(this.state.state,i.state,null,e.error||(null===(r=(t=h.default)[i.state])||void 0===r?void 0:r.call(t)));this.enactStateChange(a),"connecting"==o&&c.default.Config.nextTick((function(){n.startConnect()})),"closing"==o&&this.closeImpl()}},r.prototype.startConnect=function(){var e=this;if(this.state===this.states.connecting){var t=this.realtime.auth,r=++this.connectCounter,n=function(){e.checkConnectionStateFreshness(),e.getTransportParams((function(t){if("recover"===t.mode&&t.options.recover){var n=k(t.options.recover);n&&e.realtime.channels.recoverChannels(n.channelSerials)}r===e.connectCounter&&e.connectImpl(t,r)}))};if(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),"basic"===t.method)n();else{var o=function(t){r===e.connectCounter&&(t?e.actOnErrorFromAuthorize(t):n())};this.errorReason&&m.default.isTokenErr(this.errorReason)?t._forceNewToken(null,null,o):t._ensureValidAuthCredentials(!1,o)}}else f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state)},r.prototype.connectImpl=function(e,t){var r=this.state.state;r!==this.states.connecting.state&&r!==this.states.connected.state?f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect (or connected to upgrade), but was "+r):this.pendingTransports.length?f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectImpl()","Transports "+this.pendingTransports[0].toString()+" currently pending; taking no action"):r==this.states.connected.state?this.upgradeIfNeeded(e):this.transports.length>1&&this.getTransportPreference()?this.connectPreference(e,t):this.connectBase(e,t)},r.prototype.connectPreference=function(e,t){var r=this,n=this.getTransportPreference(),o=!1;i.arrIn(this.transports,n)||(this.unpersistTransportPreference(),this.connectImpl(e,t)),f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectPreference()","Trying to connect with stored transport preference "+n);var a=setTimeout((function(){o=!0,r.state.state!==r.states.connected.state&&(f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectPreference()","Shortcircuit connection attempt with "+n+" failed; clearing preference and trying from scratch"),r.disconnectAllTransports(),r.unpersistTransportPreference()),r.connectImpl(e,t)}),this.options.timeouts.preferenceConnectTimeout);e.host=this.httpHosts[0],this.tryATransport(e,n,(function(n,s){clearTimeout(a),o&&s?(s.off(),s.disconnect(),i.arrDeleteValue(r.pendingTransports,s)):s||n||(r.unpersistTransportPreference(),r.connectImpl(e,t))}))},r.prototype.connectBase=function(e,t){var r=this,n=function(e){r.notifyState({state:r.states.connecting.failState,error:e})},o=this.httpHosts.slice(),a=function(e,n){t===r.connectCounter&&(n||e||c())};f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.connectBase()","Trying to connect with base transport "+this.baseTransport);var s=o.shift();if(s){e.host=s;var c=function(){o.length?r.realtime.http.checkConnectivity?r.realtime.http.checkConnectivity((function(s,c){t===r.connectCounter&&(s?n(s):c?(e.host=i.arrPopRandomElement(o),r.tryATransport(e,r.baseTransport,a)):n(new p.default("Unable to connect (network unreachable)",80003,404)))})):n(new p.PartialErrorInfo("Internal error: Http.checkConnectivity not set",null,500)):n(new p.default("Unable to connect (and no more fallback hosts to try)",80003,404))};if(this.forceFallbackHost&&o.length)return this.forceFallbackHost=!1,void c();this.tryATransport(e,this.baseTransport,a)}else n(new p.default("Unable to connect (no available host)",80003,404))},r.prototype.getUpgradePossibilities=function(){var e=this.activeProtocol.getTransport().shortName,t=i.arrIndexOf(this.upgradeTransports,e);return this.upgradeTransports.slice(t+1)},r.prototype.upgradeIfNeeded=function(e){var t=this,r=this.getUpgradePossibilities();f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.upgradeIfNeeded()","upgrade possibilities: "+c.default.Config.inspect(r)),r.length&&i.arrForEach(r,(function(r){var n=t.createTransportParams(e.host,"upgrade");t.tryATransport(n,r,E)}))},r.prototype.closeImpl=function(){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),i.safeArrForEach(this.pendingTransports,(function(e){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+e),e&&e.close()})),i.safeArrForEach(this.proposedTransports,(function(e){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.closeImpl()","Disposing of proposed transport: "+e),e&&e.dispose()})),this.activeProtocol&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})},r.prototype.onAuthUpdated=function(e,t){var r,n=this;switch(this.state.state){case"connected":if(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport"),(this.pendingTransports.length||this.proposedTransports.length)&&this.state!==this.states.synchronizing){this.disconnectAllTransports(!0);var i=this.activeProtocol.getTransport().params;c.default.Config.nextTick((function(){"connected"===n.state.state&&n.upgradeIfNeeded(i)}))}var a=null===(r=this.activeProtocol)||void 0===r?void 0:r.getTransport();a&&a.onAuthUpdated&&a.onAuthUpdated(e);var s=o.default.fromValues({action:S.AUTH,auth:{accessToken:e.token}});this.send(s);var u=function(){n.off(l),t(null,e)},l=function e(r){"failed"===r.current&&(n.off(u),n.off(e),t(r.reason||n.getStateError()))};this.once("connectiondetails",u),this.on("connectionstate",l);break;case"connecting":f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed"),this.on("connectionstate",(function r(o){switch(o.current){case"connected":n.off(r),t(null,e);break;case"failed":case"closed":case"suspended":n.off(r),t(o.reason||n.getStateError())}})),"connecting"===this.state.state?this.startConnect():this.requestState({state:"connecting"})}},r.prototype.disconnectAllTransports=function(e){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"+(e?" except the active transport":"")),this.connectCounter++,i.safeArrForEach(this.pendingTransports,(function(e){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+e),e&&e.disconnect()})),this.pendingTransports=[],i.safeArrForEach(this.proposedTransports,(function(e){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disposing of proposed transport: "+e),e&&e.dispose()})),this.proposedTransports=[],this.activeProtocol&&!e&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())},r.prototype.send=function(e,t,r){r=r||E;var n=this.state;if(n.sendEvents)return f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.send()","sending event"),void this.sendImpl(new a.PendingMessage(e,r));if(!(t&&n.queueEvents||n.forceQueueEvents)){var i="rejecting event, queueEvent was "+t+", state was "+n.state;return f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.send()",i),void r(this.errorReason||new p.default(i,9e4,400))}f.default.shouldLog(f.default.LOG_MICRO)&&f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+o.default.stringify(e)),this.queue(e,r)},r.prototype.sendImpl=function(e){var t=e.message;e.ackRequired&&!e.sendAttempted&&(t.msgSerial=this.msgSerial++);try{this.activeProtocol.send(e)}catch(e){f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+e.stack)}},r.prototype.queue=function(e,t){f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.queue()","queueing event");var r=this.queuedMessages.last(),n=this.options.maxMessageSize;r&&!r.sendAttempted&&function(e,t,r){var n;if(e.channel!==t.channel)return!1;if((n=e.action)!==S.PRESENCE&&n!==S.MESSAGE)return!1;if(n!==t.action)return!1;var o=n===S.PRESENCE?"presence":"messages",a=e[o].concat(t[o]);return!(y.default.getMessagesSize(a)>r||!i.allSame(a,"clientId")||!i.arrEvery(a,(function(e){return!e.id}))||(e[o]=a,0))}(r.message,e,n)?(r.merged||(r.callback=g.default.create([r.callback]),r.merged=!0),r.callback.push(t)):this.queuedMessages.push(new a.PendingMessage(e,t))},r.prototype.sendQueuedMessages=function(){var e;for(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");e=this.queuedMessages.shift();)this.sendImpl(e)},r.prototype.queuePendingMessages=function(e){e&&e.length&&(f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+e.length+" pending messages"),this.queuedMessages.prepend(e))},r.prototype.failQueuedMessages=function(e){var t=this.queuedMessages.count();t>0&&(f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+t+" queued messages, err = "+i.inspectError(e)),this.queuedMessages.completeAllMessages(e))},r.prototype.onChannelMessage=function(e,t){var r=this.activeProtocol&&t===this.activeProtocol.getTransport(),n=i.arrIn(this.pendingTransports,t)&&this.state==this.states.synchronizing;r||n||i.arrIndexOf([S.ACK,S.NACK,S.ERROR],e.action)>-1?this.realtime.channels.onChannelMessage(e):f.default.logAction(f.default.LOG_MICRO,"ConnectionManager.onChannelMessage()","received message "+JSON.stringify(e)+"on defunct transport; discarding")},r.prototype.ping=function(e,t){var r=this;if(e){f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.ping()","transport = "+e);var n=i.now(),o=i.cheapRandStr(),a=function r(a){if(a===o){e.off("heartbeat",r),clearTimeout(s);var c=i.now()-n;t(null,c)}},s=setTimeout((function(){e.off("heartbeat",a),t(new p.default("Timeout waiting for heartbeat response",5e4,500))}),this.options.timeouts.realtimeRequestTimeout);return e.on("heartbeat",a),void e.ping(o)}if("connected"===this.state.state){var u=!1,l=function(){u||(u=!0,c.default.Config.nextTick((function(){r.ping(null,t)})))};this.on("transport.active",l),this.ping(this.activeProtocol.getTransport(),(function(e,n){r.off("transport.active",l),u||(u=!0,t(e,n))}))}else t(new p.default("Unable to ping service; not connected",4e4,400))},r.prototype.abort=function(e){this.activeProtocol.getTransport().fail(e)},r.prototype.registerProposedTransport=function(e){this.proposedTransports.push(e)},r.prototype.getTransportPreference=function(){var e,t;return this.transportPreference||_()&&(null===(t=null===(e=c.default.WebStorage)||void 0===e?void 0:e.get)||void 0===t?void 0:t.call(e,"ably-transport-preference"))},r.prototype.persistTransportPreference=function(e){var t,r;i.arrIn(s.default.upgradeTransports,e.shortName)&&(this.transportPreference=e.shortName,_()&&(null===(r=null===(t=c.default.WebStorage)||void 0===t?void 0:t.set)||void 0===r||r.call(t,"ably-transport-preference",e.shortName)))},r.prototype.unpersistTransportPreference=function(){var e,t;this.transportPreference=null,_()&&(null===(t=null===(e=c.default.WebStorage)||void 0===e?void 0:e.remove)||void 0===t||t.call(e,"ably-transport-preference"))},r.prototype.actOnErrorFromAuthorize=function(e){if(40171===e.code)this.notifyState({state:"failed",error:e});else if(40102===e.code)this.notifyState({state:"failed",error:e});else if(e.statusCode===w.default.Forbidden){var t="Client configured authentication provider returned 403; failing the connection";f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",t),this.notifyState({state:"failed",error:new p.default(t,80019,403,e)})}else t="Client configured authentication provider request failed",f.default.logAction(f.default.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",t),this.notifyState({state:this.state.failState,error:new p.default(t,80019,401,e)})},r.prototype.onConnectionDetailsUpdate=function(e,t){if(e){this.connectionDetails=e,e.maxMessageSize&&(this.options.maxMessageSize=e.maxMessageSize);var r=e.clientId;if(r){var n=this.realtime.auth._uncheckedSetClientId(r);if(n)return f.default.logAction(f.default.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",n.message),void t.fail(n)}var o=e.connectionStateTtl;o&&(this.connectionStateTtl=o),this.maxIdleInterval=e.maxIdleInterval,this.emit("connectiondetails",e)}},r.supportedTransports={},r}(u.default);t.default=A}).call(this,r(13))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(7)),i=n.__importDefault(r(2)),a=function(e){function t(){var t=e.call(this)||this;return t.messages=[],t}return n.__extends(t,e),t.prototype.count=function(){return this.messages.length},t.prototype.push=function(e){this.messages.push(e)},t.prototype.shift=function(){return this.messages.shift()},t.prototype.last=function(){return this.messages[this.messages.length-1]},t.prototype.copyAll=function(){return this.messages.slice()},t.prototype.append=function(e){this.messages.push.apply(this.messages,e)},t.prototype.prepend=function(e){this.messages.unshift.apply(this.messages,e)},t.prototype.completeMessages=function(e,t,r){i.default.logAction(i.default.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+e+"; count = "+t),r=r||null;var n=this.messages;if(0===n.length)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");var o=n[0];if(o){var a=o.message.msgSerial,s=e+t;if(s>a)for(var c=0,u=n.splice(0,s-a);c<u.length;c++)u[c].callback(r);0==n.length&&this.emit("idle")}},t.prototype.completeAllMessages=function(e){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,e)},t.prototype.resetSendAttempted=function(){for(var e=0,t=this.messages;e<t.length;e++)t[e].sendAttempted=!1},t.prototype.clear=function(){i.default.logAction(i.default.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")},t}(o.default);t.default=a},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,r,n){this.previous=e,this.current=t,r&&(this.retryIn=r),n&&(this.reason=n)};t.default=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=o.__importDefault(r(10)),a=o.__importDefault(r(7)),s=o.__importStar(r(1)),c=o.__importDefault(r(33)),u=o.__importDefault(r(2)),l=o.__importDefault(r(54)),f=o.__importDefault(r(9)),d=o.__importDefault(r(39)),h=o.__importStar(r(4)),p=o.__importDefault(r(15)),m=o.__importDefault(r(20)),y=i.default.Action,g=function(){};function v(e){if(e&&"params"in e&&!s.isObject(e.params))return new h.default("options.params must be an object",4e4,400);if(e&&"modes"in e){if(!s.isArray(e.modes))return new h.default("options.modes must be an array",4e4,400);for(var t=0;t<e.modes.length;t++){var r=e.modes[t];if(!r||"string"!=typeof r||!s.arrIn(i.default.channelModes,String.prototype.toUpperCase.call(r)))return new h.default("Invalid channel mode: "+r,4e4,400)}}}var b=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.retryCount=0,o.history=function(e,t){if(u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name),void 0===t)if("function"==typeof e)t=e,e=null;else{if(this.rest.options.promises)return s.promisify(this,"history",arguments);t=g}if(e&&e.untilAttach){if("attached"!==this.state)return void t(new h.default("option untilAttach requires the channel to be attached",4e4,400));if(!this.properties.attachSerial)return void t(new h.default("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400));delete e.untilAttach,e.from_serial=this.properties.attachSerial}c.default.prototype._history.call(this,e,t)},o.whenState=function(e,t){return a.default.prototype.whenState.call(o,e,o.state,t)},u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel()","started; name = "+r),o.realtime=t,o.presence=new l.default(o),o.connectionManager=t.connection.connectionManager,o.state="initialized",o.subscriptions=new a.default,o.syncChannelSerial=void 0,o.properties={attachSerial:void 0,channelSerial:void 0},o.setOptions(n),o.errorReason=null,o._requestedFlags=null,o._mode=null,o._attachResume=!1,o._decodingContext={channelOptions:o.channelOptions,plugins:t.options.plugins||{},baseEncodedPreviousPayload:void 0},o._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},o._allChannelChanges=new a.default,o}return o.__extends(t,e),t.prototype.invalidStateError=function(){return new h.default("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)},t.processListenerArgs=function(e){return"function"==typeof(e=Array.prototype.slice.call(e))[0]&&e.unshift(null),null==e[e.length-1]&&e.pop(),e},t.prototype.setOptions=function(e,t){if(!t&&this.rest.options.promises)return s.promisify(this,"setOptions",arguments);var r=t||function(e){e&&u.default.logAction(u.default.LOG_ERROR,"RealtimeChannel.setOptions()","Set options failed: "+e.toString())},n=v(e);n?r(n):(c.default.prototype.setOptions.call(this,e),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(e)?(this.attachImpl(),this._allChannelChanges.once(["attached","update","detached","failed"],(function(e){switch(this.event){case"update":case"attached":return void(null==r||r(null));default:return void(null==r||r(e.reason))}}))):r())},t.prototype._shouldReattachToSetOptions=function(e){if("attached"!==this.state&&"attaching"!==this.state)return!1;if(null==e?void 0:e.params){var t=Object.assign({},e.params);if(delete t.agent,0!==Object.keys(t).length&&!this.params)return!0;if(this.params&&!s.shallowEquals(this.params,t))return!0}return!(!(null==e?void 0:e.modes)||this.modes&&s.arrEquals(e.modes,this.modes))},t.prototype.publish=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],o=t.length,i=t[o-1];if("function"!=typeof i){if(this.realtime.options.promises)return s.promisify(this,"publish",arguments);i=g,++o}if(this.connectionManager.activeState()){if(2==o)if(s.isObject(n))n=[f.default.fromValues(n)];else{if(!s.isArray(n))throw new h.default("The single-argument form of publish() expects a message object or an array of message objects",40013,400);n=f.default.fromValuesArray(n)}else n=[f.default.fromValues({name:t[0],data:t[1]})];var a=this.realtime.options.maxMessageSize;f.default.encodeArray(n,this.channelOptions,(function(t){if(t)i(t);else{var r=f.default.getMessagesSize(n);r>a?i(new h.default("Maximum size of messages that can be published at once exceeded ( was "+r+" bytes; limit is "+a+" bytes)",40009,400)):e.__publish(n,i)}}))}else i(this.connectionManager.getError())},t.prototype.__publish=function(e,t){u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.publish()","message count = "+e.length);var r=this.state;switch(r){case"failed":case"suspended":t(h.default.fromValues(this.invalidStateError()));break;default:u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+r);var n=new i.default;n.action=y.MESSAGE,n.channel=this.name,n.messages=e,this.sendMessage(n,t)}},t.prototype.onEvent=function(e){u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.onEvent()","received message");for(var t=this.subscriptions,r=0;r<e.length;r++){var n=e[r];t.emit(n.name,n)}},t.prototype.attach=function(e,t){var r;if("function"==typeof e?(t=e,r=null):r=e,!t){if(this.realtime.options.promises)return s.promisify(this,"attach",arguments);t=function(e){e&&u.default.logAction(u.default.LOG_MAJOR,"RealtimeChannel.attach()","Channel attach failed: "+e.toString())}}if(r)u.default.deprecated("channel.attach() with flags","channel.setOptions() with channelOptions.params"),this._requestedFlags=r;else if("attached"===this.state)return void t(null,null);this._attach(!1,null,t)},t.prototype._attach=function(e,t,r){r||(r=function(e){e&&u.default.logAction(u.default.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+e.toString())});var n=this.connectionManager;n.activeState()?(("attaching"!==this.state||e)&&this.requestState("attaching",t),this.once((function(e){switch(this.event){case"attached":null==r||r(null,e);break;case"detached":case"suspended":case"failed":null==r||r(e.reason||n.getError()||new h.default("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":null==r||r(new h.default("Attach request superseded by a subsequent detach request",9e4,409))}}))):r(n.getError())},t.prototype.attachImpl=function(){u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");var e=i.default.fromValues({action:y.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this._requestedFlags?e.encodeModesToFlags(this._requestedFlags):this.channelOptions.modes&&e.encodeModesToFlags(s.allToUpperCase(this.channelOptions.modes)),this._attachResume&&e.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(e.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(e,g)},t.prototype.detach=function(e){if(!e){if(this.realtime.options.promises)return s.promisify(this,"detach",arguments);e=g}var t=this.connectionManager;if(t.activeState())switch(this.state){case"suspended":this.notifyState("detached"),e();break;case"detached":e();break;case"failed":e(new h.default("Unable to detach; channel state = failed",90001,400));break;default:this.requestState("detaching");case"detaching":this.once((function(r){switch(this.event){case"detached":e();break;case"attached":case"suspended":case"failed":e(r.reason||t.getError()||new h.default("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":e(new h.default("Detach request superseded by a subsequent attach request",9e4,409))}}))}else e(t.getError())},t.prototype.detachImpl=function(e){u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");var t=i.default.fromValues({action:y.DETACH,channel:this.name});this.sendMessage(t,e||g)},t.prototype.subscribe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.processListenerArgs(e),i=o[0],a=o[1],c=o[2];return!c&&this.realtime.options.promises?s.promisify(this,"subscribe",[i,a]):"failed"!==this.state?(i&&"object"===n(i)&&!Array.isArray(i)?this._subscribeFilter(i,a):this.subscriptions.on(i,a),this.attach(c||g)):void(null==c||c(h.default.fromValues(this.invalidStateError())))},t.prototype._subscribeFilter=function(e,t){var r=function(r){var n,o,i,a,s,c,u={name:r.name,refTimeserial:null===(o=null===(n=r.extras)||void 0===n?void 0:n.ref)||void 0===o?void 0:o.timeserial,refType:null===(a=null===(i=r.extras)||void 0===i?void 0:i.ref)||void 0===a?void 0:a.type,isRef:!!(null===(c=null===(s=r.extras)||void 0===s?void 0:s.ref)||void 0===c?void 0:c.timeserial),clientId:r.clientId};Object.entries(e).find((function(e){var t=e[0],r=e[1];return void 0!==r&&u[t]!==r}))||t(r)};this._addFilteredSubscription(e,t,r),this.subscriptions.on(r)},t.prototype._addFilteredSubscription=function(e,t,r){var n;if(this.filteredSubscriptions||(this.filteredSubscriptions=new Map),this.filteredSubscriptions.has(t)){var o=this.filteredSubscriptions.get(t);o.set(e,(null===(n=null==o?void 0:o.get(e))||void 0===n?void 0:n.concat(r))||[r])}else this.filteredSubscriptions.set(t,new Map([[e,[r]]]))},t.prototype._getAndDeleteFilteredSubscriptions=function(e,t){var r=this;if(!this.filteredSubscriptions)return[];if(!t&&e)return Array.from(this.filteredSubscriptions.entries()).map((function(t){var n,o=t[0],i=t[1],a=i.get(e);return i.delete(e),0===i.size&&(null===(n=r.filteredSubscriptions)||void 0===n||n.delete(o)),a})).reduce((function(e,t){var r;return t?(r=e).concat.apply(r,t):e}),[]);if(!t||!this.filteredSubscriptions.has(t))return[];var n=this.filteredSubscriptions.get(t);if(!e){var o=Array.from(n.values()).reduce((function(e,t){return e.concat.apply(e,t)}),[]);return this.filteredSubscriptions.delete(t),o}var i=n.get(e);return n.delete(e),i||[]},t.prototype.unsubscribe=function(){for(var e,r=this,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var a=t.processListenerArgs(o),s=a[0],c=a[1];"object"===n(s)&&!c||(null===(e=this.filteredSubscriptions)||void 0===e?void 0:e.has(c))?this._getAndDeleteFilteredSubscriptions(s,c).forEach((function(e){return r.subscriptions.off(e)})):this.subscriptions.off(s,c)},t.prototype.sync=function(){switch(this.state){case"initialized":case"detaching":case"detached":throw new h.PartialErrorInfo("Unable to sync to channel; not attached",4e4)}var e=this.connectionManager;if(!e.activeState())throw e.getError();var t=i.default.fromValues({action:y.SYNC,channel:this.name});this.syncChannelSerial&&(t.channelSerial=this.syncChannelSerial),e.send(t)},t.prototype.sendMessage=function(e,t){this.connectionManager.send(e,this.realtime.options.queueMessages,t)},t.prototype.sendPresence=function(e,t){var r=i.default.fromValues({action:y.PRESENCE,channel:this.name,presence:s.isArray(e)?p.default.fromValuesArray(e):[p.default.fromValues(e)]});this.sendMessage(r,t)},t.prototype.onMessage=function(e){e.action!==y.ATTACHED&&e.action!==y.MESSAGE&&e.action!==y.PRESENCE||this.setChannelSerial(e.channelSerial);var t,r=!1;switch(e.action){case y.ATTACHED:this.properties.attachSerial=e.channelSerial,this._mode=e.getMode(),this.params=e.params||{};var n=e.decodeModesFromFlags();this.modes=n&&s.allToLowerCase(n)||void 0;var o=e.hasFlag("RESUMED"),i=e.hasFlag("HAS_PRESENCE"),a=e.hasFlag("HAS_BACKLOG");if("attached"===this.state){o||this.presence.onAttached(i);var c=new d.default(this.state,this.state,o,a,e.error);this._allChannelChanges.emit("update",c),o&&!this.channelOptions.updateOnAttached||this.emit("update",c)}else"detaching"===this.state?this.checkPendingState():this.notifyState("attached",e.error,o,i,a);break;case y.DETACHED:var l=e.error?h.default.fromValues(e.error):new h.default("Channel detached",90001,404);"detaching"===this.state?this.notifyState("detached",l):"attaching"===this.state?this.notifyState("suspended",l):this.requestState("attaching",l);break;case y.SYNC:if(r=!0,t=this.syncChannelSerial=e.channelSerial,!e.presence)break;case y.PRESENCE:for(var g=e.presence,v=e.id,b=e.connectionId,w=e.timestamp,_=this.channelOptions,O=void 0,S=0;S<g.length;S++)try{O=g[S],p.default.decode(O,_),O.connectionId||(O.connectionId=b),O.timestamp||(O.timestamp=w),O.id||(O.id=v+":"+S)}catch(e){u.default.logAction(u.default.LOG_ERROR,"RealtimeChannel.onMessage()",e.toString())}this.presence.setPresence(g,r,t);break;case y.MESSAGE:if("attached"!==this.state)return void u.default.logAction(u.default.LOG_MAJOR,"RealtimeChannel.onMessage()",'Message "'+e.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');var E=e.messages,k=E[0],C=E[E.length-1];if(v=e.id,b=e.connectionId,w=e.timestamp,k.extras&&k.extras.delta&&k.extras.delta.from!==this._lastPayload.messageId){var A='Delta message decode failure - previous message not available for message "'+e.id+'" on this channel "'+this.name+'".';u.default.logAction(u.default.LOG_ERROR,"RealtimeChannel.onMessage()",A),this._startDecodeFailureRecovery(new h.default(A,40018,400));break}for(S=0;S<E.length;S++){A=E[S];try{f.default.decode(A,this._decodingContext)}catch(e){switch(u.default.logAction(u.default.LOG_ERROR,"RealtimeChannel.onMessage()",e.toString()),e.code){case 40018:return void this._startDecodeFailureRecovery(e);case 40019:case 40021:return void this.notifyState("failed",e)}}A.connectionId||(A.connectionId=b),A.timestamp||(A.timestamp=w),A.id||(A.id=v+":"+S)}this._lastPayload.messageId=C.id,this._lastPayload.protocolMessageChannelSerial=e.channelSerial,this.onEvent(E);break;case y.ERROR:var x=e.error;x&&80016==x.code?this.checkPendingState():this.notifyState("failed",h.default.fromValues(x));break;default:u.default.logAction(u.default.LOG_ERROR,"RealtimeChannel.onMessage()","Fatal protocol error: unrecognised action ("+e.action+")"),this.connectionManager.abort(m.default.unknownChannelErr())}},t.prototype._startDecodeFailureRecovery=function(e){var t=this;this._lastPayload.decodeFailureRecoveryInProgress||(u.default.logAction(u.default.LOG_MAJOR,"RealtimeChannel.onMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,e,(function(){t._lastPayload.decodeFailureRecoveryInProgress=!1})))},t.prototype.onAttached=function(){u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)},t.prototype.notifyState=function(e,t,r,n,o){if(u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+e),this.clearStateTimer(),s.arrIn(["detached","suspended","failed"],e)&&(this.properties.channelSerial=null),e!==this.state){this.presence.actOnChannelState(e,n,t),"suspended"===e&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),t&&(this.errorReason=t);var i=new d.default(this.state,e,r,o,t),a="failed"===e?u.default.LOG_ERROR:u.default.LOG_MAJOR;u.default.logAction(a,'Channel state for channel "'+this.name+'"',e+(t?"; reason: "+t:"")),"attaching"!==e&&"suspended"!==e&&(this.retryCount=0),"attached"===e&&this.onAttached(),"attached"===e?this._attachResume=!0:"detaching"!==e&&"failed"!==e||(this._attachResume=!1),this.state=e,this._allChannelChanges.emit(e,i),this.emit(e,i)}},t.prototype.requestState=function(e,t){u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+e),this.notifyState(e,t),this.checkPendingState()},t.prototype.checkPendingState=function(){var e=this.connectionManager.state;if(e.sendEvents||e.forceQueueEvents)switch(u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync()}else u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state)},t.prototype.timeoutPendingState=function(){switch(this.state){case"attaching":var e=new h.default("Channel attach timed out",90007,408);this.notifyState("suspended",e);break;case"detaching":e=new h.default("Channel detach timed out",90007,408),this.notifyState("attached",e);break;default:this.checkPendingState()}},t.prototype.startStateTimerIfNotRunning=function(){var e=this;this.stateTimer||(this.stateTimer=setTimeout((function(){u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),e.stateTimer=null,e.timeoutPendingState()}),this.realtime.options.timeouts.realtimeRequestTimeout))},t.prototype.clearStateTimer=function(){var e=this.stateTimer;e&&(clearTimeout(e),this.stateTimer=null)},t.prototype.startRetryTimer=function(){var e=this;if(!this.retryTimer){this.retryCount++;var t=s.getRetryTime(this.realtime.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout((function(){"suspended"===e.state&&e.connectionManager.state.sendEvents&&(e.retryTimer=null,u.default.logAction(u.default.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),e.requestState("attaching"))}),t)}},t.prototype.cancelRetryTimer=function(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)},t.prototype.getReleaseErr=function(){var e=this.state;return"initialized"===e||"detached"===e||"failed"===e?null:new h.default("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+e,90001,400)},t.prototype.setChannelSerial=function(e){u.default.logAction(u.default.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+e+"; previous = "+this.properties.channelSerial),e&&(this.properties.channelSerial=e)},t}(c.default);t.default=b},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,r,n,o){this.previous=e,this.current=t,"attached"===t&&(this.resumed=r,this.hasBacklog=n),o&&(this.reason=o)};t.default=n},function(e,t,r){var n,o,i,a,s,c,u,l;e.exports=(l=r(6),o=(n=l).lib,i=o.WordArray,a=o.Hasher,s=n.algo,c=[],u=s.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],o=r[1],i=r[2],a=r[3],s=r[4],u=0;u<80;u++){if(u<16)c[u]=0|e[t+u];else{var l=c[u-3]^c[u-8]^c[u-14]^c[u-16];c[u]=l<<1|l>>>31}var f=(n<<5|n>>>27)+s+c[u];f+=u<20?1518500249+(o&i|~o&a):u<40?1859775393+(o^i^a):u<60?(o&i|o&a|i&a)-1894007588:(o^i^a)-899497514,s=a,a=i,i=o<<30|o>>>2,o=n,n=f}r[0]=r[0]+n|0,r[1]=r[1]+o|0,r[2]=r[2]+i|0,r[3]=r[3]+a|0,r[4]=r[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),n.SHA1=a._createHelper(u),n.HmacSHA1=a._createHmacHelper(u),l.SHA1)},function(e,t,r){function o(e,t,r){for(var n=0,o=r.length;n<o;n++){var i=r.charCodeAt(n);if(i<128)e.setUint8(t++,i>>>0&127|0);else if(i<2048)e.setUint8(t++,i>>>6&31|192),e.setUint8(t++,i>>>0&63|128);else if(i<65536)e.setUint8(t++,i>>>12&15|224),e.setUint8(t++,i>>>6&63|128),e.setUint8(t++,i>>>0&63|128);else{if(!(i<1114112))throw new Error("bad codepoint "+i);e.setUint8(t++,i>>>18&7|240),e.setUint8(t++,i>>>12&63|128),e.setUint8(t++,i>>>6&63|128),e.setUint8(t++,i>>>0&63|128)}}}function i(e,t,r){for(var n="",o=t,i=t+r;o<i;o++){var a=e.getUint8(o);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));n+=String.fromCharCode((7&a)<<18|(63&e.getUint8(++o))<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0)}else n+=String.fromCharCode((15&a)<<12|(63&e.getUint8(++o))<<6|(63&e.getUint8(++o))<<0);else n+=String.fromCharCode((15&a)<<6|63&e.getUint8(++o));else n+=String.fromCharCode(a)}return n}function a(e){for(var t=0,r=0,n=e.length;r<n;r++){var o=e.charCodeAt(r);if(o<128)t+=1;else if(o<2048)t+=2;else if(o<65536)t+=3;else{if(!(o<1114112))throw new Error("bad codepoint "+o);t+=4}}return t}Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){var r=this;this.map=function(e){for(var t={},n=0;n<e;n++)t[r.parse()]=r.parse();return t},this.bin=function(e){var t=new ArrayBuffer(e);return new Uint8Array(t).set(new Uint8Array(r.view.buffer,r.offset,e),0),r.offset+=e,t},this.buf=this.bin,this.str=function(e){var t=i(r.view,r.offset,e);return r.offset+=e,t},this.array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=r.parse();return t},this.ext=function(e){return r.offset+=e,{type:r.view.getInt8(r.offset),data:r.buf(e)}},this.parse=function(){var e,t,n=r.view.getUint8(r.offset);if(0==(128&n))return r.offset++,n;if(128==(240&n))return t=15&n,r.offset++,r.map(t);if(144==(240&n))return t=15&n,r.offset++,r.array(t);if(160==(224&n))return t=31&n,r.offset++,r.str(t);if(224==(224&n))return e=r.view.getInt8(r.offset),r.offset++,e;switch(n){case 192:return r.offset++,null;case 193:return void r.offset++;case 194:return r.offset++,!1;case 195:return r.offset++,!0;case 196:return t=r.view.getUint8(r.offset+1),r.offset+=2,r.bin(t);case 197:return t=r.view.getUint16(r.offset+1),r.offset+=3,r.bin(t);case 198:return t=r.view.getUint32(r.offset+1),r.offset+=5,r.bin(t);case 199:return t=r.view.getUint8(r.offset+1),r.offset+=2,r.ext(t);case 200:return t=r.view.getUint16(r.offset+1),r.offset+=3,r.ext(t);case 201:return t=r.view.getUint32(r.offset+1),r.offset+=5,r.ext(t);case 202:return e=r.view.getFloat32(r.offset+1),r.offset+=5,e;case 203:return e=r.view.getFloat64(r.offset+1),r.offset+=9,e;case 204:return e=r.view.getUint8(r.offset+1),r.offset+=2,e;case 205:return e=r.view.getUint16(r.offset+1),r.offset+=3,e;case 206:return e=r.view.getUint32(r.offset+1),r.offset+=5,e;case 207:return e=function(e,t){return t=t||0,4294967296*e.getUint32(t)+e.getUint32(t+4)}(r.view,r.offset+1),r.offset+=9,e;case 208:return e=r.view.getInt8(r.offset+1),r.offset+=2,e;case 209:return e=r.view.getInt16(r.offset+1),r.offset+=3,e;case 210:return e=r.view.getInt32(r.offset+1),r.offset+=5,e;case 211:return e=function(e,t){return t=t||0,4294967296*e.getInt32(t)+e.getUint32(t+4)}(r.view,r.offset+1),r.offset+=9,e;case 212:return t=1,r.offset++,r.ext(t);case 213:return t=2,r.offset++,r.ext(t);case 214:return t=4,r.offset++,r.ext(t);case 215:return t=8,r.offset++,r.ext(t);case 216:return t=16,r.offset++,r.ext(t);case 217:return t=r.view.getUint8(r.offset+1),r.offset+=2,r.str(t);case 218:return t=r.view.getUint16(r.offset+1),r.offset+=3,r.str(t);case 219:return t=r.view.getUint32(r.offset+1),r.offset+=5,r.str(t);case 220:return t=r.view.getUint16(r.offset+1),r.offset+=3,r.array(t);case 221:return t=r.view.getUint32(r.offset+1),r.offset+=5,r.array(t);case 222:return t=r.view.getUint16(r.offset+1),r.offset+=3,r.map(t);case 223:return t=r.view.getUint32(r.offset+1),r.offset+=5,r.map(t)}throw new Error("Unknown type 0x"+n.toString(16))},this.offset=t||0,this.view=e};function c(e,t){return Object.keys(e).filter((function(r){var o=e[r],i=n(o);return!(t&&null==o||"function"===i&&!o.toJSON)}))}t.default={encode:function(e,t){var r=function e(t,r){var o=n(t);if("string"===o){var i=a(t);if(i<32)return 1+i;if(i<256)return 2+i;if(i<65536)return 3+i;if(i<4294967296)return 5+i}if(ArrayBuffer.isView&&ArrayBuffer.isView(t)&&(t=t.buffer),t instanceof ArrayBuffer){var s=t.byteLength;if(s<256)return 2+s;if(s<65536)return 3+s;if(s<4294967296)return 5+s}if("number"==typeof t){if(Math.floor(t)!==t)return 9;if(t>=0){if(t<128)return 1;if(t<256)return 2;if(t<65536)return 3;if(t<4294967296)return 5;if(t<0x10000000000000000)return 9;throw new Error("Number too big 0x"+t.toString(16))}if(t>=-32)return 1;if(t>=-128)return 2;if(t>=-32768)return 3;if(t>=-2147483648)return 5;if(t>=-0x8000000000000000)return 9;throw new Error("Number too small -0x"+t.toString(16).substr(1))}if("boolean"===o)return 1;if(null===t)return r?0:1;if(void 0===t)return r?0:3;if("function"==typeof t.toJSON)return e(t.toJSON(),r);if("object"===o){var u,l=0;if(Array.isArray(t)){u=t.length;for(var f=0;f<u;f++)l+=e(t[f],r)}else{var d=c(t,r);for(u=d.length,f=0;f<u;f++){var h=d[f];l+=e(h)+e(t[h],r)}}if(u<16)return 1+l;if(u<65536)return 3+l;if(u<4294967296)return 5+l;throw new Error("Array or object too long 0x"+u.toString(16))}if("function"===o)return 0;throw new Error("Unknown type "+o)}(e,t);if(0!==r){var i=new ArrayBuffer(r);return function e(t,r,i,s){var u=n(t);if("string"==typeof t){var l=a(t);if(l<32)return r.setUint8(i,160|l),o(r,i+1,t),1+l;if(l<256)return r.setUint8(i,217),r.setUint8(i+1,l),o(r,i+2,t),2+l;if(l<65536)return r.setUint8(i,218),r.setUint16(i+1,l),o(r,i+3,t),3+l;if(l<4294967296)return r.setUint8(i,219),r.setUint32(i+1,l),o(r,i+5,t),5+l}if(ArrayBuffer.isView&&ArrayBuffer.isView(t)&&(t=t.buffer),t instanceof ArrayBuffer){var f=t.byteLength;if(f<256)return r.setUint8(i,196),r.setUint8(i+1,f),new Uint8Array(r.buffer).set(new Uint8Array(t),i+2),2+f;if(f<65536)return r.setUint8(i,197),r.setUint16(i+1,f),new Uint8Array(r.buffer).set(new Uint8Array(t),i+3),3+f;if(f<4294967296)return r.setUint8(i,198),r.setUint32(i+1,f),new Uint8Array(r.buffer).set(new Uint8Array(t),i+5),5+f}if("number"==typeof t){if(Math.floor(t)!==t)return r.setUint8(i,203),r.setFloat64(i+1,t),9;if(t>=0){if(t<128)return r.setUint8(i,t),1;if(t<256)return r.setUint8(i,204),r.setUint8(i+1,t),2;if(t<65536)return r.setUint8(i,205),r.setUint16(i+1,t),3;if(t<4294967296)return r.setUint8(i,206),r.setUint32(i+1,t),5;if(t<0x10000000000000000)return r.setUint8(i,207),function(e,t,r){r<0x10000000000000000?(e.setUint32(t,Math.floor(2.3283064365386963e-10*r)),e.setInt32(t+4,-1&r)):(e.setUint32(t,4294967295),e.setUint32(t+4,4294967295))}(r,i+1,t),9;throw new Error("Number too big 0x"+t.toString(16))}if(t>=-32)return r.setInt8(i,t),1;if(t>=-128)return r.setUint8(i,208),r.setInt8(i+1,t),2;if(t>=-32768)return r.setUint8(i,209),r.setInt16(i+1,t),3;if(t>=-2147483648)return r.setUint8(i,210),r.setInt32(i+1,t),5;if(t>=-0x8000000000000000)return r.setUint8(i,211),function(e,t,r){r<0x8000000000000000?(e.setInt32(t,Math.floor(2.3283064365386963e-10*r)),e.setInt32(t+4,-1&r)):(e.setUint32(t,2147483647),e.setUint32(t+4,2147483647))}(r,i+1,t),9;throw new Error("Number too small -0x"+(-t).toString(16).substr(1))}if("undefined"===u)return s?0:(r.setUint8(i,212),r.setUint8(i+1,0),r.setUint8(i+2,0),3);if(null===t)return s?0:(r.setUint8(i,192),1);if("boolean"===u)return r.setUint8(i,t?195:194),1;if("function"==typeof t.toJSON)return e(t.toJSON(),r,i,s);if("object"===u){var d,h=0,p=void 0,m=Array.isArray(t);if(m?d=t.length:(p=c(t,s),d=p.length),d<16?(r.setUint8(i,d|(m?144:128)),h=1):d<65536?(r.setUint8(i,m?220:222),r.setUint16(i+1,d),h=3):d<4294967296&&(r.setUint8(i,m?221:223),r.setUint32(i+1,d),h=5),m)for(var y=0;y<d;y++)h+=e(t[y],r,i+h,s);else if(p)for(y=0;y<d;y++){var g=p[y];h+=e(g,r,i+h),h+=e(t[g],r,i+h,s)}return h}if("function"===u)return 0;throw new Error("Unknown type "+u)}(e,new DataView(i),0,t),i}},decode:function(e){var t=new DataView(e),r=new s(t),n=r.parse();if(r.offset!==e.byteLength)throw new Error(e.byteLength-r.offset+" trailing bytes");return n},inspect:function(e){if(void 0===e)return"undefined";var t,r;if(e instanceof ArrayBuffer?(r="ArrayBuffer",t=new DataView(e)):e instanceof DataView&&(r="DataView",t=e),!t)return JSON.stringify(e);for(var n=[],o=0;o<e.byteLength;o++){if(o>20){n.push("...");break}var i=t.getUint8(o).toString(16);1===i.length&&(i="0"+i),n.push(i)}return"<"+r+" "+n.join(" ")+">"},utf8Write:o,utf8Read:i,utf8ByteCount:a}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(30)),i=n.__importDefault(r(50)),a=n.__importDefault(r(3)),s=n.__importDefault(r(4)),c=n.__importDefault(r(55)),u=n.__importDefault(r(57)),l=n.__importDefault(r(62)),f=n.__importDefault(r(64)),d=n.__importDefault(r(68)),h=n.__importDefault(r(2)),p=r(8),m=n.__importDefault(r(65)),y=n.__importDefault(r(66)),g=n.__importDefault(r(41)),v=(0,u.default)(f.default,c.default);a.default.Crypto=v,a.default.BufferUtils=c.default,a.default.Http=l.default,a.default.Config=f.default,a.default.Transports=d.default,a.default.WebStorage=m.default,o.default.Crypto=v,i.default.Crypto=v,h.default.initLogHandlers(),a.default.Defaults=(0,p.getDefaults)(y.default),a.default.Config.agent&&(a.default.Defaults.agent+=" "+a.default.Config.agent),a.default.Config.noUpgrade&&(a.default.Defaults.upgradeTransports=[]),t.default={ErrorInfo:s.default,Rest:o.default,Realtime:i.default,msgpack:g.default}},function(e){e.exports=JSON.parse('{"name":"ably","description":"Realtime client library for Ably, the realtime messaging service","version":"1.2.48","license":"Apache-2.0","bugs":{"url":"https://github.com/ably/ably-js/issues","email":"support@ably.com"},"main":"./build/ably-node.js","typings":"./ably.d.ts","react-native":{"./build/ably-node.js":"./build/ably-reactnative.js"},"browser":{"./build/ably-node.js":"./build/ably-commonjs.js"},"files":["build/**","ably.d.ts","callbacks.d.ts","callbacks.js","promises.d.ts","promises.js","resources/**","src/**","react/**"],"dependencies":{"@ably/msgpack-js":"^0.4.0","got":"^11.8.5","ws":"^8.14.2"},"peerDependencies":{"react":">=16.8.0","react-dom":">=16.8.0"},"peerDependenciesMeta":{"react":{"optional":true},"react-dom":{"optional":true}},"devDependencies":{"@ably/vcdiff-decoder":"1.0.4","@testing-library/react":"^13.3.0","@types/crypto-js":"^4.0.1","@types/jmespath":"^0.15.2","@types/node":"^15.0.0","@types/request":"^2.48.7","@types/ws":"^8.2.0","@typescript-eslint/eslint-plugin":"^5.14.0","@typescript-eslint/parser":"^5.14.0","@vitejs/plugin-react":"^1.3.2","async":"ably-forks/async#requirejs","aws-sdk":"^2.1413.0","chai":"^4.2.0","copy-webpack-plugin":"^6.4.1","cors":"^2.8.5","crypto-js":"ably-forks/crypto-js#crypto-lite","eslint":"^7.13.0","eslint-plugin-import":"^2.28.0","eslint-plugin-jsdoc":"^40.0.0","eslint-plugin-react":"^7.32.2","eslint-plugin-react-hooks":"^4.6.0","eslint-plugin-security":"^1.4.0","express":"^4.17.1","glob":"~4.4","google-closure-compiler":"^20180610.0.1","grunt":"^1.6.1","grunt-bump":"^0.3.1","grunt-cli":"~1.2.0","grunt-closure-tools":"^1.0.0","grunt-contrib-concat":"~0.5","grunt-shell":"~1.1","grunt-webpack":"^4.0.2","hexy":"~0.2","jmespath":"^0.16.0","jsdom":"^20.0.0","kexec":"ably-forks/node-kexec#update-for-node-12","minimist":"^1.2.5","mocha":"^8.1.3","null-loader":"^4.0.1","playwright":"^1.39.0","prettier":"^2.5.1","react":">=18.1.0","react-dom":">=18.1.0","requirejs":"~2.1","shelljs":"~0.8","source-map-explorer":"^2.5.2","ts-loader":"^8.2.0","tsconfig-paths-webpack-plugin":"^4.0.1","tslib":"^2.3.1","typedoc":"^0.23.8","typescript":"^4.6.4","vite":"^4.4.9","vitest":"^0.18.0","webpack":"^4.44.2","webpack-cli":"^4.2.0"},"engines":{"node":">=5.10.x"},"repository":"ably/ably-js","jspm":{"registry":"npm","directories":{"lib":"build"},"main":"ably"},"scripts":{"start:react":"npx vite serve","grunt":"grunt","test":"grunt test","test:node":"grunt test:node","test:node:skip-build":"grunt mocha","test:webserver":"grunt test:webserver","test:playwright":"node test/support/runPlaywrightTests.js","test:react":"vitest run","concat":"grunt concat","build":"grunt build:all && npm run build:react","build:node":"grunt build:node","build:browser":"grunt build:browser","build:react":"npm run build:react:mjs && npm run build:react:cjs && cp src/platform/react-hooks/res/package.react.json react/package.json","build:react:mjs":"tsc --project src/platform/react-hooks/tsconfig.mjs.json && cp src/platform/react-hooks/res/package.mjs.json react/mjs/package.json","build:react:cjs":"tsc --project src/platform/react-hooks/tsconfig.cjs.json && cp src/platform/react-hooks/res/package.cjs.json react/cjs/package.json","requirejs":"grunt requirejs","lint":"eslint .","lint:fix":"eslint --fix .","check-closure-compiler":"grunt check-closure-compiler","prepare":"npm run build","format":"prettier --write --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js docs/chrome-mv3.md","format:check":"prettier --check --ignore-path .gitignore --ignore-path .prettierignore src test ably.d.ts webpack.config.js Gruntfile.js scripts/cdn_deploy.js","sourcemap":"source-map-explorer build/ably.min.js","sourcemap:noencryption":"source-map-explorer build/ably.noencryption.min.js","docs":"typedoc --entryPoints ably.d.ts --out docs/generated/default --readme docs/landing-pages/default.md && typedoc --entryPoints promises.d.ts --out docs/generated/promises --name \\"ably (Promise-based)\\" --readme docs/landing-pages/promises.md && cp docs/landing-pages/choose-library.html docs/generated/index.html"}}')},function(e,t){},function(e,t,r){var n;e.exports=(n=r(6),r(32),r(24),n.HmacSHA256)},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(47)),a=n.__importDefault(r(14)),s=n.__importDefault(r(19)),c=n.__importDefault(r(4)),u=n.__importDefault(r(48)),l=function(){},f=function(e){this.rest=e,this.admin=new d(e)},d=function(){function e(e){this.rest=e,this.deviceRegistrations=new h(e),this.channelSubscriptions=new p(e)}return e.prototype.publish=function(e,t,r){var n=this.rest,i=n.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,s=o.defaultPostHeaders(n.options,i),c={},u=o.mixin({recipient:e},t);if("function"!=typeof r){if(this.rest.options.promises)return o.promisify(this,"publish",arguments);r=l}n.options.headers&&o.mixin(s,n.options.headers),n.options.pushFullWait&&o.mixin(c,{fullWait:"true"});var f=o.encodeBody(u,i);a.default.post(n,"/push/publish",f,s,c,null,(function(e){return r(e)}))},e}(),h=function(){function e(e){this.rest=e}return e.prototype.save=function(e,t){var r=this.rest,n=i.default.fromValues(e),s=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,c=o.defaultPostHeaders(r.options,s),u={};if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"save",arguments);t=l}r.options.headers&&o.mixin(c,r.options.headers),r.options.pushFullWait&&o.mixin(u,{fullWait:"true"});var f=o.encodeBody(n,s);a.default.put(r,"/push/deviceRegistrations/"+encodeURIComponent(e.id),f,c,u,null,(function(e,r,n,o){t(e,e?void 0:i.default.fromResponseBody(r,o?void 0:s))}))},e.prototype.get=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,s=o.defaultGetHeaders(r.options,n),u=e.id||e;if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"get",arguments);t=l}"string"==typeof u&&u.length?(r.options.headers&&o.mixin(s,r.options.headers),a.default.get(r,"/push/deviceRegistrations/"+encodeURIComponent(u),s,{},null,(function(e,r,o,a){t(e,e?void 0:i.default.fromResponseBody(r,a?void 0:n))}))):t(new c.default("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400))},e.prototype.list=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,a=this.rest.http.supportsLinkHeaders?void 0:n,c=o.defaultGetHeaders(r.options,n);if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"list",arguments);t=l}r.options.headers&&o.mixin(c,r.options.headers),new s.default(r,"/push/deviceRegistrations",c,a,(function(e,t,r){return i.default.fromResponseBody(e,r?void 0:n)})).get(e,t)},e.prototype.remove=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=o.defaultGetHeaders(r.options,n),s={},u=e.id||e;if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"remove",arguments);t=l}"string"==typeof u&&u.length?(r.options.headers&&o.mixin(i,r.options.headers),r.options.pushFullWait&&o.mixin(s,{fullWait:"true"}),a.default.delete(r,"/push/deviceRegistrations/"+encodeURIComponent(u),i,s,null,(function(e){return t(e)}))):t(new c.default("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400))},e.prototype.removeWhere=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=o.defaultGetHeaders(r.options,n);if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"removeWhere",arguments);t=l}r.options.headers&&o.mixin(i,r.options.headers),r.options.pushFullWait&&o.mixin(e,{fullWait:"true"}),a.default.delete(r,"/push/deviceRegistrations",i,e,null,(function(e){return t(e)}))},e}(),p=function(){function e(t){this.remove=e.prototype.removeWhere,this.rest=t}return e.prototype.save=function(e,t){var r=this.rest,n=u.default.fromValues(e),i=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,s=o.defaultPostHeaders(r.options,i),c={};if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"save",arguments);t=l}r.options.headers&&o.mixin(s,r.options.headers),r.options.pushFullWait&&o.mixin(c,{fullWait:"true"});var f=o.encodeBody(n,i);a.default.post(r,"/push/channelSubscriptions",f,s,c,null,(function(e,r,n,o){t(e,!e&&u.default.fromResponseBody(r,o?void 0:i))}))},e.prototype.list=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=this.rest.http.supportsLinkHeaders?void 0:n,a=o.defaultGetHeaders(r.options,n);if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"list",arguments);t=l}r.options.headers&&o.mixin(a,r.options.headers),new s.default(r,"/push/channelSubscriptions",a,i,(function(e,t,r){return u.default.fromResponseBody(e,r?void 0:n)})).get(e,t)},e.prototype.removeWhere=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=o.defaultGetHeaders(r.options,n);if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"removeWhere",arguments);t=l}r.options.headers&&o.mixin(i,r.options.headers),r.options.pushFullWait&&o.mixin(e,{fullWait:"true"}),a.default.delete(r,"/push/channelSubscriptions",i,e,null,(function(e){return t(e)}))},e.prototype.listChannels=function(e,t){var r=this.rest,n=r.options.useBinaryProtocol?o.Format.msgpack:o.Format.json,i=this.rest.http.supportsLinkHeaders?void 0:n,a=o.defaultGetHeaders(r.options,n);if("function"!=typeof t){if(this.rest.options.promises)return o.promisify(this,"listChannels",arguments);t=l}r.options.headers&&o.mixin(a,r.options.headers),r.options.pushFullWait&&o.mixin(e,{fullWait:"true"}),new s.default(r,"/push/channels",a,i,(function(e,t,r){for(var i=!r&&n?o.decodeBody(e,n):e,a=0;a<i.length;a++)i[a]=String(i[a]);return i})).get(e,t)},e}();t.default=f},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,o,i=r(0),a=i.__importStar(r(1)),s=i.__importDefault(r(4));!function(e){e.Phone="phone",e.Tablet="tablet",e.Desktop="desktop",e.TV="tv",e.Watch="watch",e.Car="car",e.Embedded="embedded",e.Other="other"}(n||(n={})),function(e){e.Android="android",e.IOS="ios",e.Browser="browser"}(o||(o={}));var c=function(){function e(){}return e.prototype.toJSON=function(){var e,t,r;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:null===(e=this.push)||void 0===e?void 0:e.recipient,state:null===(t=this.push)||void 0===t?void 0:t.state,error:null===(r=this.push)||void 0===r?void 0:r.error}}},e.prototype.toString=function(){var e,t,r,n,o="[DeviceDetails";return this.id&&(o+="; id="+this.id),this.platform&&(o+="; platform="+this.platform),this.formFactor&&(o+="; formFactor="+this.formFactor),this.clientId&&(o+="; clientId="+this.clientId),this.metadata&&(o+="; metadata="+this.metadata),this.deviceIdentityToken&&(o+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(null===(e=this.push)||void 0===e?void 0:e.recipient)&&(o+="; push.recipient="+JSON.stringify(this.push.recipient)),(null===(t=this.push)||void 0===t?void 0:t.state)&&(o+="; push.state="+this.push.state),(null===(r=this.push)||void 0===r?void 0:r.error)&&(o+="; push.error="+JSON.stringify(this.push.error)),(null===(n=this.push)||void 0===n?void 0:n.metadata)&&(o+="; push.metadata="+this.push.metadata),o+="]"},e.fromResponseBody=function(t,r){return r&&(t=a.decodeBody(t,r)),a.isArray(t)?e.fromValuesArray(t):e.fromValues(t)},e.fromValues=function(t){return t.error=t.error&&s.default.fromValues(t.error),Object.assign(new e,t)},e.fromValuesArray=function(t){for(var r=t.length,n=new Array(r),o=0;o<r;o++)n[o]=e.fromValues(t[o]);return n},e.toRequestBody=a.encodeBody,e}();t.default=c},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0).__importStar(r(1)),o=function(){function e(){}return e.prototype.toJSON=function(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}},e.prototype.toString=function(){var e="[PushChannelSubscription";return this.channel&&(e+="; channel="+this.channel),this.deviceId&&(e+="; deviceId="+this.deviceId),this.clientId&&(e+="; clientId="+this.clientId),e+="]"},e.fromResponseBody=function(t,r){return r&&(t=n.decodeBody(t,r)),n.isArray(t)?e.fromValuesArray(t):e.fromValues(t)},e.fromValues=function(t){return Object.assign(new e,t)},e.fromValuesArray=function(t){for(var r=t.length,n=new Array(r),o=0;o<r;o++)n[o]=e.fromValues(t[o]);return n},e.toRequestBody=n.encodeBody,e}();t.default=o},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=function(e){this.count=e&&e.count||0,this.data=e&&e.data||0,this.uncompressedData=e&&e.uncompressedData||0,this.failed=e&&e.failed||0,this.refused=e&&e.refused||0},a=function(e){function t(t){var r=e.call(this,t)||this;return t&&t.category&&(r.category={},o.forInOwnNonNullProperties(t.category,(function(e){r.category[e]=new i(t.category[e])}))),r}return n.__extends(t,e),t}(i),s=function(e){this.peak=e&&e.peak||0,this.min=e&&e.min||0,this.mean=e&&e.mean||0,this.opened=e&&e.opened||0,this.refused=e&&e.refused||0},c=function(e){this.succeeded=e&&e.succeeded||0,this.failed=e&&e.failed||0,this.refused=e&&e.refused||0},u=function(e){this.plain=new s(e&&e.plain),this.tls=new s(e&&e.tls),this.all=new s(e&&e.all)},l=function(e){this.messages=new a(e&&e.messages),this.presence=new a(e&&e.presence),this.all=new a(e&&e.all)},f=function(e){this.realtime=new l(e&&e.realtime),this.rest=new l(e&&e.rest),this.webhook=new l(e&&e.webhook),this.sharedQueue=new l(e&&e.sharedQueue),this.externalQueue=new l(e&&e.externalQueue),this.httpEvent=new l(e&&e.httpEvent),this.push=new l(e&&e.push),this.all=new l(e&&e.all)},d=function(e){this.all=new l(e&&e.all),this.inbound=new f(e&&e.inbound),this.outbound=new f(e&&e.outbound)},h=function(e){this.all=new l(e&&e.all),this.producerPaid=new d(e&&e.producerPaid),this.consumerPaid=new d(e&&e.consumerPaid)},p=function(e){this.messages=e&&e.messages||0;var t=e&&e.notifications;this.notifications={invalid:t&&t.invalid||0,attempted:t&&t.attempted||0,successful:t&&t.successful||0,failed:t&&t.failed||0},this.directPublishes=e&&e.directPublishes||0},m=function(e){this.succeeded=e&&e.succeeded||0,this.skipped=e&&e.skipped||0,this.failed=e&&e.failed||0},y=function(e){var t=this;this.delta=void 0,e&&e.delta&&(this.delta={},o.forInOwnNonNullProperties(e.delta,(function(r){t.delta[r]=new m(e.delta[r])})))},g=function(e){function t(t){var r=e.call(this,t)||this;return r.persisted=new l(t&&t.persisted),r.connections=new u(t&&t.connections),r.channels=new s(t&&t.channels),r.apiRequests=new c(t&&t.apiRequests),r.tokenRequests=new c(t&&t.tokenRequests),r.xchgProducer=new h(t&&t.xchgProducer),r.xchgConsumer=new h(t&&t.xchgConsumer),r.push=new p(t&&t.pushStats),r.processed=new y(t&&t.processed),r.inProgress=t&&t.inProgress||void 0,r.unit=t&&t.unit||void 0,r.intervalId=t&&t.intervalId||void 0,r}return n.__extends(t,e),t.fromValues=function(e){return new t(e)},t}(d);t.default=g},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(30)),a=n.__importDefault(r(7)),s=n.__importDefault(r(2)),c=n.__importDefault(r(51)),u=n.__importDefault(r(38)),l=n.__importDefault(r(8)),f=n.__importDefault(r(4)),d=n.__importDefault(r(10)),h=n.__importDefault(r(35)),p=n.__importDefault(r(3)),m=n.__importDefault(r(9)),y=function(e){function t(t){var r=e.call(this,t)||this;return s.default.logAction(s.default.LOG_MINOR,"Realtime()",""),r.connection=new c.default(r,r.options),r.channels=new g(r),!1!==t.autoConnect&&r.connect(),r}return n.__extends(t,e),t.prototype.connect=function(){s.default.logAction(s.default.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()},t.prototype.close=function(){s.default.logAction(s.default.LOG_MINOR,"Realtime.close()",""),this.connection.close()},t.Promise=function(e){return(e=l.default.objectifyOptions(e)).promises=!0,new t(e)},t.Callbacks=t,t.Utils=o,t.ConnectionManager=h.default,t.Platform=p.default,t.ProtocolMessage=d.default,t.Message=m.default,t}(i.default),g=function(e){function t(t){var r=e.call(this)||this;return r.realtime=t,r.all=Object.create(null),t.connection.connectionManager.on("transport.active",(function(){r.onTransportActive()})),r}return n.__extends(t,e),t.prototype.channelSerials=function(){for(var e={},t=0,r=o.keysArray(this.all,!0);t<r.length;t++){var n=r[t],i=this.all[n];i.properties.channelSerial&&(e[n]=i.properties.channelSerial)}return e},t.prototype.recoverChannels=function(e){for(var t=0,r=o.keysArray(e,!0);t<r.length;t++){var n=r[t];this.get(n).properties.channelSerial=e[n]}},t.prototype.onChannelMessage=function(e){var t=e.channel;if(void 0!==t){var r=this.all[t];r?r.onMessage(e):s.default.logAction(s.default.LOG_ERROR,"Channels.onChannelMessage()","received event for non-existent channel: "+t)}else s.default.logAction(s.default.LOG_ERROR,"Channels.onChannelMessage()","received event unspecified channel, action = "+e.action)},t.prototype.onTransportActive=function(){for(var e in this.all){var t=this.all[e];"attaching"===t.state||"detaching"===t.state?t.checkPendingState():"suspended"===t.state?t._attach(!1,null):"attached"===t.state&&t.requestState("attaching")}},t.prototype.propogateConnectionInterruption=function(e,t){var r=["attaching","attached","detaching","suspended"],n={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"}[e];for(var i in this.all){var a=this.all[i];o.arrIn(r,a.state)&&a.notifyState(n,t)}},t.prototype.get=function(e,t){e=String(e);var r=this.all[e];if(r){if(t){if(r._shouldReattachToSetOptions(t))throw new f.default("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);r.setOptions(t)}}else r=this.all[e]=new u.default(this.realtime,e,t);return r},t.prototype.getDerived=function(e,t,r){if(t.filter){var n=o.toBase64(t.filter),i=o.matchDerivedChannel(e);e="[filter=".concat(n).concat(i.qualifierParam,"]").concat(i.channelName)}return this.get(e,r)},t.prototype.release=function(e){e=String(e);var t=this.all[e];if(t){var r=t.getReleaseErr();if(r)throw r;delete this.all[e]}},t}(a.default);t.default=y},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(7)),a=n.__importDefault(r(35)),s=n.__importDefault(r(2)),c=n.__importDefault(r(37)),u=n.__importDefault(r(3));function l(){}var f=function(e){function t(t,r){var n=e.call(this)||this;return n.whenState=function(e,t){return i.default.prototype.whenState.call(n,e,n.state,t,new c.default(void 0,e))},n.ably=t,n.connectionManager=new a.default(t,r),n.state=n.connectionManager.state.state,n.key=void 0,n.id=void 0,n.errorReason=null,n.connectionManager.on("connectionstate",(function(e){var t=n.state=e.current;u.default.Config.nextTick((function(){n.emit(t,e)}))})),n.connectionManager.on("update",(function(e){u.default.Config.nextTick((function(){n.emit("update",e)}))})),n}return n.__extends(t,e),t.prototype.connect=function(){s.default.logAction(s.default.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})},t.prototype.ping=function(e){if(s.default.logAction(s.default.LOG_MINOR,"Connection.ping()",""),!e){if(this.ably.options.promises)return o.promisify(this,"ping",arguments);e=l}this.connectionManager.ping(null,e)},t.prototype.close=function(){s.default.logAction(s.default.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})},Object.defineProperty(t.prototype,"recoveryKey",{get:function(){return this.createRecoveryKey()},enumerable:!1,configurable:!0}),t.prototype.createRecoveryKey=function(){return this.connectionManager.createRecoveryKey()},t}(i.default);t.default=f},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.PendingMessage=void 0;var n=r(0),o=n.__importDefault(r(10)),i=n.__importStar(r(1)),a=n.__importDefault(r(7)),s=n.__importDefault(r(2)),c=n.__importDefault(r(36)),u=n.__importDefault(r(4)),l=o.default.Action,f=function(e,t){this.message=e,this.callback=t,this.merged=!1;var r=e.action;this.sendAttempted=!1,this.ackRequired=r==l.MESSAGE||r==l.PRESENCE};t.PendingMessage=f;var d=function(e){function t(t){var r=e.call(this)||this;return r.transport=t,r.messageQueue=new c.default,t.on("ack",(function(e,t){r.onAck(e,t)})),t.on("nack",(function(e,t,n){r.onNack(e,t,n)})),r}return n.__extends(t,e),t.prototype.onAck=function(e,t){s.default.logAction(s.default.LOG_MICRO,"Protocol.onAck()","serial = "+e+"; count = "+t),this.messageQueue.completeMessages(e,t)},t.prototype.onNack=function(e,t,r){s.default.logAction(s.default.LOG_ERROR,"Protocol.onNack()","serial = "+e+"; count = "+t+"; err = "+i.inspectError(r)),r||(r=new u.default("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(e,t,r)},t.prototype.onceIdle=function(e){var t=this.messageQueue;0!==t.count()?t.once("idle",e):e()},t.prototype.send=function(e){e.ackRequired&&this.messageQueue.push(e),s.default.shouldLog(s.default.LOG_MICRO)&&s.default.logAction(s.default.LOG_MICRO,"Protocol.send()","sending msg; "+o.default.stringify(e.message)),e.sendAttempted=!0,this.transport.send(e.message)},t.prototype.getTransport=function(){return this.transport},t.prototype.getPendingMessages=function(){return this.messageQueue.copyAll()},t.prototype.clearPendingMessages=function(){return this.messageQueue.clear()},t.prototype.finish=function(){var e=this.transport;this.onceIdle((function(){e.disconnect()}))},t}(a.default);t.default=d},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=o.__importDefault(r(3)),a=o.__importStar(r(1)),s=o.__importDefault(r(26)),c=o.__importDefault(r(8)),u=o.__importDefault(r(2)),l=o.__importDefault(r(10)),f=o.__importDefault(r(4)),d=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.shortName="web_socket",n.heartbeats=i.default.Config.useProtocolHeartbeats,o.wsHost=c.default.getHost(n.options,n.host,!0),o}return o.__extends(t,e),t.isAvailable=function(){return!!i.default.Config.WebSocket},t.prototype.createWebSocket=function(e,t){return this.uri=e+a.toQueryString(t),new i.default.Config.WebSocket(this.uri)},t.prototype.toString=function(){return"WebSocketTransport; uri="+this.uri},t.prototype.connect=function(){u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.connect()","starting"),s.default.prototype.connect.call(this);var e=this,t=this.params,r=t.options,n=(r.tls?"wss://":"ws://")+this.wsHost+":"+c.default.getPort(r)+"/";u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.connect()","uri: "+n),this.auth.getAuthParams((function(r,o){if(!e.isDisposed){var a="";for(var s in o)a+=" "+s+": "+o[s]+";";if(u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+a+" err: "+r),r)e.disconnect(r);else{var c=t.getConnectParams(o);try{var l=e.wsConnection=e.createWebSocket(n,c);l.binaryType=i.default.Config.binaryType,l.onopen=function(){e.onWsOpen()},l.onclose=function(t){e.onWsClose(t)},l.onmessage=function(t){e.onWsData(t.data)},l.onerror=function(t){e.onWsError(t)},l.on&&l.on("ping",(function(){e.onActivity()}))}catch(t){u.default.logAction(u.default.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(t.stack||t.message)),e.disconnect(t)}}}}))},t.prototype.send=function(e){var t=this.wsConnection;if(t)try{t.send(l.default.serialize(e,this.params.format))}catch(e){var r="Exception from ws connection when trying to send: "+a.inspectError(e);u.default.logAction(u.default.LOG_ERROR,"WebSocketTransport.send()",r),this.finish("disconnected",new f.default(r,5e4,500))}else u.default.logAction(u.default.LOG_ERROR,"WebSocketTransport.send()","No socket connection")},t.prototype.onWsData=function(e){u.default.logAction(u.default.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+e.length+"; type = "+n(e));try{this.onProtocolMessage(l.default.deserialize(e,this.format))}catch(e){u.default.logAction(u.default.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+e.stack)}},t.prototype.onWsOpen=function(){u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")},t.prototype.onWsClose=function(e){var t,r;if("object"==n(e)?(r=e.code,t=e.wasClean||1e3===r):t=1e3==(r=e),delete this.wsConnection,t){u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");var o=new f.default("Websocket closed",80003,400);this.finish("disconnected",o)}else{var i="Unclean disconnection of WebSocket ; code = "+r;o=new f.default(i,80003,400),u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.onWsClose()",i),this.finish("disconnected",o)}this.emit("disposed")},t.prototype.onWsError=function(e){var t=this;u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+e.message),i.default.Config.nextTick((function(){t.disconnect(Error(e.message))}))},t.prototype.dispose=function(){u.default.logAction(u.default.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;var e=this.wsConnection;e&&(e.onmessage=function(){},delete this.wsConnection,i.default.Config.nextTick((function(){if(u.default.logAction(u.default.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!e)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");e.close()})))},t}(s.default);t.default=function(e){return d.isAvailable()&&(e.supportedTransports.web_socket=d),d}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(1)),i=n.__importDefault(r(34)),a=n.__importDefault(r(7)),s=n.__importDefault(r(2)),c=n.__importDefault(r(15)),u=n.__importStar(r(4)),l=n.__importDefault(r(38)),f=n.__importDefault(r(23)),d=n.__importDefault(r(39)),h=function(){};function p(e){var t=e.channel.realtime,r=t.auth.clientId;return(!r||"*"===r)&&"connected"===t.connection.state}function m(e,t,r){switch(e.state){case"attached":case"suspended":r();break;case"initialized":case"detached":case"detaching":case"attaching":e.attach((function(e){e?t(e):r()}));break;default:t(u.default.fromValues(e.invalidStateError()))}}function y(e,t){if(e.isSynthesized()||t.isSynthesized())return e.timestamp>=t.timestamp;var r=e.parseId(),n=t.parseId();return r.msgSerial===n.msgSerial?r.index>n.index:r.msgSerial>n.msgSerial}var g=function(e){function t(t){var r=e.call(this,t)||this;return r.channel=t,r.syncComplete=!1,r.members=new v(r,(function(e){return e.clientId+":"+e.connectionId})),r._myMembers=new v(r,(function(e){return e.clientId})),r.subscriptions=new a.default,r.pendingPresence=[],r}return n.__extends(t,e),t.prototype.enter=function(e,t){if(p(this))throw new u.default("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"enter",t)},t.prototype.update=function(e,t){if(p(this))throw new u.default("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,e,"update",t)},t.prototype.enterClient=function(e,t,r){return this._enterOrUpdateClient(void 0,e,t,"enter",r)},t.prototype.updateClient=function(e,t,r){return this._enterOrUpdateClient(void 0,e,t,"update",r)},t.prototype._enterOrUpdateClient=function(e,t,r,n,i){var a=this;if(!i)if("function"==typeof r)i=r,r=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"_enterOrUpdateClient",[e,t,r,n]);i=h}var l=this.channel;if(l.connectionManager.activeState()){s.default.logAction(s.default.LOG_MICRO,"RealtimePresence."+n+"Client()","channel = "+l.name+", id = "+e+", client = "+(t||"(implicit) "+this.channel.realtime.auth.clientId));var f=c.default.fromData(r);f.action=n,e&&(f.id=e),t&&(f.clientId=t),c.default.encode(f,l.channelOptions,(function(e){if(e)i(e);else switch(l.state){case"attached":l.sendPresence(f,i);break;case"initialized":case"detached":l.attach();case"attaching":a.pendingPresence.push({presence:f,callback:i});break;default:(e=new u.PartialErrorInfo("Unable to "+n+" presence channel while in "+l.state+" state",90001)).code=90001,i(e)}}))}else i(l.connectionManager.getError())},t.prototype.leave=function(e,t){if(p(this))throw new u.default("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,e,t)},t.prototype.leaveClient=function(e,t,r){if(!r)if("function"==typeof t)r=t,t=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"leaveClient",[e,t]);r=h}var n=this.channel;if(n.connectionManager.activeState()){s.default.logAction(s.default.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+e);var i=c.default.fromData(t);switch(i.action="leave",e&&(i.clientId=e),n.state){case"attached":n.sendPresence(i,r);break;case"attaching":this.pendingPresence.push({presence:i,callback:r});break;case"initialized":case"failed":var a=new u.PartialErrorInfo("Unable to leave presence channel (incompatible state)",90001);null==r||r(a);break;default:null==r||r(n.invalidStateError())}}else null==r||r(n.connectionManager.getError())},t.prototype.get=function(e,t){var r=this,n=Array.prototype.slice.call(arguments);1==n.length&&"function"==typeof n[0]&&n.unshift(null),e=n[0],t=n[1];var i=!e||!("waitForSync"in e)||e.waitForSync;if(!t){if(this.channel.realtime.options.promises)return o.promisify(this,"get",n);t=h}function a(r){t(null,e?r.list(e):r.values())}"suspended"!==this.channel.state?m(this.channel,t,(function(){var e=r.members;i?e.waitSync((function(){a(e)})):a(e)})):i?t(u.default.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):a(this.members)},t.prototype.history=function(e,t){if(s.default.logAction(s.default.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name),void 0===t)if("function"==typeof e)t=e,e=null;else{if(this.channel.realtime.options.promises)return o.promisify(this,"history",arguments);t=h}e&&e.untilAttach&&("attached"===this.channel.state?(delete e.untilAttach,e.from_serial=this.channel.properties.attachSerial):t(new u.default("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400))),i.default.prototype._history.call(this,e,t)},t.prototype.setPresence=function(e,t,r){var n,o;s.default.logAction(s.default.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+e.length+" participants; syncChannelSerial = "+r);var i=this.members,a=this._myMembers,u=[],l=this.channel.connectionManager.connectionId;t&&(this.members.startSync(),r&&(o=r.match(/^[\w-]+:(.*)$/))&&(n=o[1]));for(var f=0;f<e.length;f++)switch((d=c.default.fromValues(e[f])).action){case"leave":i.remove(d)&&u.push(d),d.connectionId!==l||d.isSynthesized()||a.remove(d);break;case"enter":case"present":case"update":i.put(d)&&u.push(d),d.connectionId===l&&a.put(d)}for(t&&!n&&(i.endSync(),this.channel.syncChannelSerial=null),f=0;f<u.length;f++){var d=u[f];this.subscriptions.emit(d.action,d)}},t.prototype.onAttached=function(e){s.default.logAction(s.default.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+e),e?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();var t=this.pendingPresence,r=t.length;if(r){this.pendingPresence=[];var n=[],o=f.default.create();s.default.logAction(s.default.LOG_MICRO,"RealtimePresence.onAttached","sending "+r+" queued presence messages");for(var i=0;i<r;i++){var a=t[i];n.push(a.presence),o.push(a.callback)}this.channel.sendPresence(n,o)}},t.prototype.actOnChannelState=function(e,t,r){switch(e){case"attached":this.onAttached(t);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(r)}},t.prototype.failPendingPresence=function(e){if(this.pendingPresence.length){s.default.logAction(s.default.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+o.inspectError(e));for(var t=0;t<this.pendingPresence.length;t++)try{this.pendingPresence[t].callback(e)}catch(e){}this.pendingPresence=[]}},t.prototype._clearMyMembers=function(){this._myMembers.clear()},t.prototype._ensureMyMembersPresent=function(){var e=this,t=this._myMembers,r=function(t){if(t){var r="Presence auto-re-enter failed: "+t.toString(),n=new u.default(r,91004,400);s.default.logAction(s.default.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()",r);var o=new d.default(e.channel.state,e.channel.state,!0,!1,n);e.channel.emit("update",o)}};for(var n in t.map){var o=t.map[n];s.default.logAction(s.default.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+o.clientId+'" into the presence set'),this._enterOrUpdateClient(o.id,o.clientId,o.data,"enter",r)}},t.prototype._synthesizeLeaves=function(e){var t=this.subscriptions;o.arrForEach(e,(function(e){var r=c.default.fromValues({action:"leave",connectionId:e.connectionId,clientId:e.clientId,data:e.data,encoding:e.encoding,timestamp:o.now()});t.emit("leave",r)}))},t.prototype.on=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.default.deprecated("presence.on","presence.subscribe"),this.subscribe.apply(this,e)},t.prototype.off=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];s.default.deprecated("presence.off","presence.unsubscribe"),this.unsubscribe.apply(this,e)},t.prototype.subscribe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=l.default.processListenerArgs(e),n=r[0],i=r[1],a=r[2],s=this.channel;if(!a){if(this.channel.realtime.options.promises)return o.promisify(this,"subscribe",[n,i]);a=h}"failed"!==s.state?(this.subscriptions.on(n,i),s.attach(a)):a(u.default.fromValues(s.invalidStateError()))},t.prototype.unsubscribe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=l.default.processListenerArgs(e),n=r[0],o=r[1];this.subscriptions.off(n,o)},t}(i.default),v=function(e){function t(t,r){var n=e.call(this)||this;return n.presence=t,n.map=Object.create(null),n.syncInProgress=!1,n.residualMembers=null,n.memberKey=r,n}return n.__extends(t,e),t.prototype.get=function(e){return this.map[e]},t.prototype.getClient=function(e){var t=this.map,r=[];for(var n in t){var o=t[n];o.clientId==e&&"absent"!=o.action&&r.push(o)}return r},t.prototype.list=function(e){var t=this.map,r=e&&e.clientId,n=e&&e.connectionId,o=[];for(var i in t){var a=t[i];"absent"!==a.action&&(r&&r!=a.clientId||n&&n!=a.connectionId||o.push(a))}return o},t.prototype.put=function(e){"enter"!==e.action&&"update"!==e.action||((e=c.default.fromValues(e)).action="present");var t=this.map,r=this.memberKey(e);this.residualMembers&&delete this.residualMembers[r];var n=t[r];return!(n&&!y(e,n)||(t[r]=e,0))},t.prototype.values=function(){var e=this.map,t=[];for(var r in e){var n=e[r];"absent"!=n.action&&t.push(n)}return t},t.prototype.remove=function(e){var t=this.map,r=this.memberKey(e),n=t[r];return!(n&&!y(e,n)||(this.syncInProgress?((e=c.default.fromValues(e)).action="absent",t[r]=e):delete t[r],0))},t.prototype.startSync=function(){var e=this.map,t=this.syncInProgress;s.default.logAction(s.default.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),this.syncInProgress||(this.residualMembers=o.copy(e),this.setInProgress(!0))},t.prototype.endSync=function(){var e=this.map,t=this.syncInProgress;if(s.default.logAction(s.default.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t){for(var r in e)"absent"===e[r].action&&delete e[r];for(var r in this.presence._synthesizeLeaves(o.valuesArray(this.residualMembers)),this.residualMembers)delete e[r];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")},t.prototype.waitSync=function(e){var t=this.syncInProgress;s.default.logAction(s.default.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+t),t?this.once("sync",e):e()},t.prototype.clear=function(){this.map={},this.setInProgress(!1),this.residualMembers=null},t.prototype.setInProgress=function(e){s.default.logAction(s.default.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+e),this.syncInProgress=e,this.presence.syncComplete=!e},t}(a.default);t.default=g},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(56),i=r(31),a=r(11),s=n.__importDefault(r(5)),c=n.__importDefault(r(3)),u=function(){function e(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}return e.prototype.isWordArray=function(e){return null!=e&&void 0!==e.sigBytes},e.prototype.isArrayBuffer=function(e){return null!=e&&e.constructor===ArrayBuffer},e.prototype.isTypedArray=function(e){return!!ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e)},e.prototype.uint8ViewToBase64=function(e){for(var t,r,n,o,i="",a=this.base64CharSet,s=e.byteLength,c=s%3,u=s-c,l=0;l<u;l+=3)t=(258048&(o=e[l]<<16|e[l+1]<<8|e[l+2]))>>12,r=(4032&o)>>6,n=63&o,i+=a[(16515072&o)>>18]+a[t]+a[r]+a[n];return 1==c?(t=(3&(o=e[u]))<<4,i+=a[(252&o)>>2]+a[t]+"=="):2==c&&(t=(1008&(o=e[u]<<8|e[u+1]))>>4,r=(15&o)<<2,i+=a[(64512&o)>>10]+a[t]+a[r]+"="),i},e.prototype.base64ToArrayBuffer=function(e){for(var t=null===atob||void 0===atob?void 0:atob(e),r=t.length,n=new Uint8Array(r),o=0;o<r;o++){var i=t.charCodeAt(o);n[o]=i}return n.buffer},e.prototype.isBuffer=function(e){return this.isArrayBuffer(e)||this.isWordArray(e)||this.isTypedArray(e)},e.prototype.toBuffer=function(e){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(this.isArrayBuffer(e))return new Uint8Array(e);if(this.isTypedArray(e))return new Uint8Array(e.buffer);if(this.isWordArray(e)){for(var t=new ArrayBuffer(e.sigBytes),r=new Uint8Array(t),n=0;n<e.sigBytes;n++)r[n]=e.words[n>>>2]>>>24-n%4*8&255;return r}throw new Error("BufferUtils.toBuffer expected an arraybuffer, typed array, or CryptoJS wordarray")},e.prototype.toArrayBuffer=function(e){return this.isArrayBuffer(e)?e:this.toBuffer(e).buffer},e.prototype.toWordArray=function(e){return this.isTypedArray(e)&&(e=e.buffer),this.isWordArray(e)?e:s.default.create(e)},e.prototype.base64Encode=function(e){return this.isWordArray(e)?(0,a.stringify)(e):this.uint8ViewToBase64(this.toBuffer(e))},e.prototype.base64Decode=function(e){return ArrayBuffer&&c.default.Config.atob?this.base64ToArrayBuffer(e):(0,a.parse)(e)},e.prototype.hexEncode=function(e){return(0,o.stringify)(this.toWordArray(e))},e.prototype.hexDecode=function(e){var t=(0,o.parse)(e);return ArrayBuffer?this.toArrayBuffer(t):t},e.prototype.utf8Encode=function(e){return c.default.Config.TextEncoder?(new c.default.Config.TextEncoder).encode(e).buffer:(0,i.parse)(e)},e.prototype.utf8Decode=function(e){if(!this.isBuffer(e))throw new Error("Expected input of utf8decode to be an arraybuffer, typed array, or CryptoJS wordarray");return TextDecoder&&!this.isWordArray(e)?(new TextDecoder).decode(e):(e=this.toWordArray(e),(0,i.stringify)(e))},e.prototype.bufferCompare=function(e,t){if(!e)return-1;if(!t)return 1;var r=this.toWordArray(e),n=this.toWordArray(t);r.clamp(),n.clamp();var o=r.sigBytes-n.sigBytes;if(0!=o)return o;for(var i=r.words,a=n.words,s=0;s<i.length;s++)if(0!=(o=i[s]-a[s]))return o;return 0},e.prototype.byteLength=function(e){return this.isArrayBuffer(e)||this.isTypedArray(e)?e.byteLength:this.isWordArray(e)?e.sigBytes:-1},e.prototype.typedArrayToBuffer=function(e){return e.buffer},e}();t.default=new u},function(e,t,r){e.exports=r(6).enc.Hex},function(e,t,r){r.r(t);var n=r(5),o=r.n(n),i=r(11),a=r(22),s=r.n(a),c=r(2),u=r.n(c),l=r(4),f=r.n(l);t.default=function(e,t){var r;if(e.getRandomWordArray)r=e.getRandomWordArray;else if("undefined"!=typeof Uint32Array&&e.getRandomValues){var n=new Uint32Array(4);r=function(r,o){var i=r/4,a=4==i?n:new Uint32Array(i);e.getRandomValues(a,(function(e){void 0!==o&&o(e,t.toWordArray(a))}))}}else r=function(e,t){u.a.logAction(u.a.LOG_MAJOR,"Ably.Crypto.generateRandom()","Warning: the browser you are using does not support secure cryptographically secure randomness generation; falling back to insecure Math.random()");for(var r=e/4,n=new Array(r),i=0;i<r;i++)n[i]=Math.floor(4294967296*Math.random())-2147483648;t(null,o.a.create(n))};function a(e){if("aes"===e.algorithm&&"cbc"===e.mode){if(128===e.keyLength||256===e.keyLength)return;throw new Error("Unsupported key length "+e.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function c(e){return e.replace("_","/").replace("-","+")}var l=[o.a.create([269488144,269488144,269488144,269488144],16),o.a.create([16777216],1),o.a.create([33685504],2),o.a.create([50529024],3),o.a.create([67372036],4),o.a.create([84215045,83886080],5),o.a.create([101058054,101056512],6),o.a.create([117901063,117901056],7),o.a.create([134744072,134744072],8),o.a.create([151587081,151587081,150994944],9),o.a.create([168430090,168430090,168427520],10),o.a.create([185273099,185273099,185273088],11),o.a.create([202116108,202116108,202116108],12),o.a.create([218959117,218959117,218959117,218103808],13),o.a.create([235802126,235802126,235802126,235798528],14),o.a.create([252645135,252645135,252645135,252645135],15),o.a.create([269488144,269488144,269488144,269488144],16)];function d(){}function h(){this.algorithm=null,this.keyLength=null,this.mode=null,this.key=null}function p(e,r,n){this.algorithm=e.algorithm+"-"+String(e.keyLength)+"-"+e.mode,this.cjsAlgorithm=e.algorithm.toUpperCase().replace(/-\d+$/,""),this.key=t.toWordArray(e.key),n&&(this.iv=t.toWordArray(n).clone()),this.blockLengthWords=r}return d.CipherParams=h,d.getDefaultParams=function(e){var r;if("function"!=typeof e&&"string"!=typeof e){if(!e.key)throw new Error("Crypto.getDefaultParams: a key is required");r="string"==typeof e.key?Object(i.parse)(c(e.key)):t.toWordArray(e.key);var n=new h;if(n.key=r,n.algorithm=e.algorithm||"aes",n.keyLength=32*r.words.length,n.mode=e.mode||"cbc",e.keyLength&&e.keyLength!==n.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+e.keyLength+" was specified, but the key actually has length "+n.keyLength);return a(n),n}if(u.a.deprecated("Crypto.getDefaultParams(key, callback)","Crypto.getDefaultParams({key: key})"),"function"==typeof e)d.generateRandomKey((function(t){e(null,d.getDefaultParams({key:t}))}));else{if("function"!=typeof arguments[1])throw new Error("Invalid arguments for Crypto.getDefaultParams");arguments[1](null,d.getDefaultParams({key:e}))}},d.generateRandomKey=function(e,t){1==arguments.length&&"function"==typeof e&&(t=e,e=void 0),r((e||256)/8,(function(e,r){void 0!==t&&t(e?f.a.fromValues(e):null,r)}))},d.getCipher=function(e){var t=e instanceof h?e:d.getDefaultParams(e);return{cipherParams:t,cipher:new p(t,4,e.iv)}},p.prototype.encrypt=function(e,n){u.a.logAction(u.a.LOG_MICRO,"CBCCipher.encrypt()","");var o=(e=t.toWordArray(e)).sigBytes,i=function(e){return e+16&-16}(o),a=this,c=function(){a.getIv((function(t,r){if(t)n(t);else{var s=a.encryptCipher.process(e.concat(l[i-o])),c=r.concat(s);n(null,c)}}))};this.encryptCipher?c():this.iv?(this.encryptCipher=s.a.algo[this.cjsAlgorithm].createEncryptor(this.key,{iv:this.iv}),c()):r(16,(function(e,t){e?n(e):(a.encryptCipher=s.a.algo[a.cjsAlgorithm].createEncryptor(a.key,{iv:t}),a.iv=t,c())}))},p.prototype.decrypt=function(e){u.a.logAction(u.a.LOG_MICRO,"CBCCipher.decrypt()",""),e=t.toWordArray(e);var r=this.blockLengthWords,n=e.words,i=o.a.create(n.slice(0,r)),a=o.a.create(n.slice(r)),c=s.a.algo[this.cjsAlgorithm].createDecryptor(this.key,{iv:i}),l=c.process(a),f=c.finalize();return c.reset(),f&&f.sigBytes&&l.concat(f),l},p.prototype.getIv=function(e){if(this.iv){var t=this.iv;return this.iv=null,void e(null,t)}var n=this;r(16,(function(t,r){t?e(t):e(null,n.encryptCipher.process(r))}))},d}},function(e,t,r){var n;e.exports=(n=r(6),function(){var e=n,t=e.lib.WordArray,r=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],o=0;o<r;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;n.push(String.fromCharCode(i))}return n.join("")},parse:function(e){for(var r=e.length,n=[],o=0;o<r;o++)n[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(n,2*r)}},r.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i+=2){var a=o(t[i>>>2]>>>16-i%4*8&65535);n.push(String.fromCharCode(a))}return n.join("")},parse:function(e){for(var r=e.length,n=[],i=0;i<r;i++)n[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return t.create(n,2*r)}}}(),n.enc.Utf16)},function(e,t,r){var n,o,i,a;e.exports=(a=r(6),r(28),o=(n=a).lib.CipherParams,i=n.enc.Hex,n.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return o.create({ciphertext:t})}},a.format.Hex)},function(e,t,r){var n;e.exports=(n=r(6),r(11),r(61),r(27),r(28),function(){var e=n,t=e.lib.BlockCipher,r=e.algo,o=[],i=[],a=[],s=[],c=[],u=[],l=[],f=[],d=[],h=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,n=0;for(t=0;t<256;t++){var p=n^n<<1^n<<2^n<<3^n<<4;p=p>>>8^255&p^99,o[r]=p,i[p]=r;var m=e[r],y=e[m],g=e[y],v=257*e[p]^16843008*p;a[r]=v<<24|v>>>8,s[r]=v<<16|v>>>16,c[r]=v<<8|v>>>24,u[r]=v,v=16843009*g^65537*y^257*m^16843008*r,l[p]=v<<24|v>>>8,f[p]=v<<16|v>>>16,d[p]=v<<8|v>>>24,h[p]=v,r?(r=m^e[e[e[g^m]]],n^=e[e[n]]):r=n=1}}();var p=[0,1,2,4,8,16,32,64,128,27,54],m=r.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,n=4*((this._nRounds=r+6)+1),i=this._keySchedule=[],a=0;a<n;a++)a<r?i[a]=t[a]:(u=i[a-1],a%r?r>6&&a%r==4&&(u=o[u>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u]):(u=o[(u=u<<8|u>>>24)>>>24]<<24|o[u>>>16&255]<<16|o[u>>>8&255]<<8|o[255&u],u^=p[a/r|0]<<24),i[a]=i[a-r]^u);for(var s=this._invKeySchedule=[],c=0;c<n;c++){if(a=n-c,c%4)var u=i[a];else u=i[a-4];s[c]=c<4||a<=4?u:l[o[u>>>24]]^f[o[u>>>16&255]]^d[o[u>>>8&255]]^h[o[255&u]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,c,u,o)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,l,f,d,h,i),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,o,i,a,s){for(var c=this._nRounds,u=e[t]^r[0],l=e[t+1]^r[1],f=e[t+2]^r[2],d=e[t+3]^r[3],h=4,p=1;p<c;p++){var m=n[u>>>24]^o[l>>>16&255]^i[f>>>8&255]^a[255&d]^r[h++],y=n[l>>>24]^o[f>>>16&255]^i[d>>>8&255]^a[255&u]^r[h++],g=n[f>>>24]^o[d>>>16&255]^i[u>>>8&255]^a[255&l]^r[h++],v=n[d>>>24]^o[u>>>16&255]^i[l>>>8&255]^a[255&f]^r[h++];u=m,l=y,f=g,d=v}m=(s[u>>>24]<<24|s[l>>>16&255]<<16|s[f>>>8&255]<<8|s[255&d])^r[h++],y=(s[l>>>24]<<24|s[f>>>16&255]<<16|s[d>>>8&255]<<8|s[255&u])^r[h++],g=(s[f>>>24]<<24|s[d>>>16&255]<<16|s[u>>>8&255]<<8|s[255&l])^r[h++],v=(s[d>>>24]<<24|s[u>>>16&255]<<16|s[l>>>8&255]<<8|s[255&f])^r[h++],e[t]=m,e[t+1]=y,e[t+2]=g,e[t+3]=v},keySize:8});e.AES=t._createHelper(m)}(),n.AES)},function(e,t,r){var n;e.exports=(n=r(6),function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var c=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var n=t+r,o=e[n];e[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],c=e[t+1],h=e[t+2],p=e[t+3],m=e[t+4],y=e[t+5],g=e[t+6],v=e[t+7],b=e[t+8],w=e[t+9],_=e[t+10],O=e[t+11],S=e[t+12],E=e[t+13],k=e[t+14],C=e[t+15],A=i[0],x=i[1],j=i[2],R=i[3];A=u(A,x,j,R,a,7,s[0]),R=u(R,A,x,j,c,12,s[1]),j=u(j,R,A,x,h,17,s[2]),x=u(x,j,R,A,p,22,s[3]),A=u(A,x,j,R,m,7,s[4]),R=u(R,A,x,j,y,12,s[5]),j=u(j,R,A,x,g,17,s[6]),x=u(x,j,R,A,v,22,s[7]),A=u(A,x,j,R,b,7,s[8]),R=u(R,A,x,j,w,12,s[9]),j=u(j,R,A,x,_,17,s[10]),x=u(x,j,R,A,O,22,s[11]),A=u(A,x,j,R,S,7,s[12]),R=u(R,A,x,j,E,12,s[13]),j=u(j,R,A,x,k,17,s[14]),A=l(A,x=u(x,j,R,A,C,22,s[15]),j,R,c,5,s[16]),R=l(R,A,x,j,g,9,s[17]),j=l(j,R,A,x,O,14,s[18]),x=l(x,j,R,A,a,20,s[19]),A=l(A,x,j,R,y,5,s[20]),R=l(R,A,x,j,_,9,s[21]),j=l(j,R,A,x,C,14,s[22]),x=l(x,j,R,A,m,20,s[23]),A=l(A,x,j,R,w,5,s[24]),R=l(R,A,x,j,k,9,s[25]),j=l(j,R,A,x,p,14,s[26]),x=l(x,j,R,A,b,20,s[27]),A=l(A,x,j,R,E,5,s[28]),R=l(R,A,x,j,h,9,s[29]),j=l(j,R,A,x,v,14,s[30]),A=f(A,x=l(x,j,R,A,S,20,s[31]),j,R,y,4,s[32]),R=f(R,A,x,j,b,11,s[33]),j=f(j,R,A,x,O,16,s[34]),x=f(x,j,R,A,k,23,s[35]),A=f(A,x,j,R,c,4,s[36]),R=f(R,A,x,j,m,11,s[37]),j=f(j,R,A,x,v,16,s[38]),x=f(x,j,R,A,_,23,s[39]),A=f(A,x,j,R,E,4,s[40]),R=f(R,A,x,j,a,11,s[41]),j=f(j,R,A,x,p,16,s[42]),x=f(x,j,R,A,g,23,s[43]),A=f(A,x,j,R,w,4,s[44]),R=f(R,A,x,j,S,11,s[45]),j=f(j,R,A,x,C,16,s[46]),A=d(A,x=f(x,j,R,A,h,23,s[47]),j,R,a,6,s[48]),R=d(R,A,x,j,v,10,s[49]),j=d(j,R,A,x,k,15,s[50]),x=d(x,j,R,A,y,21,s[51]),A=d(A,x,j,R,S,6,s[52]),R=d(R,A,x,j,p,10,s[53]),j=d(j,R,A,x,_,15,s[54]),x=d(x,j,R,A,c,21,s[55]),A=d(A,x,j,R,b,6,s[56]),R=d(R,A,x,j,C,10,s[57]),j=d(j,R,A,x,g,15,s[58]),x=d(x,j,R,A,E,21,s[59]),A=d(A,x,j,R,m,6,s[60]),R=d(R,A,x,j,O,10,s[61]),j=d(j,R,A,x,h,15,s[62]),x=d(x,j,R,A,w,21,s[63]),i[0]=i[0]+A|0,i[1]=i[1]+x|0,i[2]=i[2]+j|0,i[3]=i[3]+R|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,o=8*t.sigBytes;r[o>>>5]|=128<<24-o%32;var i=e.floor(n/4294967296),a=n;r[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),r[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(r.length+1),this._process();for(var s=this._hash,c=s.words,u=0;u<4;u++){var l=c[u];c[u]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function u(e,t,r,n,o,i,a){var s=e+(t&r|~t&n)+o+a;return(s<<i|s>>>32-i)+t}function l(e,t,r,n,o,i,a){var s=e+(t&n|r&~n)+o+a;return(s<<i|s>>>32-i)+t}function f(e,t,r,n,o,i,a){var s=e+(t^r^n)+o+a;return(s<<i|s>>>32-i)+t}function d(e,t,r,n,o,i,a){var s=e+(r^(t|~n))+o+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(c),t.HmacMD5=i._createHmacHelper(c)}(Math),n.MD5)},function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),i=o.__importDefault(r(3)),a=o.__importStar(r(1)),s=o.__importDefault(r(8)),c=r(4),u=o.__importDefault(r(18)),l=o.__importDefault(r(16)),f=o.__importDefault(r(21)),d=o.__importDefault(r(2)),h=r(29),p=o.__importDefault(r(63)),m=r(25);function y(e){var t=e.statusCode;return 408===t&&!e.code||400===t&&!e.code||t>=500&&t<=504}function g(e){var t=e.connection,r=t&&t.connectionManager.host;return r?[r].concat(s.default.getFallbackHosts(e.options)):s.default.getHosts(e.options)}var v=((n=function(){function e(e){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1,this._getHosts=g,this.options=e||{};var t=this.options.connectivityCheckUrl||s.default.connectivityCheckUrl,r=this.options.connectivityCheckParams,n=!this.options.connectivityCheckUrl;i.default.Config.xhrSupported?(this.supportsAuthHeaders=!0,this.Request=function(e,t,r,n,o,i,a){var s=l.default.createRequest(r,n,o,i,f.default.REQ_SEND,t&&t.options.timeouts,e);return s.once("complete",a),s.exec(),s},this.options.disableConnectivityCheck?this.checkConnectivity=function(e){e(null,!0)}:this.checkConnectivity=function(e){d.default.logAction(d.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+t),this.doUri(u.default.Get,null,t,null,null,r,(function(t,r,o,i,a){var s=!1;s=n?!t&&"yes"==(null==r?void 0:r.replace(/\n/,"")):!t&&(0,m.isSuccessCode)(a),d.default.logAction(d.default.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+s),e(null,s)}))}):i.default.Config.jsonpSupported?(this.Request=function(e,t,r,n,o,a,s){var c=(0,h.createRequest)(r,n,o,a,f.default.REQ_SEND,t&&t.options.timeouts,e);return c.once("complete",s),i.default.Config.nextTick((function(){c.exec()})),c},this.options.disableConnectivityCheck?this.checkConnectivity=function(e){e(null,!0)}:this.checkConnectivity=function(e){var t=this,r=s.default.jsonpInternetUpUrl;if(this.checksInProgress)this.checksInProgress.push(e);else{this.checksInProgress=[e],d.default.logAction(d.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Sending; "+r);var n=new h.Request("isTheInternetUp",r,null,null,null,f.default.REQ_SEND,s.default.TIMEOUTS);n.once("complete",(function(e,r){var n=!e&&r;d.default.logAction(d.default.LOG_MICRO,"(JSONP)Http.checkConnectivity()","Result: "+n);for(var o=0;o<t.checksInProgress.length;o++)t.checksInProgress[o](null,n);t.checksInProgress=null})),i.default.Config.nextTick((function(){n.exec()}))}}):i.default.Config.fetchSupported?(this.supportsAuthHeaders=!0,this.Request=p.default,this.checkConnectivity=function(e){d.default.logAction(d.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+t),this.doUri(u.default.Get,null,t,null,null,null,(function(t,r){var n=!t&&"yes"==(null==r?void 0:r.replace(/\n/,""));d.default.logAction(d.default.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+n),e(null,n)}))}):this.Request=function(e,t,r,n,o,i,a){a(new c.PartialErrorInfo("no supported HTTP transports available",null,400),null)}}return e.prototype.do=function(e,t,r,n,i,s,u){var l=this,f="function"==typeof r?r:function(e){return t.baseUri(e)+r},d=t._currentFallback;if(d){if(d.validUntil>a.now())return this.Request?void this.Request(e,t,f(d.host),n,s,i,(function(a){for(var c=[],f=1;f<arguments.length;f++)c[f-1]=arguments[f];if(a&&y(a))return t._currentFallback=null,void l.do(e,t,r,n,i,s,u);null==u||u.apply(void 0,o.__spreadArray([a],c,!1))})):void(null==u||u(new c.PartialErrorInfo("Request invoked before assigned to",null,500)));t._currentFallback=null}var h=g(t);1!==h.length?function r(c,d){var h=c.shift();l.doUri(e,t,f(h),n,i,s,(function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];e&&y(e)&&c.length?r(c,!0):(d&&(t._currentFallback={host:h,validUntil:a.now()+t.options.timeouts.fallbackRetryTimeout}),null==u||u.apply(void 0,o.__spreadArray([e],n,!1)))}))}(h):this.doUri(e,t,f(h[0]),n,i,s,u)},e.prototype.doUri=function(e,t,r,n,o,i,a){this.Request?this.Request(e,t,r,n,i,o,a):a(new c.PartialErrorInfo("Request invoked before assigned to",null,500))},e}()).methods=[u.default.Get,u.default.Delete,u.default.Post,u.default.Put,u.default.Patch],n.methodsWithoutBody=[u.default.Get,u.default.Delete],n.methodsWithBody=[u.default.Post,u.default.Put,u.default.Patch],n);t.default=v},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importStar(r(4)),i=n.__importDefault(r(3)),a=n.__importDefault(r(8)),s=n.__importStar(r(1)),c=r(1);t.default=function(e,t,r,n,u,l,f){var d=new Headers(n||{}),h=e?e.toUpperCase():s.isEmptyArg(l)?"GET":"POST",p=new AbortController,m=setTimeout((function(){p.abort(),f(new o.PartialErrorInfo("Request timed out",null,408))}),t?t.options.timeouts.httpRequestTimeout:a.default.TIMEOUTS.httpRequestTimeout),y={method:h,headers:d,body:l};i.default.Config.isWebworker||(y.credentials=d.has("authorization")?"include":"same-origin"),(0,c.getGlobalObject)().fetch(r+"?"+new URLSearchParams(u||{}),y).then((function(e){clearTimeout(m);var t=e.headers.get("Content-Type");(t&&t.indexOf("application/x-msgpack")>-1?e.arrayBuffer():t&&t.indexOf("application/json")>-1?e.json():e.text()).then((function(r){var n=!!t&&-1===t.indexOf("application/x-msgpack");if(e.ok)f(null,r,e.headers,n,e.status);else{var a=function(e,t){if(function(e,t){return!!t.get("x-ably-errorcode")}(0,t))return e.error&&o.default.fromValues(e.error)}(r,e.headers)||new o.PartialErrorInfo("Error response received from server: "+e.status+" body was: "+i.default.Config.inspect(r),null,e.status);f(a,r,e.headers,n,e.status)}}))})).catch((function(e){clearTimeout(m),f(e)}))}},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=n.__importDefault(r(41)),i=n.__importStar(r(1)).getGlobalObject();"undefined"==typeof Window&&"undefined"==typeof WorkerGlobalScope&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");var a,s=i.navigator&&i.navigator.userAgent.toString(),c={agent:"browser",logTimestamps:!0,userAgent:s,currentUrl:i.location&&i.location.href,noUpgrade:s&&!!s.match(/MSIE\s8\.0/),binaryType:"arraybuffer",WebSocket:i.WebSocket,fetchSupported:!!i.fetch,xhrSupported:i.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,jsonpSupported:"undefined"!=typeof document,allowComet:(a=i.location,!i.WebSocket||!a||!a.origin||a.origin.indexOf("http")>-1),streamingSupported:!0,useProtocolHeartbeats:!0,createHmac:null,msgpack:o.default,supportsBinary:!!i.TextDecoder,preferBinary:!1,ArrayBuffer:i.ArrayBuffer,atob:i.atob,nextTick:void 0!==i.setImmediate?i.setImmediate.bind(i):function(e){setTimeout(e,0)},addEventListener:i.addEventListener,inspect:JSON.stringify,stringByteSize:function(e){return i.TextDecoder&&(new i.TextEncoder).encode(e).length||e.length},TextEncoder:i.TextEncoder,TextDecoder:i.TextDecoder,Promise:i.Promise,getRandomValues:function(e){if(void 0!==e)return function(t,r){e.getRandomValues(t),r&&r(null)}}(i.crypto||msCrypto)};t.default=c},function(e,t,r){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0).__importStar(r(1)),o="ablyjs-storage-test",i=function(){function t(){try{e.sessionStorage.setItem(o,o),e.sessionStorage.removeItem(o),this.sessionSupported=!0}catch(e){this.sessionSupported=!1}try{e.localStorage.setItem(o,o),e.localStorage.removeItem(o),this.localSupported=!0}catch(e){this.localSupported=!1}}return t.prototype.get=function(e){return this._get(e,!1)},t.prototype.getSession=function(e){return this._get(e,!0)},t.prototype.remove=function(e){return this._remove(e,!1)},t.prototype.removeSession=function(e){return this._remove(e,!0)},t.prototype.set=function(e,t,r){return this._set(e,t,r,!1)},t.prototype.setSession=function(e,t,r){return this._set(e,t,r,!0)},t.prototype._set=function(e,t,r,o){var i={value:t};return r&&(i.expires=n.now()+r),this.storageInterface(o).setItem(e,JSON.stringify(i))},t.prototype._get=function(e,t){if(t&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!t&&!this.localSupported)throw new Error("Local Storage not supported");var r=this.storageInterface(t).getItem(e);if(!r)return null;var o=JSON.parse(r);return o.expires&&o.expires<n.now()?(this.storageInterface(t).removeItem(e),null):o.value},t.prototype._remove=function(e,t){return this.storageInterface(t).removeItem(e)},t.prototype.storageInterface=function(t){return t?e.sessionStorage:e.localStorage},t}();t.default=new i}).call(this,r(13))},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r(0).__importDefault(r(67)),o={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",jsonpInternetUpUrl:"https://internet-up.ably-realtime.com/is-the-internet-up-0-9.js",defaultTransports:[n.default.XhrPolling,n.default.XhrStreaming,n.default.JsonP,n.default.WebSocket],baseTransportOrder:[n.default.XhrPolling,n.default.XhrStreaming,n.default.JsonP,n.default.WebSocket],transportPreferenceOrder:[n.default.JsonP,n.default.XhrPolling,n.default.XhrStreaming,n.default.WebSocket],upgradeTransports:[n.default.XhrStreaming,n.default.WebSocket]};t.default=o},function(e,t,r){var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.WebSocket="web_socket",e.Comet="comet",e.XhrStreaming="xhr_streaming",e.XhrPolling="xhr_polling",e.JsonP="jsonp"}(n||(n={})),t.default=n},function(e,t,r){r.r(t);var n=r(29),o=r.n(n),i=r(1),a=r(3),s=r.n(a),c=r(12),u=r.n(c),l=r(16),f=r.n(l),d=function(e){function t(e,t,r){r.stream=!1,u.a.call(this,e,t,r),this.shortName="xhr_polling"}return i.inherits(t,u.a),t.isAvailable=function(){return s.a.Config.xhrSupported&&s.a.Config.allowComet},t.prototype.toString=function(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},t.prototype.createRequest=function(e,t,r,n,o){return f.a.createRequest(e,t,r,n,o,this.timeouts)},void 0!==e&&t.isAvailable()&&(e.supportedTransports.xhr_polling=t),t},h=function(e){function t(e,t,r){u.a.call(this,e,t,r),this.shortName="xhr_streaming"}return i.inherits(t,u.a),t.isAvailable=function(){return s.a.Config.xhrSupported&&s.a.Config.streamingSupported&&s.a.Config.allowComet},t.prototype.toString=function(){return"XHRStreamingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected},t.prototype.createRequest=function(e,t,r,n,o){return f.a.createRequest(e,t,r,n,o,this.timeouts)},void 0!==e&&t.isAvailable()&&(e.supportedTransports.xhr_streaming=t),t};t.default=[o.a,d,h]}]).default},"object"===(void 0===r?"undefined":n(r))&&"object"===(void 0===t?"undefined":n(t))?t.exports=i():"function"==typeof define&&define.amd?define([],i):"object"===(void 0===r?"undefined":n(r))?r.Ably=i():o.Ably=i()}).call(this)}).call(this,e("buffer").Buffer)},{buffer:75}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.all=r.VERSION=r.HttpStatusCode=r.CanceledError=r.CancelToken=r.Cancel=r.AxiosHeaders=r.AxiosError=r.Axios=void 0,Object.defineProperty(r,"default",{enumerable:!0,get:function(){return o.default}}),r.toFormData=r.spread=r.mergeConfig=r.isCancel=r.isAxiosError=r.getAdapter=r.formToJSON=void 0;var n,o=(n=e("./lib/axios.js"))&&n.__esModule?n:{default:n};r.Axios=o.default.Axios,r.AxiosError=o.default.AxiosError,r.CanceledError=o.default.CanceledError,r.isCancel=o.default.isCancel,r.CancelToken=o.default.CancelToken,r.VERSION=o.default.VERSION,r.all=o.default.all,r.Cancel=o.default.Cancel,r.isAxiosError=o.default.isAxiosError,r.spread=o.default.spread,r.toFormData=o.default.toFormData,r.AxiosHeaders=o.default.AxiosHeaders,r.HttpStatusCode=o.default.HttpStatusCode,r.formToJSON=o.default.formToJSON,r.getAdapter=o.default.getAdapter,r.mergeConfig=o.default.mergeConfig},{"./lib/axios.js":28}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=c(e("../utils.js")),o=c(e("./http.js")),i=c(e("./xhr.js")),a=c(e("./fetch.js")),s=c(e("../core/AxiosError.js"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var f={http:o.default,xhr:i.default,fetch:a.default};n.default.forEach(f,(function(e,t){if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));var d=function(e){return"- ".concat(e)},h=function(e){return n.default.isFunction(e)||null===e||!1===e};r.default={getAdapter:function(e){for(var t,r,o=(e=n.default.isArray(e)?e:[e]).length,i={},a=0;a<o;a++){var c=void 0;if(r=t=e[a],!h(t)&&void 0===(r=f[(c=String(t)).toLowerCase()]))throw new s.default("Unknown adapter '".concat(c,"'"));if(r)break;i[c||"#"+a]=r}if(!r){var l=Object.entries(i).map((function(e){var t=u(e,2),r=t[0],n=t[1];return"adapter ".concat(r," ")+(!1===n?"is not supported by the environment":"is not available in the build")})),p=o?l.length>1?"since :\n"+l.map(d).join("\n"):" "+d(l[0]):"as no adapter specified";throw new s.default("There is no suitable adapter to dispatch the request "+p,"ERR_NOT_SUPPORT")}return r},adapters:f}},{"../core/AxiosError.js":33,"../utils.js":73,"./fetch.js":26,"./http.js":55,"./xhr.js":27}],26:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=h(e("../platform/index.js")),i=h(e("../utils.js")),a=h(e("../core/AxiosError.js")),s=h(e("../helpers/composeSignals.js")),c=e("../helpers/trackStream.js"),u=h(e("../core/AxiosHeaders.js")),l=e("../helpers/progressEventReducer.js"),f=h(e("../helpers/resolveConfig.js")),d=h(e("../core/settle.js"));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){var o;return o=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(o)?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */b=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new T(n||[]);return i(a,"_invoke",{value:A(e,r,s)}),a}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var h="suspendedStart",p="executing",m="completed",y={};function g(){}function v(){}function w(){}var _={};l(_,s,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&o.call(S,s)&&(_=S);var E=w.prototype=g.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=d(e[i],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var a;i(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function A(t,r,n){var o=h;return function(i,a){if(o===p)throw new Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===y)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var u=d(t,r,n);if("normal"===u.type){if(o=n.done?m:"suspendedYield",u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=d(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[s];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=l(w,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),l(C.prototype,c,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),l(E,u,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}function w(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function _(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){w(i,n,o,a,s,"next",e)}function s(e){w(i,n,o,a,s,"throw",e)}a(void 0)}))}}var O,S,E="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,k=E&&"function"==typeof ReadableStream,C=E&&("function"==typeof TextEncoder?(O=new TextEncoder,function(e){return O.encode(e)}):function(){var e=_(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Uint8Array,e.next=3,new Response(t).arrayBuffer();case 3:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),A=function(e){try{for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return!!e.apply(void 0,r)}catch(e){return!1}},x=k&&A((function(){var e=!1,t=new Request(o.default.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),j=k&&A((function(){return i.default.isReadableStream(new Response("").body)})),R={stream:j&&function(e){return e.body}};E&&(S=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((function(e){!R[e]&&(R[e]=i.default.isFunction(S[e])?function(t){return t[e]()}:function(t,r){throw new a.default("Response type '".concat(e,"' is not supported"),a.default.ERR_NOT_SUPPORT,r)})})));var T=function(){var e=_(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return",0);case 2:if(!i.default.isBlob(t)){e.next=4;break}return e.abrupt("return",t.size);case 4:if(!i.default.isSpecCompliantForm(t)){e.next=8;break}return e.next=7,new Request(t).arrayBuffer();case 7:return e.abrupt("return",e.sent.byteLength);case 8:if(!i.default.isArrayBufferView(t)&&!i.default.isArrayBuffer(t)){e.next=10;break}return e.abrupt("return",t.byteLength);case 10:if(i.default.isURLSearchParams(t)&&(t+=""),!i.default.isString(t)){e.next=15;break}return e.next=14,C(t);case 14:return e.abrupt("return",e.sent.byteLength);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=_(b().mark((function e(t,r){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.default.toFiniteNumber(t.getContentLength()),e.abrupt("return",null==n?T(r):n);case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();r.default=E&&function(){var e=_(b().mark((function e(t){var r,n,o,h,p,y,v,w,_,O,S,E,k,A,T,P,L,M,U,D,N,B,F,G,q,H,z,V,W,J,K,Q,X,Y,$,Z,ee;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,f.default)(t),n=r.url,o=r.method,h=r.data,p=r.signal,y=r.cancelToken,v=r.timeout,w=r.onDownloadProgress,_=r.onUploadProgress,O=r.responseType,S=r.headers,E=r.withCredentials,k=void 0===E?"same-origin":E,A=r.fetchOptions,O=O?(O+"").toLowerCase():"text",T=p||y||v?(0,s.default)([p,y],v):[],P=g(T,2),L=P[0],M=P[1],N=function(){!U&&setTimeout((function(){L&&L.unsubscribe()})),U=!0},e.prev=4,e.t0=_&&x&&"get"!==o&&"head"!==o,!e.t0){e.next=11;break}return e.next=9,I(S,h);case 9:e.t1=B=e.sent,e.t0=0!==e.t1;case 11:if(!e.t0){e.next=15;break}F=new Request(n,{method:"POST",body:h,duplex:"half"}),i.default.isFormData(h)&&(G=F.headers.get("content-type"))&&S.setContentType(G),F.body&&(q=(0,l.progressEventDecorator)(B,(0,l.progressEventReducer)((0,l.asyncDecorator)(_))),H=g(q,2),z=H[0],V=H[1],h=(0,c.trackStream)(F.body,65536,z,V,C));case 15:return i.default.isString(k)||(k=k?"include":"omit"),D=new Request(n,m(m({},A),{},{signal:L,method:o.toUpperCase(),headers:S.normalize().toJSON(),body:h,duplex:"half",credentials:k})),e.next=19,fetch(D);case 19:return W=e.sent,J=j&&("stream"===O||"response"===O),j&&(w||J)&&(K={},["status","statusText","headers"].forEach((function(e){K[e]=W[e]})),Q=i.default.toFiniteNumber(W.headers.get("content-length")),X=w&&(0,l.progressEventDecorator)(Q,(0,l.progressEventReducer)((0,l.asyncDecorator)(w),!0))||[],Y=g(X,2),$=Y[0],Z=Y[1],W=new Response((0,c.trackStream)(W.body,65536,$,(function(){Z&&Z(),J&&N()}),C),K)),O=O||"text",e.next=25,R[i.default.findKey(R,O)||"text"](W,t);case 25:return ee=e.sent,!J&&N(),M&&M(),e.next=30,new Promise((function(e,r){(0,d.default)(e,r,{data:ee,headers:u.default.from(W.headers),status:W.status,statusText:W.statusText,config:t,request:D})}));case 30:return e.abrupt("return",e.sent);case 33:if(e.prev=33,e.t2=e.catch(4),N(),!e.t2||"TypeError"!==e.t2.name||!/fetch/i.test(e.t2.message)){e.next=38;break}throw Object.assign(new a.default("Network Error",a.default.ERR_NETWORK,t,D),{cause:e.t2.cause||e.t2});case 38:throw a.default.from(e.t2,e.t2&&e.t2.code,t,D);case 39:case"end":return e.stop()}}),e,null,[[4,33]])})));return function(t){return e.apply(this,arguments)}}()},{"../core/AxiosError.js":33,"../core/AxiosHeaders.js":34,"../core/settle.js":39,"../helpers/composeSignals.js":49,"../helpers/progressEventReducer.js":58,"../helpers/resolveConfig.js":59,"../helpers/trackStream.js":65,"../platform/index.js":72,"../utils.js":73}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=h(e("./../utils.js")),o=h(e("./../core/settle.js")),i=h(e("../defaults/transitional.js")),a=h(e("../core/AxiosError.js")),s=h(e("../cancel/CanceledError.js")),c=h(e("../helpers/parseProtocol.js")),u=h(e("../platform/index.js")),l=h(e("../core/AxiosHeaders.js")),f=e("../helpers/progressEventReducer.js"),d=h(e("../helpers/resolveConfig.js"));function h(e){return e&&e.__esModule?e:{default:e}}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var y="undefined"!=typeof XMLHttpRequest;r.default=y&&function(e){return new Promise((function(t,r){var h,m,y,g,v,b=(0,d.default)(e),w=b.data,_=l.default.from(b.headers).normalize(),O=b.responseType,S=b.onUploadProgress,E=b.onDownloadProgress;function k(){g&&g(),v&&v(),b.cancelToken&&b.cancelToken.unsubscribe(h),b.signal&&b.signal.removeEventListener("abort",h)}var C=new XMLHttpRequest;function A(){if(C){var n=l.default.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),i={data:O&&"text"!==O&&"json"!==O?C.response:C.responseText,status:C.status,statusText:C.statusText,headers:n,config:e,request:C};(0,o.default)((function(e){t(e),k()}),(function(e){r(e),k()}),i),C=null}}if(C.open(b.method.toUpperCase(),b.url,!0),C.timeout=b.timeout,"onloadend"in C?C.onloadend=A:C.onreadystatechange=function(){C&&4===C.readyState&&(0!==C.status||C.responseURL&&0===C.responseURL.indexOf("file:"))&&setTimeout(A)},C.onabort=function(){C&&(r(new a.default("Request aborted",a.default.ECONNABORTED,e,C)),C=null)},C.onerror=function(){r(new a.default("Network Error",a.default.ERR_NETWORK,e,C)),C=null},C.ontimeout=function(){var t=b.timeout?"timeout of "+b.timeout+"ms exceeded":"timeout exceeded",n=b.transitional||i.default;b.timeoutErrorMessage&&(t=b.timeoutErrorMessage),r(new a.default(t,n.clarifyTimeoutError?a.default.ETIMEDOUT:a.default.ECONNABORTED,e,C)),C=null},void 0===w&&_.setContentType(null),"setRequestHeader"in C&&n.default.forEach(_.toJSON(),(function(e,t){C.setRequestHeader(t,e)})),n.default.isUndefined(b.withCredentials)||(C.withCredentials=!!b.withCredentials),O&&"json"!==O&&(C.responseType=b.responseType),E){var x=p((0,f.progressEventReducer)(E,!0),2);y=x[0],v=x[1],C.addEventListener("progress",y)}if(S&&C.upload){var j=p((0,f.progressEventReducer)(S),2);m=j[0],g=j[1],C.upload.addEventListener("progress",m),C.upload.addEventListener("loadend",g)}(b.cancelToken||b.signal)&&(h=function(t){C&&(r(!t||t.type?new s.default(null,e,C):t),C.abort(),C=null)},b.cancelToken&&b.cancelToken.subscribe(h),b.signal&&(b.signal.aborted?h():b.signal.addEventListener("abort",h)));var R=(0,c.default)(b.url);R&&-1===u.default.protocols.indexOf(R)?r(new a.default("Unsupported protocol "+R+":",a.default.ERR_BAD_REQUEST,e)):C.send(w||null)}))}},{"../cancel/CanceledError.js":30,"../core/AxiosError.js":33,"../core/AxiosHeaders.js":34,"../defaults/transitional.js":42,"../helpers/parseProtocol.js":57,"../helpers/progressEventReducer.js":58,"../helpers/resolveConfig.js":59,"../platform/index.js":72,"./../core/settle.js":39,"./../utils.js":73}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=w(e("./utils.js")),o=w(e("./helpers/bind.js")),i=w(e("./core/Axios.js")),a=w(e("./core/mergeConfig.js")),s=w(e("./defaults/index.js")),c=w(e("./helpers/formDataToJSON.js")),u=w(e("./cancel/CanceledError.js")),l=w(e("./cancel/CancelToken.js")),f=w(e("./cancel/isCancel.js")),d=e("./env/data.js"),h=w(e("./helpers/toFormData.js")),p=w(e("./core/AxiosError.js")),m=w(e("./helpers/spread.js")),y=w(e("./helpers/isAxiosError.js")),g=w(e("./core/AxiosHeaders.js")),v=w(e("./adapters/adapters.js")),b=w(e("./helpers/HttpStatusCode.js"));function w(e){return e&&e.__esModule?e:{default:e}}var _=function e(t){var r=new i.default(t),s=(0,o.default)(i.default.prototype.request,r);return n.default.extend(s,i.default.prototype,r,{allOwnKeys:!0}),n.default.extend(s,r,null,{allOwnKeys:!0}),s.create=function(r){return e((0,a.default)(t,r))},s}(s.default);_.Axios=i.default,_.CanceledError=u.default,_.CancelToken=l.default,_.isCancel=f.default,_.VERSION=d.VERSION,_.toFormData=h.default,_.AxiosError=p.default,_.Cancel=_.CanceledError,_.all=function(e){return Promise.all(e)},_.spread=m.default,_.isAxiosError=y.default,_.mergeConfig=a.default,_.AxiosHeaders=g.default,_.formToJSON=function(e){return(0,c.default)(n.default.isHTMLForm(e)?new FormData(e):e)},_.getAdapter=v.default.getAdapter,_.HttpStatusCode=b.default,_.default=_;r.default=_},{"./adapters/adapters.js":25,"./cancel/CancelToken.js":29,"./cancel/CanceledError.js":30,"./cancel/isCancel.js":31,"./core/Axios.js":32,"./core/AxiosError.js":33,"./core/AxiosHeaders.js":34,"./core/mergeConfig.js":38,"./defaults/index.js":41,"./env/data.js":43,"./helpers/HttpStatusCode.js":45,"./helpers/bind.js":46,"./helpers/formDataToJSON.js":51,"./helpers/isAxiosError.js":53,"./helpers/spread.js":61,"./helpers/toFormData.js":63,"./utils.js":73}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("./CanceledError.js"))&&n.__esModule?n:{default:n};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:String(t)}var c=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"function"!=typeof t)throw new TypeError("executor must be a function.");var r;this.promise=new Promise((function(e){r=e}));var n=this;this.promise.then((function(e){if(n._listeners){for(var t=n._listeners.length;t-- >0;)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},t((function(e,t,i){n.reason||(n.reason=new o.default(e,t,i),r(n.reason))}))}var t,r,n;return t=e,n=[{key:"source",value:function(){var t;return{token:new e((function(e){t=e})),cancel:t}}}],(r=[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}},{key:"unsubscribe",value:function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=c},{"./CanceledError.js":30}],30:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("../core/AxiosError.js"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r){n.default.call(this,null==e?"canceled":e,n.default.ERR_CANCELED,t,r),this.name="CanceledError"}o(e("../utils.js")).default.inherits(i,n.default,{__CANCEL__:!0});r.default=i},{"../core/AxiosError.js":33,"../utils.js":73}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return!(!e||!e.__CANCEL__)}},{}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=f(e("./../utils.js")),o=f(e("../helpers/buildURL.js")),i=f(e("./InterceptorManager.js")),a=f(e("./dispatchRequest.js")),s=f(e("./mergeConfig.js")),c=f(e("./buildFullPath.js")),u=f(e("../helpers/validator.js")),l=f(e("./AxiosHeaders.js"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */h=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:A(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};u(_,a,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&n.call(S,a)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,i,a,s){var c=f(e[o],e,i);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==d(l)&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=f(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(d(t)+" is not iterable")}return b.prototype=w,o(E,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:b,configurable:!0}),b.displayName=u(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,u(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),u(C.prototype,s,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),u(E,c,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function p(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e,t){if("object"!=d(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==d(t)?t:String(t)}var g=u.default.validators,v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaults=t,this.interceptors={request:new i.default,response:new i.default}}var t,r,f,d,y;return t=e,(r=[{key:"request",value:(d=h().mark((function e(t,r){var n,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._request(t,r);case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),e.t0 instanceof Error){Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error,o=n.stack?n.stack.replace(/^.+\n/,""):"";try{e.t0.stack?o&&!String(e.t0.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(e.t0.stack+="\n"+o):e.t0.stack=o}catch(e){}}throw e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,6]])})),y=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=d.apply(e,t);function i(e){p(o,r,n,i,a,"next",e)}function a(e){p(o,r,n,i,a,"throw",e)}i(void 0)}))},function(e,t){return y.apply(this,arguments)})},{key:"_request",value:function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{};var r=t=(0,s.default)(this.defaults,t),o=r.transitional,i=r.paramsSerializer,c=r.headers;void 0!==o&&u.default.assertOptions(o,{silentJSONParsing:g.transitional(g.boolean),forcedJSONParsing:g.transitional(g.boolean),clarifyTimeoutError:g.transitional(g.boolean)},!1),null!=i&&(n.default.isFunction(i)?t.paramsSerializer={serialize:i}:u.default.assertOptions(i,{encode:g.function,serialize:g.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();var f=c&&n.default.merge(c.common,c[t.method]);c&&n.default.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete c[e]})),t.headers=l.default.concat(f,c);var d=[],h=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(h=h&&e.synchronous,d.unshift(e.fulfilled,e.rejected))}));var p,m=[];this.interceptors.response.forEach((function(e){m.push(e.fulfilled,e.rejected)}));var y,v=0;if(!h){var b=[a.default.bind(this),void 0];for(b.unshift.apply(b,d),b.push.apply(b,m),y=b.length,p=Promise.resolve(t);v<y;)p=p.then(b[v++],b[v++]);return p}y=d.length;var w=t;for(v=0;v<y;){var _=d[v++],O=d[v++];try{w=_(w)}catch(e){O.call(this,e);break}}try{p=a.default.call(this,w)}catch(e){return Promise.reject(e)}for(v=0,y=m.length;v<y;)p=p.then(m[v++],m[v++]);return p}},{key:"getUri",value:function(e){e=(0,s.default)(this.defaults,e);var t=(0,c.default)(e.baseURL,e.url);return(0,o.default)(t,e.params,e.paramsSerializer)}}])&&m(t.prototype,r),f&&m(t,f),Object.defineProperty(t,"prototype",{writable:!1}),e}();n.default.forEach(["delete","get","head","options"],(function(e){v.prototype[e]=function(t,r){return this.request((0,s.default)(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.default.forEach(["post","put","patch"],(function(e){function t(t){return function(r,n,o){return this.request((0,s.default)(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:n}))}}v.prototype[e]=t(),v.prototype[e+"Form"]=t(!0)}));r.default=v},{"../helpers/buildURL.js":47,"../helpers/validator.js":66,"./../utils.js":73,"./AxiosHeaders.js":34,"./InterceptorManager.js":35,"./buildFullPath.js":36,"./dispatchRequest.js":37,"./mergeConfig.js":38}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("../utils.js"))&&n.__esModule?n:{default:n};function i(e,t,r,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),o&&(this.response=o)}o.default.inherits(i,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:o.default.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var a=i.prototype,s={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((function(e){s[e]={value:e}})),Object.defineProperties(i,s),Object.defineProperty(a,"isAxiosError",{value:!0}),i.from=function(e,t,r,n,s,c){var u=Object.create(a);return o.default.toFlatObject(e,u,(function(e){return e!==Error.prototype}),(function(e){return"isAxiosError"!==e})),i.call(u,e.message,t,r,n,s),u.cause=e,u.name=e.name,c&&Object.assign(u,c),u};r.default=i},{"../utils.js":73}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("../utils.js")),o=i(e("../helpers/parseHeaders.js"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:String(t)}var d=Symbol("internals");function h(e){return e&&String(e).trim().toLowerCase()}function p(e){return!1===e||null==e?e:n.default.isArray(e)?e.map(p):String(e)}function m(e,t,r,o,i){return n.default.isFunction(o)?o.call(this,t,r):(i&&(t=r),n.default.isString(t)?n.default.isString(o)?-1!==t.indexOf(o):n.default.isRegExp(o)?o.test(t):void 0:void 0)}var y=function(e,t){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),e&&this.set(e)}var i,a,u;return i=r,u=[{key:"from",value:function(e){return e instanceof this?e:new this(e)}},{key:"concat",value:function(e){for(var t=new this(e),r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return n.forEach((function(e){return t.set(e)})),t}},{key:"accessor",value:function(e){var t=(this[d]=this[d]={accessors:{}}).accessors,r=this.prototype;function o(e){var o=h(e);t[o]||(function(e,t){var r=n.default.toCamelCase(" "+t);["get","set","has"].forEach((function(n){Object.defineProperty(e,n+r,{value:function(e,r,o){return this[n].call(this,t,e,r,o)},configurable:!0})}))}(r,e),t[o]=!0)}return n.default.isArray(e)?e.forEach(o):o(e),this}}],(a=[{key:"set",value:function(e,t,r){var i=this;function a(e,t,r){var o=h(t);if(!o)throw new Error("header name must be a non-empty string");var a=n.default.findKey(i,o);(!a||void 0===i[a]||!0===r||void 0===r&&!1!==i[a])&&(i[a||t]=p(e))}var u=function(e,t){return n.default.forEach(e,(function(e,r){return a(e,r,t)}))};if(n.default.isPlainObject(e)||e instanceof this.constructor)u(e,t);else if(n.default.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))u((0,o.default)(e),t);else if(n.default.isHeaders(e)){var l,f=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(e.entries());try{for(f.s();!(l=f.n()).done;){var d=s(l.value,2),m=d[0];a(d[1],m,r)}}catch(e){f.e(e)}finally{f.f()}}else null!=e&&a(t,e,r);return this}},{key:"get",value:function(e,t){if(e=h(e)){var r=n.default.findKey(this,e);if(r){var o=this[r];if(!t)return o;if(!0===t)return function(e){for(var t,r=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;t=n.exec(e);)r[t[1]]=t[2];return r}(o);if(n.default.isFunction(t))return t.call(this,o,r);if(n.default.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(e,t){if(e=h(e)){var r=n.default.findKey(this,e);return!(!r||void 0===this[r]||t&&!m(0,this[r],r,t))}return!1}},{key:"delete",value:function(e,t){var r=this,o=!1;function i(e){if(e=h(e)){var i=n.default.findKey(r,e);!i||t&&!m(0,r[i],i,t)||(delete r[i],o=!0)}}return n.default.isArray(e)?e.forEach(i):i(e),o}},{key:"clear",value:function(e){for(var t=Object.keys(this),r=t.length,n=!1;r--;){var o=t[r];e&&!m(0,this[o],o,e,!0)||(delete this[o],n=!0)}return n}},{key:"normalize",value:function(e){var t=this,r={};return n.default.forEach(this,(function(o,i){var a=n.default.findKey(r,i);if(a)return t[a]=p(o),void delete t[i];var s=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(function(e,t,r){return t.toUpperCase()+r}))}(i):String(i).trim();s!==i&&delete t[i],t[s]=p(o),r[s]=!0})),this}},{key:"concat",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.constructor).concat.apply(e,[this].concat(r))}},{key:"toJSON",value:function(e){var t=Object.create(null);return n.default.forEach(this,(function(r,o){null!=r&&!1!==r&&(t[o]=e&&n.default.isArray(r)?r.join(", "):r)})),t}},{key:e,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map((function(e){var t=s(e,2);return t[0]+": "+t[1]})).join("\n")}},{key:t,get:function(){return"AxiosHeaders"}}])&&l(i.prototype,a),u&&l(i,u),Object.defineProperty(i,"prototype",{writable:!1}),r}(Symbol.iterator,Symbol.toStringTag);y.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),n.default.reduceDescriptors(y.prototype,(function(e,t){var r=e.value,n=t[0].toUpperCase()+t.slice(1);return{get:function(){return r},set:function(e){this[n]=e}}})),n.default.freezeMethods(y);r.default=y},{"../helpers/parseHeaders.js":56,"../utils.js":73}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("./../utils.js"))&&n.__esModule?n:{default:n};function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:String(t)}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handlers=[]}var t,r,n;return t=e,(r=[{key:"use",value:function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){o.default.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}])&&a(t.prototype,r),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();r.default=c},{"./../utils.js":73}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){if(e&&!(0,n.default)(t))return(0,o.default)(e,t);return t};var n=i(e("../helpers/isAbsoluteURL.js")),o=i(e("../helpers/combineURLs.js"));function i(e){return e&&e.__esModule?e:{default:e}}},{"../helpers/combineURLs.js":48,"../helpers/isAbsoluteURL.js":52}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){l(e),e.headers=s.default.from(e.headers),e.data=n.default.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return c.default.getAdapter(e.adapter||i.default.adapter)(e).then((function(t){return l(e),t.data=n.default.call(e,e.transformResponse,t),t.headers=s.default.from(t.headers),t}),(function(t){return(0,o.default)(t)||(l(e),t&&t.response&&(t.response.data=n.default.call(e,e.transformResponse,t.response),t.response.headers=s.default.from(t.response.headers))),Promise.reject(t)}))};var n=u(e("./transformData.js")),o=u(e("../cancel/isCancel.js")),i=u(e("../defaults/index.js")),a=u(e("../cancel/CanceledError.js")),s=u(e("../core/AxiosHeaders.js")),c=u(e("../adapters/adapters.js"));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new a.default(null,e)}},{"../adapters/adapters.js":25,"../cancel/CanceledError.js":30,"../cancel/isCancel.js":31,"../core/AxiosHeaders.js":34,"../defaults/index.js":41,"./transformData.js":40}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){t=t||{};var r={};function o(e,t,r){return n.default.isPlainObject(e)&&n.default.isPlainObject(t)?n.default.merge.call({caseless:r},e,t):n.default.isPlainObject(t)?n.default.merge({},t):n.default.isArray(t)?t.slice():t}function i(e,t,r){return n.default.isUndefined(t)?n.default.isUndefined(e)?void 0:o(void 0,e,r):o(e,t,r)}function a(e,t){if(!n.default.isUndefined(t))return o(void 0,t)}function s(e,t){return n.default.isUndefined(t)?n.default.isUndefined(e)?void 0:o(void 0,e):o(void 0,t)}function c(r,n,i){return i in t?o(r,n):i in e?o(void 0,r):void 0}var l={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:c,headers:function(e,t){return i(u(e),u(t),!0)}};return n.default.forEach(Object.keys(Object.assign({},e,t)),(function(o){var a=l[o]||i,s=a(e[o],t[o],o);n.default.isUndefined(s)&&a!==c||(r[o]=s)})),r};var n=i(e("../utils.js")),o=i(e("./AxiosHeaders.js"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e,t,r){var n;return n=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==a(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=function(e){return e instanceof o.default?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e):e}},{"../utils.js":73,"./AxiosHeaders.js":34}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(new o.default("Request failed with status code "+r.status,[o.default.ERR_BAD_REQUEST,o.default.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r)):e(r)};var n,o=(n=e("./AxiosError.js"))&&n.__esModule?n:{default:n}},{"./AxiosError.js":33}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r=this||o.default,a=t||r,s=i.default.from(a.headers),c=a.data;return n.default.forEach(e,(function(e){c=e.call(r,c,s.normalize(),t?t.status:void 0)})),s.normalize(),c};var n=a(e("./../utils.js")),o=a(e("../defaults/index.js")),i=a(e("../core/AxiosHeaders.js"));function a(e){return e&&e.__esModule?e:{default:e}}},{"../core/AxiosHeaders.js":34,"../defaults/index.js":41,"./../utils.js":73}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=l(e("../utils.js")),o=l(e("../core/AxiosError.js")),i=l(e("./transitional.js")),a=l(e("../helpers/toFormData.js")),s=l(e("../helpers/toURLEncodedForm.js")),c=l(e("../platform/index.js")),u=l(e("../helpers/formDataToJSON.js"));function l(e){return e&&e.__esModule?e:{default:e}}var f={transitional:i.default,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){var r,o=t.getContentType()||"",i=o.indexOf("application/json")>-1,c=n.default.isObject(e);if(c&&n.default.isHTMLForm(e)&&(e=new FormData(e)),n.default.isFormData(e))return i?JSON.stringify((0,u.default)(e)):e;if(n.default.isArrayBuffer(e)||n.default.isBuffer(e)||n.default.isStream(e)||n.default.isFile(e)||n.default.isBlob(e)||n.default.isReadableStream(e))return e;if(n.default.isArrayBufferView(e))return e.buffer;if(n.default.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(c){if(o.indexOf("application/x-www-form-urlencoded")>-1)return(0,s.default)(e,this.formSerializer).toString();if((r=n.default.isFileList(e))||o.indexOf("multipart/form-data")>-1){var l=this.env&&this.env.FormData;return(0,a.default)(r?{"files[]":e}:e,l&&new l,this.formSerializer)}}return c||i?(t.setContentType("application/json",!1),function(e,t,r){if(n.default.isString(e))try{return(t||JSON.parse)(e),n.default.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||f.transitional,r=t&&t.forcedJSONParsing,i="json"===this.responseType;if(n.default.isResponse(e)||n.default.isReadableStream(e))return e;if(e&&n.default.isString(e)&&(r&&!this.responseType||i)){var a=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(e){if(a){if("SyntaxError"===e.name)throw o.default.from(e,o.default.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:c.default.classes.FormData,Blob:c.default.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};n.default.forEach(["delete","get","head","post","put","patch"],(function(e){f.headers[e]={}}));r.default=f},{"../core/AxiosError.js":33,"../helpers/formDataToJSON.js":51,"../helpers/toFormData.js":63,"../helpers/toURLEncodedForm.js":64,"../platform/index.js":72,"../utils.js":73,"./transitional.js":42}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},{}],43:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.VERSION=void 0;r.VERSION="1.7.4"},{}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("./toFormData.js"))&&n.__esModule?n:{default:n};function i(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function a(e,t){this._pairs=[],e&&(0,o.default)(e,this,t)}var s=a.prototype;s.append=function(e,t){this._pairs.push([e,t])},s.toString=function(e){var t=e?function(t){return e.call(this,t,i)}:i;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};r.default=a},{"./toFormData.js":63}],45:[function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(i).forEach((function(e){var t=n(e,2),r=t[0],o=t[1];i[o]=r}));r.default=i},{}],46:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return function(){return e.apply(t,arguments)}}},{}],47:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r){if(!t)return e;var i,s=r&&r.encode||a,c=r&&r.serialize;i=c?c(t,r):n.default.isURLSearchParams(t)?t.toString():new o.default(t,r).toString(s);if(i){var u=e.indexOf("#");-1!==u&&(e=e.slice(0,u)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e};var n=i(e("../utils.js")),o=i(e("../helpers/AxiosURLSearchParams.js"));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}},{"../helpers/AxiosURLSearchParams.js":44,"../utils.js":73}],48:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}},{}],49:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("../cancel/CanceledError.js")),o=i(e("../core/AxiosError.js"));function i(e){return e&&e.__esModule?e:{default:e}}r.default=function(e,t){var r,i=new AbortController,a=function(e){if(!r){r=!0,c();var t=e instanceof Error?e:this.reason;i.abort(t instanceof o.default?t:new n.default(t instanceof Error?t.message:t))}},s=t&&setTimeout((function(){a(new o.default("timeout ".concat(t," of ms exceeded"),o.default.ETIMEDOUT))}),t),c=function(){e&&(s&&clearTimeout(s),s=null,e.forEach((function(e){e&&(e.removeEventListener?e.removeEventListener("abort",a):e.unsubscribe(a))})),e=null)};e.forEach((function(e){return e&&e.addEventListener&&e.addEventListener("abort",a)}));var u=i.signal;return u.unsubscribe=c,[u,function(){s&&clearTimeout(s),s=null}]}},{"../cancel/CanceledError.js":30,"../core/AxiosError.js":33}],50:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./../utils.js")),o=i(e("../platform/index.js"));function i(e){return e&&e.__esModule?e:{default:e}}r.default=o.default.hasStandardBrowserEnv?{write:function(e,t,r,o,i,a){var s=[e+"="+encodeURIComponent(t)];n.default.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.default.isString(o)&&s.push("path="+o),n.default.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},{"../platform/index.js":72,"./../utils.js":73}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("../utils.js"))&&n.__esModule?n:{default:n};r.default=function(e){function t(e,r,n,i){var a=e[i++];if("__proto__"===a)return!0;var s=Number.isFinite(+a),c=i>=e.length;return a=!a&&o.default.isArray(n)?n.length:a,c?(o.default.hasOwnProp(n,a)?n[a]=[n[a],r]:n[a]=r,!s):(n[a]&&o.default.isObject(n[a])||(n[a]=[]),t(e,r,n[a],i)&&o.default.isArray(n[a])&&(n[a]=function(e){var t,r,n={},o=Object.keys(e),i=o.length;for(t=0;t<i;t++)n[r=o[t]]=e[r];return n}(n[a])),!s)}if(o.default.isFormData(e)&&o.default.isFunction(e.entries)){var r={};return o.default.forEachEntry(e,(function(e,n){t(function(e){return o.default.matchAll(/\w+|\[(\w*)]/g,e).map((function(e){return"[]"===e[0]?"":e[1]||e[0]}))}(e),n,r,0)})),r}return null}},{"../utils.js":73}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},{}],53:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return o.default.isObject(e)&&!0===e.isAxiosError};var n,o=(n=e("./../utils.js"))&&n.__esModule?n:{default:n}},{"./../utils.js":73}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./../utils.js")),o=i(e("../platform/index.js"));function i(e){return e&&e.__esModule?e:{default:e}}r.default=o.default.hasStandardBrowserEnv?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=o(window.location.href),function(t){var r=n.default.isString(t)?o(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},{"../platform/index.js":72,"./../utils.js":73}],55:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=null},{}],56:[function(e,t,r){"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=((n=e("./../utils.js"))&&n.__esModule?n:{default:n}).default.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);r.default=function(e){var t,r,n,i={};return e&&e.split("\n").forEach((function(e){n=e.indexOf(":"),t=e.substring(0,n).trim().toLowerCase(),r=e.substring(n+1).trim(),!t||i[t]&&o[t]||("set-cookie"===t?i[t]?i[t].push(r):i[t]=[r]:i[t]=i[t]?i[t]+", "+r:r)})),i}},{"./../utils.js":73}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}},{}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.progressEventReducer=r.progressEventDecorator=r.asyncDecorator=void 0;var n=a(e("./speedometer.js")),o=a(e("./throttle.js")),i=a(e("../utils.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,r){var n;return n=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==s(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.progressEventReducer=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0,a=(0,n.default)(50,250);return(0,o.default)((function(r){var n=r.loaded,o=r.lengthComputable?r.total:void 0,s=n-i,u=a(s);i=n;var l=c({loaded:n,total:o,progress:o?n/o:void 0,bytes:s,rate:u||void 0,estimated:u&&o&&n<=o?(o-n)/u:void 0,event:r,lengthComputable:null!=o},t?"download":"upload",!0);e(l)}),r)},r.progressEventDecorator=function(e,t){var r=null!=e;return[function(n){return t[0]({lengthComputable:r,total:e,loaded:n})},t[1]]},r.asyncDecorator=function(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return i.default.asap((function(){return e.apply(void 0,r)}))}}},{"../utils.js":73,"./speedometer.js":60,"./throttle.js":62}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=f(e("../platform/index.js")),o=f(e("../utils.js")),i=f(e("./isURLSameOrigin.js")),a=f(e("./cookies.js")),s=f(e("../core/buildFullPath.js")),c=f(e("../core/mergeConfig.js")),u=f(e("../core/AxiosHeaders.js")),l=f(e("./buildURL.js"));function f(e){return e&&e.__esModule?e:{default:e}}function d(e){return function(e){if(Array.isArray(e))return m(e)}(e)||y(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e){return function(e){if(Array.isArray(e))return e}(e)||y(e)||p(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function y(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.default=function(e){var t,r=(0,c.default)({},e),f=r.data,p=r.withXSRFToken,m=r.xsrfHeaderName,y=r.xsrfCookieName,g=r.headers,v=r.auth;if(r.headers=g=u.default.from(g),r.url=(0,l.default)((0,s.default)(r.baseURL,r.url),e.params,e.paramsSerializer),v&&g.set("Authorization","Basic "+btoa((v.username||"")+":"+(v.password?unescape(encodeURIComponent(v.password)):""))),o.default.isFormData(f))if(n.default.hasStandardBrowserEnv||n.default.hasStandardBrowserWebWorkerEnv)g.setContentType(void 0);else if(!1!==(t=g.getContentType())){var b=h(t?t.split(";").map((function(e){return e.trim()})).filter(Boolean):[]),w=b[0],_=b.slice(1);g.setContentType([w||"multipart/form-data"].concat(d(_)).join("; "))}if(n.default.hasStandardBrowserEnv&&(p&&o.default.isFunction(p)&&(p=p(r)),p||!1!==p&&(0,i.default)(r.url))){var O=m&&y&&a.default.read(y);O&&g.set(m,O)}return r}},{"../core/AxiosHeaders.js":34,"../core/buildFullPath.js":36,"../core/mergeConfig.js":38,"../platform/index.js":72,"../utils.js":73,"./buildURL.js":47,"./cookies.js":50,"./isURLSameOrigin.js":54}],60:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=function(e,t){e=e||10;var r,n=new Array(e),o=new Array(e),i=0,a=0;return t=void 0!==t?t:1e3,function(s){var c=Date.now(),u=o[a];r||(r=c),n[i]=s,o[i]=c;for(var l=a,f=0;l!==i;)f+=n[l++],l%=e;if((i=(i+1)%e)===a&&(a=(a+1)%e),!(c-r<t)){var d=u&&c-u;return d?Math.round(1e3*f/d):void 0}}}},{}],61:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t){return e.apply(null,t)}}},{}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=function(e,t){var r,n,o=0,i=1e3/t,a=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();o=i,r=null,n&&(clearTimeout(n),n=null),e.apply(null,t)};return[function(){for(var e=Date.now(),t=e-o,s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];t>=i?a(c,e):(r=c,n||(n=setTimeout((function(){n=null,a(r)}),i-t)))},function(){return r&&a(r)}]}},{}],63:[function(e,t,r){(function(t){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("../utils.js")),o=a(e("../core/AxiosError.js")),i=a(e("../platform/node/classes/FormData.js"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){return n.default.isPlainObject(e)||n.default.isArray(e)}function u(e){return n.default.endsWith(e,"[]")?e.slice(0,-2):e}function l(e,t,r){return e?e.concat(t).map((function(e,t){return e=u(e),!r&&t?"["+e+"]":e})).join(r?".":""):t}var f=n.default.toFlatObject(n.default,{},null,(function(e){return/^is[A-Z]/.test(e)}));r.default=function(e,r,a){if(!n.default.isObject(e))throw new TypeError("target must be an object");r=r||new(i.default||FormData);var d=(a=n.default.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!n.default.isUndefined(t[e])}))).metaTokens,h=a.visitor||v,p=a.dots,m=a.indexes,y=(a.Blob||"undefined"!=typeof Blob&&Blob)&&n.default.isSpecCompliantForm(r);if(!n.default.isFunction(h))throw new TypeError("visitor must be a function");function g(e){if(null===e)return"";if(n.default.isDate(e))return e.toISOString();if(!y&&n.default.isBlob(e))throw new o.default("Blob is not supported. Use a Buffer instead.");return n.default.isArrayBuffer(e)||n.default.isTypedArray(e)?y&&"function"==typeof Blob?new Blob([e]):t.from(e):e}function v(e,t,o){var i=e;if(e&&!o&&"object"===s(e))if(n.default.endsWith(t,"{}"))t=d?t:t.slice(0,-2),e=JSON.stringify(e);else if(n.default.isArray(e)&&function(e){return n.default.isArray(e)&&!e.some(c)}(e)||(n.default.isFileList(e)||n.default.endsWith(t,"[]"))&&(i=n.default.toArray(e)))return t=u(t),i.forEach((function(e,o){!n.default.isUndefined(e)&&null!==e&&r.append(!0===m?l([t],o,p):null===m?t:t+"[]",g(e))})),!1;return!!c(e)||(r.append(l(o,t,p),g(e)),!1)}var b=[],w=Object.assign(f,{defaultVisitor:v,convertValue:g,isVisitable:c});if(!n.default.isObject(e))throw new TypeError("data must be an object");return function e(t,o){if(!n.default.isUndefined(t)){if(-1!==b.indexOf(t))throw Error("Circular reference detected in "+o.join("."));b.push(t),n.default.forEach(t,(function(t,i){!0===(!(n.default.isUndefined(t)||null===t)&&h.call(r,t,n.default.isString(i)?i.trim():i,o,w))&&e(t,o?o.concat(i):[i])})),b.pop()}}(e),r}}).call(this)}).call(this,e("buffer").Buffer)},{"../core/AxiosError.js":33,"../platform/node/classes/FormData.js":55,"../utils.js":73,buffer:75}],64:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return(0,o.default)(e,new i.default.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,o){return i.default.isNode&&n.default.isBuffer(e)?(this.append(t,e.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))};var n=a(e("../utils.js")),o=a(e("./toFormData.js")),i=a(e("../platform/index.js"));function a(e){return e&&e.__esModule?e:{default:e}}},{"../platform/index.js":72,"../utils.js":73,"./toFormData.js":63}],65:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&o.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,a,s,c){var u=h(e[i],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&o.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var i;a(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function r(){for(;++i<t.length;)if(o.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function a(e){var t,r;function n(t,r){try{var i=e[t](r),a=i.value,s=a instanceof u;Promise.resolve(s?a.v:a).then((function(r){if(s){var c="return"===t?"return":"next";if(!a.k||r.done)return n(c,r);r=e[c](r).value}o(i.done?"return":"normal",r)}),(function(e){n("throw",e)}))}catch(e){o("throw",e)}}function o(e,o){switch(e){case"return":t.resolve({value:o,done:!0});break;case"throw":t.reject(o);break;default:t.resolve({value:o,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,o){return new Promise((function(i,a){var s={key:e,arg:o,resolve:i,reject:a,next:null};r?r=r.next=s:(t=r=s,n(e,o))}))},"function"!=typeof e.return&&(this.return=void 0)}function s(e){return new u(e,0)}function c(e){var t={},r=!1;function n(t,n){return r=!0,{done:!1,value:new u(n=new Promise((function(r){r(e[t](n))})),1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return r?(r=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(r)throw r=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return r?(r=!1,e):n("return",e)}),t}function u(e,t){this.v=e,this.k=t}function l(e){var t,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new f(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function f(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return(f=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new f(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.trackStream=r.streamChunk=r.readBytes=void 0,a.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},a.prototype.next=function(e){return this._invoke("next",e)},a.prototype.throw=function(e){return this._invoke("throw",e)},a.prototype.return=function(e){return this._invoke("return",e)};var d=r.streamChunk=i().mark((function e(t,r){var n,o,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.byteLength,r&&!(n<r)){e.next=5;break}return e.next=4,t;case 4:return e.abrupt("return");case 5:o=0;case 6:if(!(o<n)){e.next=13;break}return a=o+r,e.next=10,t.slice(o,a);case 10:o=a,e.next=6;break;case 13:case"end":return e.stop()}}),e)})),h=r.readBytes=function(){var e,t=(e=i().mark((function e(t,r,n){var o,a,u,f,h,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=!1,a=!1,e.prev=2,f=l(t);case 4:return e.next=6,s(f.next());case 6:if(!(o=!(h=e.sent).done)){e.next=27;break}if(p=h.value,e.t0=c,e.t1=l,e.t2=d,!ArrayBuffer.isView(p)){e.next=15;break}e.t3=p,e.next=18;break;case 15:return e.next=17,s(n(String(p)));case 17:e.t3=e.sent;case 18:return e.t4=e.t3,e.t5=r,e.t6=(0,e.t2)(e.t4,e.t5),e.t7=(0,e.t1)(e.t6),e.t8=s,e.delegateYield((0,e.t0)(e.t7,e.t8),"t9",24);case 24:o=!1,e.next=4;break;case 27:e.next=33;break;case 29:e.prev=29,e.t10=e.catch(2),a=!0,u=e.t10;case 33:if(e.prev=33,e.prev=34,!o||null==f.return){e.next=38;break}return e.next=38,s(f.return());case 38:if(e.prev=38,!a){e.next=41;break}throw u;case 41:return e.finish(38);case 42:return e.finish(33);case 43:case"end":return e.stop()}}),e,null,[[2,29,33,43],[34,,38,42]])})),function(){return new a(e.apply(this,arguments))});return function(e,r,n){return t.apply(this,arguments)}}();r.trackStream=function(e,t,r,n,a){var s,c=h(e,t,a),u=0,l=function(e){s||(s=!0,n&&n(e))};return new ReadableStream({pull:function(e){return(t=i().mark((function t(){var n,o,a,s,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.next();case 3:if(n=t.sent,o=n.done,a=n.value,!o){t.next=10;break}return l(),e.close(),t.abrupt("return");case 10:s=a.byteLength,r&&(f=u+=s,r(f)),e.enqueue(new Uint8Array(a)),t.next=19;break;case 15:throw t.prev=15,t.t0=t.catch(0),l(t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[0,15]])})),function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function s(e){o(a,n,i,s,c,"next",e)}function c(e){o(a,n,i,s,c,"throw",e)}s(void 0)}))})();var t},cancel:function(e){return l(e),c.return()}},{highWaterMark:2})}},{}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=e("../env/data.js"),i=(n=e("../core/AxiosError.js"))&&n.__esModule?n:{default:n};function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){s[e]=function(r){return a(r)===e||"a"+(t<1?"n ":" ")+e}}));var c={};s.transitional=function(e,t,r){function n(e,t){return"[Axios v"+o.VERSION+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,o,a){if(!1===e)throw new i.default(n(o," has been removed"+(t?" in "+t:"")),i.default.ERR_DEPRECATED);return t&&!c[o]&&(c[o]=!0,console.warn(n(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,o,a)}};r.default={assertOptions:function(e,t,r){if("object"!==a(e))throw new i.default("options must be an object",i.default.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(e),o=n.length;o-- >0;){var s=n[o],c=t[s];if(c){var u=e[s],l=void 0===u||c(u,s,e);if(!0!==l)throw new i.default("option "+s+" must be "+l,i.default.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new i.default("Unknown option "+s,i.default.ERR_BAD_OPTION)}},validators:s}},{"../core/AxiosError.js":33,"../env/data.js":43}],67:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="undefined"!=typeof Blob?Blob:null},{}],68:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="undefined"!=typeof FormData?FormData:null},{}],69:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("../../../helpers/AxiosURLSearchParams.js"))&&n.__esModule?n:{default:n};r.default="undefined"!=typeof URLSearchParams?URLSearchParams:o.default},{"../../../helpers/AxiosURLSearchParams.js":44}],70:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./classes/URLSearchParams.js")),o=a(e("./classes/FormData.js")),i=a(e("./classes/Blob.js"));function a(e){return e&&e.__esModule?e:{default:e}}r.default={isBrowser:!0,classes:{URLSearchParams:n.default,FormData:o.default,Blob:i.default},protocols:["http","https","file","blob","url","data"]}},{"./classes/Blob.js":67,"./classes/FormData.js":68,"./classes/URLSearchParams.js":69}],71:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.origin=r.hasStandardBrowserWebWorkerEnv=r.hasStandardBrowserEnv=r.hasBrowserEnv=void 0;var n,o=r.hasBrowserEnv="undefined"!=typeof window&&"undefined"!=typeof document;r.hasStandardBrowserEnv=(n="undefined"!=typeof navigator&&navigator.product,o&&["ReactNative","NativeScript","NS"].indexOf(n)<0),r.hasStandardBrowserWebWorkerEnv="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,r.origin=o&&window.location.href||"http://localhost"},{}],72:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("./node/index.js"))&&n.__esModule?n:{default:n},i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=s(e)&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var c=o?Object.getOwnPropertyDescriptor(e,i):null;c&&(c.get||c.set)?Object.defineProperty(n,i,c):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}(e("./common/utils.js"));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){var n;return n=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==s(n)?n:String(n))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.default=u(u({},i),o.default)},{"./common/utils.js":71,"./node/index.js":70}],73:[function(e,t,r){(function(t,n,o){(function(){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,a=(i=e("./helpers/bind.js"))&&i.__esModule?i:{default:i};function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var u,l=Object.prototype.toString,f=Object.getPrototypeOf,d=(u=Object.create(null),function(e){var t=l.call(e);return u[t]||(u[t]=t.slice(8,-1).toLowerCase())}),h=function(e){return e=e.toLowerCase(),function(t){return d(t)===e}},p=function(e){return function(t){return c(t)===e}},m=Array.isArray,y=p("undefined");var g=h("ArrayBuffer");var v,b,w=p("string"),_=p("function"),O=p("number"),S=function(e){return null!==e&&"object"===c(e)},E=function(e){if("object"!==d(e))return!1;var t=f(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},k=h("Date"),C=h("File"),A=h("Blob"),x=h("FileList"),j=h("URLSearchParams"),R=["ReadableStream","Request","Response","Headers"].map(h),T=(b=4,function(e){if(Array.isArray(e))return e}(v=R)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(v,b)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(v,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),I=T[0],P=T[1],L=T[2],M=T[3];function U(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.allOwnKeys,a=void 0!==i&&i;if(null!=e)if("object"!==c(e)&&(e=[e]),m(e))for(r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else{var s,u=a?Object.getOwnPropertyNames(e):Object.keys(e),l=u.length;for(r=0;r<l;r++)s=u[r],t.call(null,e[s],s,e)}}function D(e,t){t=t.toLowerCase();for(var r,n=Object.keys(e),o=n.length;o-- >0;)if(t===(r=n[o]).toLowerCase())return r;return null}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:n,B=function(e){return!y(e)&&e!==N};var F,G=(F="undefined"!=typeof Uint8Array&&f(Uint8Array),function(e){return F&&e instanceof F}),q=h("HTMLFormElement"),H=function(e){var t=Object.prototype.hasOwnProperty;return function(e,r){return t.call(e,r)}}(),z=h("RegExp"),V=function(e,t){var r=Object.getOwnPropertyDescriptors(e),n={};U(r,(function(r,o){var i;!1!==(i=t(r,o,e))&&(n[o]=i||r)})),Object.defineProperties(e,n)},W="abcdefghijklmnopqrstuvwxyz",J={DIGIT:"0123456789",ALPHA:W,ALPHA_DIGIT:W+W.toUpperCase()+"0123456789"};var K,Q,X,Y,$=h("AsyncFunction"),Z=(K="function"==typeof o,Q=_(N.postMessage),K?o:Q?(X="axios@".concat(Math.random()),Y=[],N.addEventListener("message",(function(e){var t=e.source,r=e.data;t===N&&r===X&&Y.length&&Y.shift()()}),!1),function(e){Y.push(e),N.postMessage(X,"*")}):function(e){return setTimeout(e)}),ee="undefined"!=typeof queueMicrotask?queueMicrotask.bind(N):void 0!==t&&t.nextTick||Z;r.default={isArray:m,isArrayBuffer:g,isBuffer:function(e){return null!==e&&!y(e)&&null!==e.constructor&&!y(e.constructor)&&_(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:function(e){var t;return e&&("function"==typeof FormData&&e instanceof FormData||_(e.append)&&("formdata"===(t=d(e))||"object"===t&&_(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&g(e.buffer)},isString:w,isNumber:O,isBoolean:function(e){return!0===e||!1===e},isObject:S,isPlainObject:E,isReadableStream:I,isRequest:P,isResponse:L,isHeaders:M,isUndefined:y,isDate:k,isFile:C,isBlob:A,isRegExp:z,isFunction:_,isStream:function(e){return S(e)&&_(e.pipe)},isURLSearchParams:j,isTypedArray:G,isFileList:x,forEach:U,merge:function e(){for(var t=B(this)&&this||{},r=t.caseless,n={},o=function(t,o){var i=r&&D(n,o)||o;E(n[i])&&E(t)?n[i]=e(n[i],t):E(t)?n[i]=e({},t):m(t)?n[i]=t.slice():n[i]=t},i=0,a=arguments.length;i<a;i++)arguments[i]&&U(arguments[i],o);return n},extend:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.allOwnKeys;return U(t,(function(t,n){r&&_(t)?e[n]=(0,a.default)(t,r):e[n]=t}),{allOwnKeys:o}),e},trim:function(e){return e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,r,n){e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:function(e,t,r,n){var o,i,a,s={};if(t=t||{},null==e)return t;do{for(i=(o=Object.getOwnPropertyNames(e)).length;i-- >0;)a=o[i],n&&!n(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==r&&f(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:d,kindOfTest:h,endsWith:function(e,t,r){e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;var n=e.indexOf(t,r);return-1!==n&&n===r},toArray:function(e){if(!e)return null;if(m(e))return e;var t=e.length;if(!O(t))return null;for(var r=new Array(t);t-- >0;)r[t]=e[t];return r},forEachEntry:function(e,t){for(var r,n=(e&&e[Symbol.iterator]).call(e);(r=n.next())&&!r.done;){var o=r.value;t.call(e,o[0],o[1])}},matchAll:function(e,t){for(var r,n=[];null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:q,hasOwnProperty:H,hasOwnProp:H,reduceDescriptors:V,freezeMethods:function(e){V(e,(function(t,r){if(_(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;var n=e[r];_(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=function(){throw Error("Can not rewrite read-only method '"+r+"'")}))}))},toObjectSet:function(e,t){var r={},n=function(e){e.forEach((function(e){r[e]=!0}))};return m(e)?n(e):n(String(e).split(t)),r},toCamelCase:function(e){return e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,r){return t.toUpperCase()+r}))},noop:function(){},toFiniteNumber:function(e,t){return null!=e&&Number.isFinite(e=+e)?e:t},findKey:D,global:N,isContextDefined:B,ALPHABET:J,generateString:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J.ALPHA_DIGIT,r="",n=t.length;e--;)r+=t[Math.random()*n|0];return r},isSpecCompliantForm:function(e){return!!(e&&_(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:function(e){var t=new Array(10);return function e(r,n){if(S(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[n]=r;var o=m(r)?[]:{};return U(r,(function(t,r){var i=e(t,n+1);!y(i)&&(o[r]=i)})),t[n]=void 0,o}}return r}(e,0)},isAsyncFn:$,isThenable:function(e){return e&&(S(e)||_(e))&&_(e.then)&&_(e.catch)},setImmediate:Z,asap:ee}}).call(this)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./helpers/bind.js":46,_process:83,timers:84}],74:[function(e,t,r){"use strict";!function(e){var t="undefined"!=typeof Uint8Array?Uint8Array:Array,r="+".charCodeAt(0),n="/".charCodeAt(0),o="0".charCodeAt(0),i="a".charCodeAt(0),a="A".charCodeAt(0),s="-".charCodeAt(0),c="_".charCodeAt(0);function u(e){var t=e.charCodeAt(0);return t===r||t===s?62:t===n||t===c?63:t<o?-1:t<o+10?t-o+26+26:t<a+26?t-a:t<i+26?t-i+26:void 0}e.toByteArray=function(e){var r,n,o,i,a,s;if(e.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=e.length;a="="===e.charAt(c-2)?2:"="===e.charAt(c-1)?1:0,s=new t(3*e.length/4-a),o=a>0?e.length-4:e.length;var l=0;function f(e){s[l++]=e}for(r=0,n=0;r<o;r+=4,n+=3)f((16711680&(i=u(e.charAt(r))<<18|u(e.charAt(r+1))<<12|u(e.charAt(r+2))<<6|u(e.charAt(r+3))))>>16),f((65280&i)>>8),f(255&i);return 2===a?f(255&(i=u(e.charAt(r))<<2|u(e.charAt(r+1))>>4)):1===a&&(f((i=u(e.charAt(r))<<10|u(e.charAt(r+1))<<4|u(e.charAt(r+2))>>2)>>8&255),f(255&i)),s},e.fromByteArray=function(e){var t,r,n,o,i=e.length%3,a="";function s(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,n=e.length-i;t<n;t+=3)r=(e[t]<<16)+(e[t+1]<<8)+e[t+2],a+=s((o=r)>>18&63)+s(o>>12&63)+s(o>>6&63)+s(63&o);switch(i){case 1:a+=s((r=e[e.length-1])>>2),a+=s(r<<4&63),a+="==";break;case 2:a+=s((r=(e[e.length-2]<<8)+e[e.length-1])>>10),a+=s(r>>4&63),a+=s(r<<2&63),a+="="}return a}}(void 0===r?(void 0).base64js={}:r)},{}],75:[function(e,t,r){(function(t){(function(){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=e("base64-js"),o=e("ieee754");r.Buffer=a,r.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},r.INSPECT_MAX_BYTES=50;function i(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=a.prototype,t}function a(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return s(e,t,r)}function s(e,r,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|d(e,t),n=i(r),o=n.write(e,t);o!==r&&(n=n.slice(0,o));return n}(e,r);if(ArrayBuffer.isView(e))return l(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+t(e));if(B(e,ArrayBuffer)||e&&B(e.buffer,ArrayBuffer))return function(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r);return n.__proto__=a.prototype,n}(e,r,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var o=e.valueOf&&e.valueOf();if(null!=o&&o!==e)return a.from(o,r,n);var s=function(e){if(a.isBuffer(e)){var t=0|f(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||F(e.length)?i(0):l(e);if("Buffer"===e.type&&Array.isArray(e.data))return l(e.data)}(e);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),r,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+t(e))}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),i(e<0?0:0|f(e))}function l(e){for(var t=e.length<0?0:0|f(e.length),r=i(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function d(e,r){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||B(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+t(e));var n=e.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===n)return 0;for(var i=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return D(e).length;default:if(i)return o?-1:U(e).length;r=(""+r).toLowerCase(),i=!0}}function h(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return k(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),F(r=+r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,o){var i,a=1,s=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var l=-1;for(i=r;i<s;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(r+c>s&&(r=s-c),i=r;i>=0;i--){for(var f=!0,d=0;d<c;d++)if(u(e,i+d)!==u(t,d)){f=!1;break}if(f)return i}return-1}function g(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(F(s))return a;e[r+a]=s}return a}function v(e,t,r,n){return N(U(t,e.length-r),e,r,n)}function b(e,t,r,n){return N(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return b(e,t,r,n)}function _(e,t,r,n){return N(D(t),e,r,n)}function O(e,t,r,n){return N(function(e,t){for(var r,n,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function S(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,a,s,c,u=e[o],l=null,f=u>239?4:u>223?3:u>191?2:1;if(o+f<=r)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}r.kMaxLength=2147483647,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,a.alloc=function(e,t,r){return function(e,t,r){return c(e),e<=0?i(e):void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)}(e,t,r)},a.allocUnsafe=function(e){return u(e)},a.allocUnsafeSlow=function(e){return u(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(B(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),B(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var i=e[r];if(B(i,Uint8Array)&&(i=a.from(i)),!a.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},a.byteLength=d,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):h.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},a.prototype.compare=function(e,r,n,o,i){if(B(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+t(e));if(void 0===r&&(r=0),void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===i&&(i=this.length),r<0||n>e.length||o<0||i>this.length)throw new RangeError("out of range index");if(o>=i&&r>=n)return 0;if(o>=i)return-1;if(r>=n)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(o>>>=0),c=(n>>>=0)-(r>>>=0),u=Math.min(s,c),l=this.slice(o,i),f=e.slice(r,n),d=0;d<u;++d)if(l[d]!==f[d]){s=l[d],c=f[d];break}return s<c?-1:c<s?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return g(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":return b(this,e,t,r);case"latin1":case"binary":return w(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function A(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=M(e[i]);return o}function x(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function j(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,o,i){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function T(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function I(e,t,r,n,i){return t=+t,r>>>=0,i||T(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function P(e,t,r,n,i){return t=+t,r>>>=0,i||T(e,0,r,8),o.write(e,t,r,n,52,8),r+8}a.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=a.prototype,n},a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},a.prototype.readUInt8=function(e,t){return e>>>=0,t||j(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||j(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||j(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||j(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},a.prototype.readInt8=function(e,t){return e>>>=0,t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||j(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||j(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return e>>>=0,t||j(e,4,this.length),o.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||j(e,4,this.length),o.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||j(e,8,this.length),o.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||j(e,8,this.length),o.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);R(this,e,t,r,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);R(this,e,t,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeFloatLE=function(e,t,r){return I(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return I(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return P(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return P(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var i=o-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return o},a.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var o=e.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(e=o)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),c=s.length;if(0===c)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%c]}return this};var L=/[^+/0-9A-Za-z-_]/g;function M(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function D(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(L,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function N(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function B(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function F(e){return e!=e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":74,buffer:75,ieee754:78}],76:[function(e,t,r){(function(n){(function(){"use strict";var o;r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(o=n))})),e.splice(o,0,r)},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){var e;try{e=r.storage.getItem("debug")}catch(e){}!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG);return e},r.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},r.storage=function(){try{return localStorage}catch(e){}}(),r.destroy=(o=!1,function(){o||(o=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],r.log=console.debug||console.log||function(){},t.exports=e("./common")(r),t.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this)}).call(this,e("_process"))},{"./common":77,_process:83}],77:[function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}t.exports=function(t){function r(e){var t,n,i,a=null;function s(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];if(s.enabled){var i=s,a=Number(new Date),c=a-(t||a);i.diff=c,i.prev=t,i.curr=a,t=a,n[0]=r.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,t){if("%%"===e)return"%";u++;var o=r.formatters[t];if("function"==typeof o){var a=n[u];e=o.call(i,a),n.splice(u,1),u--}return e})),r.formatArgs.call(i,n);var l=i.log||r.log;l.apply(i,n)}}return s.namespace=e,s.useColors=r.useColors(),s.color=r.selectColor(e),s.extend=o,s.destroy=r.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==a?a:(n!==r.namespaces&&(n=r.namespaces,i=r.enabled(e)),i)},set:function(e){a=e}}),"function"==typeof r.init&&r.init(s),s}function o(e,t){var n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},r.disable=function(){var e=[].concat(n(r.names.map(i)),n(r.skips.map(i).map((function(e){return"-"+e})))).join(",");return r.enable(""),e},r.enable=function(e){var t;r.save(e),r.namespaces=e,r.names=[],r.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(t=0;t<o;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.slice(1)+"$")):r.names.push(new RegExp("^"+e+"$")))},r.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=e("ms"),r.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((function(e){r[e]=t[e]})),r.names=[],r.skips=[],r.formatters={},r.selectColor=function(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]},r.enable(r.load()),r}},{ms:82}],78:[function(e,t,r){"use strict";r.read=function(e,t,r,n,o){var i,a,s=8*o-n-1,c=(1<<s)-1,u=c>>1,l=-7,f=r?o-1:0,d=r?-1:1,h=e[t+f];for(f+=d,i=h&(1<<-l)-1,h>>=-l,l+=s;l>0;i=256*i+e[t+f],f+=d,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=n;l>0;a=256*a+e[t+f],f+=d,l-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),i-=u}return(h?-1:1)*a*Math.pow(2,i-n)},r.write=function(e,t,r,n,o,i){var a,s,c,u=8*i-o-1,l=(1<<u)-1,f=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(a++,c/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*c-1)*Math.pow(2,o),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;e[r+h]=255&s,h+=p,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;e[r+h]=255&a,h+=p,a/=256,u-=8);e[r+h-p]|=128*m}},{}],79:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&i.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=h(e[o],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){var o;return o=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==n(o)?o:String(o))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){u(i,n,o,a,s,"next",e)}function s(e){u(i,n,o,a,s,"throw",e)}a(void 0)}))}}var f=e("debug"),d=e("uuid"),h=f("ls-telemetry:config"),p=f("ls-telemetry:report"),m=f("ls-telemetry:main"),y=["filter","alert","classroom","access_scan","browser_helper","network_agent","meta"],g=["filter","alert","classroom","mdm","generic"],v={};function b(){return(b=l(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"==typeof t.agent_type){e.next=2;break}throw"[ls-telemetry] agent_type not set";case 2:if(y.includes(t.agent_type)){e.next=4;break}throw"[ls-telemetry] invalid agent_type";case 4:if("string"==typeof t.product){e.next=6;break}throw"[ls-telemetry] product not set";case 6:if(g.includes(t.product)){e.next=8;break}throw"[ls-telemetry] invalid product";case 8:if("string"==typeof t.agent_version){e.next=10;break}throw"[ls-telemetry] agent_version not set";case 10:if("string"==typeof t.ls_telemetry_key){e.next=12;break}throw"[ls-telemetry] ls_telemetry_key not set";case 12:if("string"==typeof t.ls_telemetry_host){e.next=14;break}throw"[ls-telemetry] ls_telemetry_host not set";case 14:if("string"==typeof t.customer_id){e.next=16;break}throw"[ls-telemetry] customer_id not set";case 16:return e.next=18,A();case 18:v=a(a({},v),t),h("[setConfig] ->",JSON.stringify(v).replace(v.ls_telemetry_key,"********************"));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return _.apply(this,arguments)}function _(){return(_=l(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){chrome.runtime.getPlatformInfo((function(t){h("[getPlatformInfo] ->",t),e(t.os)}))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return S.apply(this,arguments)}function S(){return(S=l(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!chrome.enterprise.deviceAttributes){e.next=4;break}return e.next=3,new Promise((function(e){chrome.enterprise.deviceAttributes.getDeviceSerialNumber((function(t){h("[getDeviceSerialNumber] ->",t),e(t)}))}));case 3:return e.abrupt("return",e.sent);case 4:h("[getDeviceSerialNumber] missing permissions");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return k.apply(this,arguments)}function k(){return(k=l(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!chrome.enterprise.networkingAttributes){e.next=4;break}return e.next=3,new Promise((function(e){chrome.enterprise.networkingAttributes.getNetworkDetails((function(t){chrome.runtime.lastError?(h("runtime.lastError ->",chrome.runtime.lastError.message),e("")):t&&(h("[networkingAttributes] ->",t),e(t.ipv4||t.ipv6))}))}));case 3:return e.abrupt("return",e.sent);case 4:h("[networkingAttributes] missing permissions");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){var e,t=navigator.userAgent;(e=t.match(/Edg\/([0-9.]+)/))?v.browser="edge":(e=t.match(/Firefox\/([0-9.]+)/))?v.browser="firefox":(e=t.match(/Chrome\/([0-9.]+)/))?v.browser="chrome":(e=t.match(/Safari\/([0-9.]+)/))&&(v.browser="safari",(s=t.match(/Version\/([0-9.]+)/))&&(v.safari_version=s[1])),"safari"!==v.browser&&e&&(v["".concat(v.browser,"_version")]=e[1]),h("[getBrowserInfo] ->",v.browser,v["".concat(v.browser,"_version")])}function A(){return x.apply(this,arguments)}function x(){return(x=l(o().mark((function e(){var t,r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:if(t=e.sent,v.os=t,v.device_type="mac"===t?"osx":t,C(),"cros"===t&&(v.os_version=v["".concat(v.browser,"_version")]),!chrome.enterprise){e.next=18;break}return e.next=10,O();case 10:return r=e.sent,v.serial_number=r,e.next=14,E();case 14:n=e.sent,v.internal_address=n,e.next=19;break;case 18:h("[ENTERPRISE API DENIED]");case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.exports={getConfig:function(){return v},getUDID:function(){var e=v.serial_number;return e||(e="ls-udid-".concat(d.v4()),h("[getUDID] generating ->",e)),e},setConfig:function(e){return b.apply(this,arguments)},setUser:function(e){h("[setUser] ->",e),v.user_info={email:e.email,username:e.username,domain:e.domain,upn:e.upn},v.username=e.username,v.udid=e.udid},setPublicIp:function(e){h("[setPublicIp] ->",e),v.external_address=e},reportLog:p,mainLog:m}},{debug:76,uuid:85}],80:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&i.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=h(e[o],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}var s=e("./config"),c=s.getUDID,u=s.setConfig,l=s.setUser,f=s.setPublicIp,d=s.mainLog,h=e("./report").sendReport;function p(){return(p=a(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d("[Init]"),e.next=3,u(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=a(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.exports={GetUDID:function(){return c()},Init:function(e){return p.apply(this,arguments)},SetAgentUser:function(e){l(e)},SetPublicIp:function(e){f(e)},SendReport:function(){return m.apply(this,arguments)}}},{"./config":79,"./report":81}],81:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function(){return t};var e,t={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,r){return e[t]=r}}function d(e,t,r,n){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new T(n||[]);return a(i,"_invoke",{value:A(e,r,s)}),i}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var p="suspendedStart",m="executing",y="completed",g={};function v(){}function b(){}function w(){}var _={};f(_,c,(function(){return this}));var O=Object.getPrototypeOf,S=O&&O(O(I([])));S&&S!==r&&i.call(S,c)&&(_=S);var E=w.prototype=v.prototype=Object.create(_);function k(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(o,a,s,c){var u=h(e[o],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,c)}),(function(e){r("throw",e,s,c)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(e,n){function i(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(i,i):i()}})}function A(t,r,n){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=x(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=m;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?y:"suspendedYield",u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[c];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(i.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return b.prototype=w,a(E,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:b,configurable:!0}),b.displayName=f(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},k(C.prototype),f(C.prototype,u,(function(){return this})),t.AsyncIterator=C,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new C(d(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(E),f(E,l,"Generator"),f(E,c,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}var s,c=e("./config"),u=c.getConfig,l=c.reportLog,f=["chrome_version","customer_id","device_type","edge_version","external_address","firefox_version","internal_address","os","os_version","product","safari_version","serial_number","udid","username","user_info"],d=["agent_type","agent_version","browser","customer_id","os","os_version","product","serial_number","udid","username","user_info"];function h(){return(h=a(o().mark((function e(){var t,r,n,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=u(),t=p(),"string"==typeof s.ls_telemetry_key){e.next=4;break}throw"[ls-telemetry] ls_telemetry_key not set";case 4:if("string"==typeof s.ls_telemetry_host){e.next=6;break}throw"[ls-telemetry] ls_telemetry_host not set";case 6:if("string"==typeof s.customer_id){e.next=8;break}throw"[ls-telemetry] customer_id not set";case 8:return l("[SendReport] report data ->",t),(r=new Headers).append("Content-Type","application/json"),r.append("x-api-key",s.ls_telemetry_key),n={method:"POST",headers:r,body:JSON.stringify(t),redirect:"follow"},e.next=15,fetch("https://"+s.ls_telemetry_host+"/graphql",n).then((function(e){return l("[SendReport] ->",e),e})).catch((function(e){return console.error(e),{ok:!1}}));case 15:return i=e.sent,e.abrupt("return",i);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){var e={query:m(),variables:{agent:g()}};return"cros"===s.os&&(e.variables.meta=function(){var e={agent_type:"meta"};return f.forEach((function(t){e[t]=s[t]})),e}()),e}function m(){var e="cros"===s.os,t="mutation AgentDetails(\n  $agent: PutAgentDetailsInput!\n";return e&&(t+="  $meta: PutAgentDetailsInput!\n"),t+=") {agent:AgentDetails(item: $agent) {"+y("agent"),e&&(t+="  }meta:AgentDetails(item: $meta) {"+y("meta")),t+="  }\n}"}function y(e){var t="\n";return("meta"===e?f:d).forEach((function(e){"user_info"!==e&&(t+="    "+e+"\n")})),t+="    user {\n      email\n      username\n      domain\n      upn\n    }\n"}function g(){var e={};return d.forEach((function(t){e[t]=s[t]})),e}t.exports={sendReport:function(){return h.apply(this,arguments)}}},{"./config":79}],82:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=1e3,i=6e4,a=60*i,s=24*a;function c(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}t.exports=function(e,t){t=t||{};var r=n(e);if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return r*s;case"hours":case"hour":case"hrs":case"hr":case"h":return r*a;case"minutes":case"minute":case"mins":case"min":case"m":return r*i;case"seconds":case"second":case"secs":case"sec":case"s":return r*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}(e);if("number"===r&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=s)return c(e,t,s,"day");if(t>=a)return c(e,t,a,"hour");if(t>=i)return c(e,t,i,"minute");if(t>=o)return c(e,t,o,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=s)return Math.round(e/s)+"d";if(t>=a)return Math.round(e/a)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=o)return Math.round(e/o)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},{}],83:[function(e,t,r){"use strict";var n,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var u,l=[],f=!1,d=-1;function h(){f&&u&&(f=!1,u.length?l=u.concat(l):d=-1,l.length&&p())}function p(){if(!f){var e=c(h);f=!0;for(var t=l.length;t;){for(u=l,l=[];++d<t;)u&&u[d].run();d=-1,t=l.length}u=null,f=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new m(e,t)),1!==l.length||f||c(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],84:[function(e,t,r){(function(t,n){(function(){"use strict";var o=e("process/browser.js").nextTick,i=Function.prototype.apply,a=Array.prototype.slice,s={},c=0;function u(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new u(i.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new u(i.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},u.prototype.unref=u.prototype.ref=function(){},u.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r.setImmediate="function"==typeof t?t:function(e){var t=c++,n=!(arguments.length<2)&&a.call(arguments,1);return s[t]=!0,o((function(){s[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))})),t},r.clearImmediate="function"==typeof n?n:function(e){delete s[e]}}).call(this)}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":83,timers:84}],85:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"NIL",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"parse",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"v1",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(r,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"v5",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"validate",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"version",{enumerable:!0,get:function(){return c.default}});var n=d(e("./v1.js")),o=d(e("./v3.js")),i=d(e("./v4.js")),a=d(e("./v5.js")),s=d(e("./nil.js")),c=d(e("./version.js")),u=d(e("./validate.js")),l=d(e("./stringify.js")),f=d(e("./parse.js"));function d(e){return e&&e.__esModule?e:{default:e}}},{"./nil.js":88,"./parse.js":89,"./stringify.js":93,"./v1.js":94,"./v3.js":95,"./v4.js":97,"./v5.js":98,"./validate.js":99,"./version.js":100}],86:[function(e,t,r){"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function o(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function i(e,t,r,n,i,a){return o((s=o(o(t,e),o(n,a)))<<(c=i)|s>>>32-c,r);var s,c}function a(e,t,r,n,o,a,s){return i(t&r|~t&n,e,t,o,a,s)}function s(e,t,r,n,o,a,s){return i(t&n|r&~n,e,t,o,a,s)}function c(e,t,r,n,o,a,s){return i(t^r^n,e,t,o,a,s)}function u(e,t,r,n,o,a,s){return i(r^(t|~n),e,t,o,a,s)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var l=function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var r=0;r<t.length;++r)e[r]=t.charCodeAt(r)}return function(e){for(var t=[],r=32*e.length,n=0;n<r;n+=8){var o=e[n>>5]>>>n%32&255,i=parseInt("0123456789abcdef".charAt(o>>>4&15)+"0123456789abcdef".charAt(15&o),16);t.push(i)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;for(var r=1732584193,i=-271733879,l=-1732584194,f=271733878,d=0;d<e.length;d+=16){var h=r,p=i,m=l,y=f;r=a(r,i,l,f,e[d],7,-680876936),f=a(f,r,i,l,e[d+1],12,-389564586),l=a(l,f,r,i,e[d+2],17,606105819),i=a(i,l,f,r,e[d+3],22,-1044525330),r=a(r,i,l,f,e[d+4],7,-176418897),f=a(f,r,i,l,e[d+5],12,1200080426),l=a(l,f,r,i,e[d+6],17,-1473231341),i=a(i,l,f,r,e[d+7],22,-45705983),r=a(r,i,l,f,e[d+8],7,1770035416),f=a(f,r,i,l,e[d+9],12,-1958414417),l=a(l,f,r,i,e[d+10],17,-42063),i=a(i,l,f,r,e[d+11],22,-1990404162),r=a(r,i,l,f,e[d+12],7,1804603682),f=a(f,r,i,l,e[d+13],12,-40341101),l=a(l,f,r,i,e[d+14],17,-1502002290),i=a(i,l,f,r,e[d+15],22,1236535329),r=s(r,i,l,f,e[d+1],5,-165796510),f=s(f,r,i,l,e[d+6],9,-1069501632),l=s(l,f,r,i,e[d+11],14,643717713),i=s(i,l,f,r,e[d],20,-373897302),r=s(r,i,l,f,e[d+5],5,-701558691),f=s(f,r,i,l,e[d+10],9,38016083),l=s(l,f,r,i,e[d+15],14,-660478335),i=s(i,l,f,r,e[d+4],20,-405537848),r=s(r,i,l,f,e[d+9],5,568446438),f=s(f,r,i,l,e[d+14],9,-1019803690),l=s(l,f,r,i,e[d+3],14,-187363961),i=s(i,l,f,r,e[d+8],20,1163531501),r=s(r,i,l,f,e[d+13],5,-1444681467),f=s(f,r,i,l,e[d+2],9,-51403784),l=s(l,f,r,i,e[d+7],14,1735328473),i=s(i,l,f,r,e[d+12],20,-1926607734),r=c(r,i,l,f,e[d+5],4,-378558),f=c(f,r,i,l,e[d+8],11,-2022574463),l=c(l,f,r,i,e[d+11],16,1839030562),i=c(i,l,f,r,e[d+14],23,-35309556),r=c(r,i,l,f,e[d+1],4,-1530992060),f=c(f,r,i,l,e[d+4],11,1272893353),l=c(l,f,r,i,e[d+7],16,-155497632),i=c(i,l,f,r,e[d+10],23,-1094730640),r=c(r,i,l,f,e[d+13],4,681279174),f=c(f,r,i,l,e[d],11,-358537222),l=c(l,f,r,i,e[d+3],16,-722521979),i=c(i,l,f,r,e[d+6],23,76029189),r=c(r,i,l,f,e[d+9],4,-640364487),f=c(f,r,i,l,e[d+12],11,-421815835),l=c(l,f,r,i,e[d+15],16,530742520),i=c(i,l,f,r,e[d+2],23,-995338651),r=u(r,i,l,f,e[d],6,-198630844),f=u(f,r,i,l,e[d+7],10,1126891415),l=u(l,f,r,i,e[d+14],15,-1416354905),i=u(i,l,f,r,e[d+5],21,-57434055),r=u(r,i,l,f,e[d+12],6,1700485571),f=u(f,r,i,l,e[d+3],10,-1894986606),l=u(l,f,r,i,e[d+10],15,-1051523),i=u(i,l,f,r,e[d+1],21,-2054922799),r=u(r,i,l,f,e[d+8],6,1873313359),f=u(f,r,i,l,e[d+15],10,-30611744),l=u(l,f,r,i,e[d+6],15,-1560198380),i=u(i,l,f,r,e[d+13],21,1309151649),r=u(r,i,l,f,e[d+4],6,-145523070),f=u(f,r,i,l,e[d+11],10,-1120210379),l=u(l,f,r,i,e[d+2],15,718787259),i=u(i,l,f,r,e[d+9],21,-343485551),r=o(r,h),i=o(i,p),l=o(l,m),f=o(f,y)}return[r,i,l,f]}(function(e){if(0===e.length)return[];for(var t=8*e.length,r=new Uint32Array(n(t)),o=0;o<t;o+=8)r[o>>5]|=(255&e[o/8])<<o%32;return r}(e),8*e.length))};r.default=l},{}],87:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};r.default=n},{}],88:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default="00000000-0000-0000-0000-000000000000"},{}],89:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var i=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};r.default=i},{"./validate.js":99}],90:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],91:[function(e,t,r){"use strict";var n;Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)};var o=new Uint8Array(16)},{}],92:[function(e,t,r){"use strict";function n(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:return t^r^n;case 2:return t&r^t&n^r&n;case 3:return t^r^n}}function o(e,t){return e<<t|e>>>32-t}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){var t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var i=unescape(encodeURIComponent(e));e=[];for(var a=0;a<i.length;++a)e.push(i.charCodeAt(a))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,c=Math.ceil(s/16),u=new Array(c),l=0;l<c;++l){for(var f=new Uint32Array(16),d=0;d<16;++d)f[d]=e[64*l+4*d]<<24|e[64*l+4*d+1]<<16|e[64*l+4*d+2]<<8|e[64*l+4*d+3];u[l]=f}u[c-1][14]=8*(e.length-1)/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=8*(e.length-1)&4294967295;for(var h=0;h<c;++h){for(var p=new Uint32Array(80),m=0;m<16;++m)p[m]=u[h][m];for(var y=16;y<80;++y)p[y]=o(p[y-3]^p[y-8]^p[y-14]^p[y-16],1);for(var g=r[0],v=r[1],b=r[2],w=r[3],_=r[4],O=0;O<80;++O){var S=Math.floor(O/20),E=o(g,5)+n(S,v,b,w)+_+t[S]+p[O]>>>0;_=w,w=b,b=o(v,30)>>>0,v=g,g=E}r[0]=r[0]+g>>>0,r[1]=r[1]+v>>>0,r[2]=r[2]+b>>>0,r[3]=r[3]+w>>>0,r[4]=r[4]+_>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]};r.default=i},{}],93:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.unsafeStringify=s;var n,o=(n=e("./validate.js"))&&n.__esModule?n:{default:n};for(var i=[],a=0;a<256;++a)i.push((a+256).toString(16).slice(1));function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return i[e[t+0]]+i[e[t+1]]+i[e[t+2]]+i[e[t+3]]+"-"+i[e[t+4]]+i[e[t+5]]+"-"+i[e[t+6]]+i[e[t+7]]+"-"+i[e[t+8]]+i[e[t+9]]+"-"+i[e[t+10]]+i[e[t+11]]+i[e[t+12]]+i[e[t+13]]+i[e[t+14]]+i[e[t+15]]}var c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=s(e,t);if(!(0,o.default)(r))throw TypeError("Stringified UUID is invalid");return r};r.default=c},{"./validate.js":99}],94:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o,i,a=(n=e("./rng.js"))&&n.__esModule?n:{default:n},s=e("./stringify.js");var c=0,u=0;var l=function(e,t,r){var n=t&&r||0,l=t||new Array(16),f=(e=e||{}).node||o,d=void 0!==e.clockseq?e.clockseq:i;if(null==f||null==d){var h=e.random||(e.rng||a.default)();null==f&&(f=o=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==d&&(d=i=16383&(h[6]<<8|h[7]))}var p=void 0!==e.msecs?e.msecs:Date.now(),m=void 0!==e.nsecs?e.nsecs:u+1,y=p-c+(m-u)/1e4;if(y<0&&void 0===e.clockseq&&(d=d+1&16383),(y<0||p>c)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=p,u=m,i=d;var g=(1e4*(268435455&(p+=122192928e5))+m)%4294967296;l[n++]=g>>>24&255,l[n++]=g>>>16&255,l[n++]=g>>>8&255,l[n++]=255&g;var v=p/4294967296*1e4&268435455;l[n++]=v>>>8&255,l[n++]=255&v,l[n++]=v>>>24&15|16,l[n++]=v>>>16&255,l[n++]=d>>>8|128,l[n++]=255&d;for(var b=0;b<6;++b)l[n+b]=f[b];return t||(0,s.unsafeStringify)(l)};r.default=l},{"./rng.js":91,"./stringify.js":93}],95:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./v35.js")),o=i(e("./md5.js"));function i(e){return e&&e.__esModule?e:{default:e}}var a=(0,n.default)("v3",48,o.default);r.default=a},{"./md5.js":86,"./v35.js":96}],96:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.URL=r.DNS=void 0,r.default=function(e,t,r){function n(e,n,a,s){var c;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=(0,i.default)(n)),16!==(null===(c=n)||void 0===c?void 0:c.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+e.length);if(u.set(n),u.set(e,n.length),(u=r(u))[6]=15&u[6]|t,u[8]=63&u[8]|128,a){s=s||0;for(var l=0;l<16;++l)a[s+l]=u[l];return a}return(0,o.unsafeStringify)(u)}try{n.name=e}catch(e){}return n.DNS=a,n.URL=s,n};var n,o=e("./stringify.js"),i=(n=e("./parse.js"))&&n.__esModule?n:{default:n};var a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";r.DNS=a;var s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";r.URL=s},{"./parse.js":89,"./stringify.js":93}],97:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./native.js")),o=a(e("./rng.js")),i=e("./stringify.js");function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t,r){if(n.default.randomUUID&&!t&&!e)return n.default.randomUUID();var a=(e=e||{}).random||(e.rng||o.default)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){r=r||0;for(var s=0;s<16;++s)t[r+s]=a[s];return t}return(0,i.unsafeStringify)(a)};r.default=s},{"./native.js":87,"./rng.js":91,"./stringify.js":93}],98:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./v35.js")),o=i(e("./sha1.js"));function i(e){return e&&e.__esModule?e:{default:e}}var a=(0,n.default)("v5",80,o.default);r.default=a},{"./sha1.js":92,"./v35.js":96}],99:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("./regex.js"))&&n.__esModule?n:{default:n};var i=function(e){return"string"==typeof e&&o.default.test(e)};r.default=i},{"./regex.js":90}],100:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=(n=e("./validate.js"))&&n.__esModule?n:{default:n};var i=function(e){if(!(0,o.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)};r.default=i},{"./validate.js":99}]},{},[4]);